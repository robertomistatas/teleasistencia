var SB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var oy={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kl=Symbol.for("react.element"),tS=Symbol.for("react.portal"),rS=Symbol.for("react.fragment"),nS=Symbol.for("react.strict_mode"),iS=Symbol.for("react.profiler"),sS=Symbol.for("react.provider"),aS=Symbol.for("react.context"),oS=Symbol.for("react.forward_ref"),cS=Symbol.for("react.suspense"),lS=Symbol.for("react.memo"),uS=Symbol.for("react.lazy"),k1=Symbol.iterator;function fS(t){return t===null||typeof t!="object"?null:(t=k1&&t[k1]||t["@@iterator"],typeof t=="function"?t:null)}var cy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ly=Object.assign,uy={};function Io(t,e,r){this.props=t,this.context=e,this.refs=uy,this.updater=r||cy}Io.prototype.isReactComponent={};Io.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Io.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fy(){}fy.prototype=Io.prototype;function Pp(t,e,r){this.props=t,this.context=e,this.refs=uy,this.updater=r||cy}var Fp=Pp.prototype=new fy;Fp.constructor=Pp;ly(Fp,Io.prototype);Fp.isPureReactComponent=!0;var A1=Array.isArray,hy=Object.prototype.hasOwnProperty,Dp={current:null},dy={key:!0,ref:!0,__self:!0,__source:!0};function py(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)hy.call(e,n)&&!dy.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var c=Array(o),l=0;l<o;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:kl,type:t,key:s,ref:a,props:i,_owner:Dp.current}}function hS(t,e){return{$$typeof:kl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Np(t){return typeof t=="object"&&t!==null&&t.$$typeof===kl}function dS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var S1=/\/+/g;function sh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dS(""+t.key):e.toString(36)}function Uu(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case kl:case tS:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+sh(a,0):n,A1(i)?(r="",t!=null&&(r=t.replace(S1,"$&/")+"/"),Uu(i,e,r,"",function(l){return l})):i!=null&&(Np(i)&&(i=hS(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(S1,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",A1(t))for(var o=0;o<t.length;o++){s=t[o];var c=n+sh(s,o);a+=Uu(s,e,r,c,i)}else if(c=fS(t),typeof c=="function")for(t=c.call(t),o=0;!(s=t.next()).done;)s=s.value,c=n+sh(s,o++),a+=Uu(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function lu(t,e,r){if(t==null)return t;var n=[],i=0;return Uu(t,n,"","",function(s){return e.call(r,s,i++)}),n}function pS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Pr={current:null},zu={transition:null},mS={ReactCurrentDispatcher:Pr,ReactCurrentBatchConfig:zu,ReactCurrentOwner:Dp};function my(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:lu,forEach:function(t,e,r){lu(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return lu(t,function(){e++}),e},toArray:function(t){return lu(t,function(e){return e})||[]},only:function(t){if(!Np(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=Io;be.Fragment=rS;be.Profiler=iS;be.PureComponent=Pp;be.StrictMode=nS;be.Suspense=cS;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mS;be.act=my;be.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ly({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Dp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(c in e)hy.call(e,c)&&!dy.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var l=0;l<c;l++)o[l]=arguments[l+2];n.children=o}return{$$typeof:kl,type:t.type,key:i,ref:s,props:n,_owner:a}};be.createContext=function(t){return t={$$typeof:aS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sS,_context:t},t.Consumer=t};be.createElement=py;be.createFactory=function(t){var e=py.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:oS,render:t}};be.isValidElement=Np;be.lazy=function(t){return{$$typeof:uS,_payload:{_status:-1,_result:t},_init:pS}};be.memo=function(t,e){return{$$typeof:lS,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=zu.transition;zu.transition={};try{t()}finally{zu.transition=e}};be.unstable_act=my;be.useCallback=function(t,e){return Pr.current.useCallback(t,e)};be.useContext=function(t){return Pr.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return Pr.current.useDeferredValue(t)};be.useEffect=function(t,e){return Pr.current.useEffect(t,e)};be.useId=function(){return Pr.current.useId()};be.useImperativeHandle=function(t,e,r){return Pr.current.useImperativeHandle(t,e,r)};be.useInsertionEffect=function(t,e){return Pr.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return Pr.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return Pr.current.useMemo(t,e)};be.useReducer=function(t,e,r){return Pr.current.useReducer(t,e,r)};be.useRef=function(t){return Pr.current.useRef(t)};be.useState=function(t){return Pr.current.useState(t)};be.useSyncExternalStore=function(t,e,r){return Pr.current.useSyncExternalStore(t,e,r)};be.useTransition=function(){return Pr.current.useTransition()};be.version="18.3.1";oy.exports=be;var gy=oy.exports;const IB=eS(gy);var vy={exports:{}},nn={},_y={exports:{}},xy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ie,W){var ce=ie.length;ie.push(W);e:for(;0<ce;){var xe=ce-1>>>1,b=ie[xe];if(0<i(b,W))ie[xe]=W,ie[ce]=b,ce=xe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var W=ie[0],ce=ie.pop();if(ce!==W){ie[0]=ce;e:for(var xe=0,b=ie.length,K=b>>>1;xe<K;){var j=2*(xe+1)-1,H=ie[j],ee=j+1,le=ie[ee];if(0>i(H,ce))ee<b&&0>i(le,H)?(ie[xe]=le,ie[ee]=ce,xe=ee):(ie[xe]=H,ie[j]=ce,xe=j);else if(ee<b&&0>i(le,ce))ie[xe]=le,ie[ee]=ce,xe=ee;else break e}}return W}function i(ie,W){var ce=ie.sortIndex-W.sortIndex;return ce!==0?ce:ie.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],f=1,h=null,d=3,m=!1,v=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(ie){for(var W=r(l);W!==null;){if(W.callback===null)n(l);else if(W.startTime<=ie)n(l),W.sortIndex=W.expirationTime,e(c,W);else break;W=r(l)}}function N(ie){if(g=!1,_(ie),!v)if(r(c)!==null)v=!0,Ee(z);else{var W=r(l);W!==null&&me(N,W.startTime-ie)}}function z(ie,W){v=!1,g&&(g=!1,w(k),k=-1),m=!0;var ce=d;try{for(_(W),h=r(c);h!==null&&(!(h.expirationTime>W)||ie&&!R());){var xe=h.callback;if(typeof xe=="function"){h.callback=null,d=h.priorityLevel;var b=xe(h.expirationTime<=W);W=t.unstable_now(),typeof b=="function"?h.callback=b:h===r(c)&&n(c),_(W)}else n(c);h=r(c)}if(h!==null)var K=!0;else{var j=r(l);j!==null&&me(N,j.startTime-W),K=!1}return K}finally{h=null,d=ce,m=!1}}var B=!1,y=null,k=-1,A=5,I=-1;function R(){return!(t.unstable_now()-I<A)}function C(){if(y!==null){var ie=t.unstable_now();I=ie;var W=!0;try{W=y(!0,ie)}finally{W?F():(B=!1,y=null)}}else B=!1}var F;if(typeof T=="function")F=function(){T(C)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ue=ve.port2;ve.port1.onmessage=C,F=function(){ue.postMessage(null)}}else F=function(){E(C,0)};function Ee(ie){y=ie,B||(B=!0,F())}function me(ie,W){k=E(function(){ie(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,Ee(z))},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(ie){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var ce=d;d=W;try{return ie()}finally{d=ce}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ie,W){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ce=d;d=ie;try{return W()}finally{d=ce}},t.unstable_scheduleCallback=function(ie,W,ce){var xe=t.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?xe+ce:xe):ce=xe,ie){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=ce+b,ie={id:f++,callback:W,priorityLevel:ie,startTime:ce,expirationTime:b,sortIndex:-1},ce>xe?(ie.sortIndex=ce,e(l,ie),r(c)===null&&ie===r(l)&&(g?(w(k),k=-1):g=!0,me(N,ce-xe))):(ie.sortIndex=b,e(c,ie),v||m||(v=!0,Ee(z))),ie},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(ie){var W=d;return function(){var ce=d;d=W;try{return ie.apply(this,arguments)}finally{d=ce}}}})(xy);_y.exports=xy;var gS=_y.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vS=gy,tn=gS;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yy=new Set,Wc={};function la(t,e){lo(t,e),lo(t+"Capture",e)}function lo(t,e){for(Wc[t]=e,t=0;t<e.length;t++)yy.add(e[t])}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rd=Object.prototype.hasOwnProperty,_S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,I1={},C1={};function xS(t){return rd.call(C1,t)?!0:rd.call(I1,t)?!1:_S.test(t)?C1[t]=!0:(I1[t]=!0,!1)}function yS(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ES(t,e,r,n){if(e===null||typeof e>"u"||yS(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var rr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rr[t]=new Fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rr[e]=new Fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rr[t]=new Fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rr[t]=new Fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rr[t]=new Fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rr[t]=new Fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rr[t]=new Fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rr[t]=new Fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rr[t]=new Fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Op=/[\-:]([a-z])/g;function Lp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Op,Lp);rr[e]=new Fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Op,Lp);rr[e]=new Fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Op,Lp);rr[e]=new Fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rr[t]=new Fr(t,1,!1,t.toLowerCase(),null,!1,!1)});rr.xlinkHref=new Fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rr[t]=new Fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Mp(t,e,r,n){var i=rr.hasOwnProperty(e)?rr[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ES(e,r,i,n)&&(r=null),n||i===null?xS(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ri=vS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,uu=Symbol.for("react.element"),Ma=Symbol.for("react.portal"),ba=Symbol.for("react.fragment"),bp=Symbol.for("react.strict_mode"),nd=Symbol.for("react.profiler"),Ey=Symbol.for("react.provider"),wy=Symbol.for("react.context"),Vp=Symbol.for("react.forward_ref"),id=Symbol.for("react.suspense"),sd=Symbol.for("react.suspense_list"),Bp=Symbol.for("react.memo"),Vi=Symbol.for("react.lazy"),Ty=Symbol.for("react.offscreen"),R1=Symbol.iterator;function Yo(t){return t===null||typeof t!="object"?null:(t=R1&&t[R1]||t["@@iterator"],typeof t=="function"?t:null)}var gt=Object.assign,ah;function sc(t){if(ah===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ah=e&&e[1]||""}return`
`+ah+t}var oh=!1;function ch(t,e){if(!t||oh)return"";oh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var c=`
`+i[a].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=a&&0<=o);break}}}finally{oh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?sc(t):""}function wS(t){switch(t.tag){case 5:return sc(t.type);case 16:return sc("Lazy");case 13:return sc("Suspense");case 19:return sc("SuspenseList");case 0:case 2:case 15:return t=ch(t.type,!1),t;case 11:return t=ch(t.type.render,!1),t;case 1:return t=ch(t.type,!0),t;default:return""}}function ad(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ba:return"Fragment";case Ma:return"Portal";case nd:return"Profiler";case bp:return"StrictMode";case id:return"Suspense";case sd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case wy:return(t.displayName||"Context")+".Consumer";case Ey:return(t._context.displayName||"Context")+".Provider";case Vp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bp:return e=t.displayName||null,e!==null?e:ad(t.type)||"Memo";case Vi:e=t._payload,t=t._init;try{return ad(t(e))}catch{}}return null}function TS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ad(e);case 8:return e===bp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ds(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ky(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function kS(t){var e=ky(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fu(t){t._valueTracker||(t._valueTracker=kS(t))}function Ay(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=ky(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function cf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function od(t,e){var r=e.checked;return gt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function P1(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ds(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sy(t,e){e=e.checked,e!=null&&Mp(t,"checked",e,!1)}function cd(t,e){Sy(t,e);var r=ds(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ld(t,e.type,r):e.hasOwnProperty("defaultValue")&&ld(t,e.type,ds(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function F1(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function ld(t,e,r){(e!=="number"||cf(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ac=Array.isArray;function Ya(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ds(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function ud(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return gt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function D1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(ae(92));if(ac(r)){if(1<r.length)throw Error(ae(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ds(r)}}function Iy(t,e){var r=ds(e.value),n=ds(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function N1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Cy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Cy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hu,Ry=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hu=hu||document.createElement("div"),hu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $c(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var xc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AS=["Webkit","ms","Moz","O"];Object.keys(xc).forEach(function(t){AS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),xc[e]=xc[t]})});function Py(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||xc.hasOwnProperty(t)&&xc[t]?(""+e).trim():e+"px"}function Fy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Py(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var SS=gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hd(t,e){if(e){if(SS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function dd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pd=null;function Up(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var md=null,Qa=null,Ja=null;function O1(t){if(t=Il(t)){if(typeof md!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=f0(e),md(t.stateNode,t.type,e))}}function Dy(t){Qa?Ja?Ja.push(t):Ja=[t]:Qa=t}function Ny(){if(Qa){var t=Qa,e=Ja;if(Ja=Qa=null,O1(t),e)for(t=0;t<e.length;t++)O1(e[t])}}function Oy(t,e){return t(e)}function Ly(){}var lh=!1;function My(t,e,r){if(lh)return t(e,r);lh=!0;try{return Oy(t,e,r)}finally{lh=!1,(Qa!==null||Ja!==null)&&(Ly(),Ny())}}function jc(t,e){var r=t.stateNode;if(r===null)return null;var n=f0(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ae(231,e,typeof r));return r}var gd=!1;if(yi)try{var Qo={};Object.defineProperty(Qo,"passive",{get:function(){gd=!0}}),window.addEventListener("test",Qo,Qo),window.removeEventListener("test",Qo,Qo)}catch{gd=!1}function IS(t,e,r,n,i,s,a,o,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(f){this.onError(f)}}var yc=!1,lf=null,uf=!1,vd=null,CS={onError:function(t){yc=!0,lf=t}};function RS(t,e,r,n,i,s,a,o,c){yc=!1,lf=null,IS.apply(CS,arguments)}function PS(t,e,r,n,i,s,a,o,c){if(RS.apply(this,arguments),yc){if(yc){var l=lf;yc=!1,lf=null}else throw Error(ae(198));uf||(uf=!0,vd=l)}}function ua(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function by(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function L1(t){if(ua(t)!==t)throw Error(ae(188))}function FS(t){var e=t.alternate;if(!e){if(e=ua(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return L1(i),t;if(s===n)return L1(i),e;s=s.sibling}throw Error(ae(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(ae(189))}}if(r.alternate!==n)throw Error(ae(190))}if(r.tag!==3)throw Error(ae(188));return r.stateNode.current===r?t:e}function Vy(t){return t=FS(t),t!==null?By(t):null}function By(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=By(t);if(e!==null)return e;t=t.sibling}return null}var Uy=tn.unstable_scheduleCallback,M1=tn.unstable_cancelCallback,DS=tn.unstable_shouldYield,NS=tn.unstable_requestPaint,It=tn.unstable_now,OS=tn.unstable_getCurrentPriorityLevel,zp=tn.unstable_ImmediatePriority,zy=tn.unstable_UserBlockingPriority,ff=tn.unstable_NormalPriority,LS=tn.unstable_LowPriority,Hy=tn.unstable_IdlePriority,o0=null,Gn=null;function MS(t){if(Gn&&typeof Gn.onCommitFiberRoot=="function")try{Gn.onCommitFiberRoot(o0,t,void 0,(t.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:BS,bS=Math.log,VS=Math.LN2;function BS(t){return t>>>=0,t===0?32:31-(bS(t)/VS|0)|0}var du=64,pu=4194304;function oc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function hf(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=oc(o):(s&=a,s!==0&&(n=oc(s)))}else a=r&~i,a!==0?n=oc(a):s!==0&&(n=oc(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Pn(e),i=1<<r,n|=t[r],e&=~i;return n}function US(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zS(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Pn(s),o=1<<a,c=i[a];c===-1?(!(o&r)||o&n)&&(i[a]=US(o,e)):c<=e&&(t.expiredLanes|=o),s&=~o}}function _d(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Wy(){var t=du;return du<<=1,!(du&4194240)&&(du=64),t}function uh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Al(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pn(e),t[e]=r}function HS(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Pn(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function Hp(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Pn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Qe=0;function $y(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jy,Wp,Gy,Ky,qy,xd=!1,mu=[],Zi=null,es=null,ts=null,Gc=new Map,Kc=new Map,Ui=[],WS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b1(t,e){switch(t){case"focusin":case"focusout":Zi=null;break;case"dragenter":case"dragleave":es=null;break;case"mouseover":case"mouseout":ts=null;break;case"pointerover":case"pointerout":Gc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kc.delete(e.pointerId)}}function Jo(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Il(e),e!==null&&Wp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function $S(t,e,r,n,i){switch(e){case"focusin":return Zi=Jo(Zi,t,e,r,n,i),!0;case"dragenter":return es=Jo(es,t,e,r,n,i),!0;case"mouseover":return ts=Jo(ts,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Gc.set(s,Jo(Gc.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Kc.set(s,Jo(Kc.get(s)||null,t,e,r,n,i)),!0}return!1}function Xy(t){var e=bs(t.target);if(e!==null){var r=ua(e);if(r!==null){if(e=r.tag,e===13){if(e=by(r),e!==null){t.blockedOn=e,qy(t.priority,function(){Gy(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=yd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);pd=n,r.target.dispatchEvent(n),pd=null}else return e=Il(r),e!==null&&Wp(e),t.blockedOn=r,!1;e.shift()}return!0}function V1(t,e,r){Hu(t)&&r.delete(e)}function jS(){xd=!1,Zi!==null&&Hu(Zi)&&(Zi=null),es!==null&&Hu(es)&&(es=null),ts!==null&&Hu(ts)&&(ts=null),Gc.forEach(V1),Kc.forEach(V1)}function Zo(t,e){t.blockedOn===e&&(t.blockedOn=null,xd||(xd=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,jS)))}function qc(t){function e(i){return Zo(i,t)}if(0<mu.length){Zo(mu[0],t);for(var r=1;r<mu.length;r++){var n=mu[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Zi!==null&&Zo(Zi,t),es!==null&&Zo(es,t),ts!==null&&Zo(ts,t),Gc.forEach(e),Kc.forEach(e),r=0;r<Ui.length;r++)n=Ui[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ui.length&&(r=Ui[0],r.blockedOn===null);)Xy(r),r.blockedOn===null&&Ui.shift()}var Za=Ri.ReactCurrentBatchConfig,df=!0;function GS(t,e,r,n){var i=Qe,s=Za.transition;Za.transition=null;try{Qe=1,$p(t,e,r,n)}finally{Qe=i,Za.transition=s}}function KS(t,e,r,n){var i=Qe,s=Za.transition;Za.transition=null;try{Qe=4,$p(t,e,r,n)}finally{Qe=i,Za.transition=s}}function $p(t,e,r,n){if(df){var i=yd(t,e,r,n);if(i===null)yh(t,e,n,pf,r),b1(t,n);else if($S(i,t,e,r,n))n.stopPropagation();else if(b1(t,n),e&4&&-1<WS.indexOf(t)){for(;i!==null;){var s=Il(i);if(s!==null&&jy(s),s=yd(t,e,r,n),s===null&&yh(t,e,n,pf,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else yh(t,e,n,null,r)}}var pf=null;function yd(t,e,r,n){if(pf=null,t=Up(n),t=bs(t),t!==null)if(e=ua(t),e===null)t=null;else if(r=e.tag,r===13){if(t=by(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pf=t,null}function Yy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OS()){case zp:return 1;case zy:return 4;case ff:case LS:return 16;case Hy:return 536870912;default:return 16}default:return 16}}var qi=null,jp=null,Wu=null;function Qy(){if(Wu)return Wu;var t,e=jp,r=e.length,n,i="value"in qi?qi.value:qi.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return Wu=i.slice(t,1<n?1-n:void 0)}function $u(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gu(){return!0}function B1(){return!1}function sn(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gu:B1,this.isPropagationStopped=B1,this}return gt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=gu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=gu)},persist:function(){},isPersistent:gu}),e}var Co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gp=sn(Co),Sl=gt({},Co,{view:0,detail:0}),qS=sn(Sl),fh,hh,ec,c0=gt({},Sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ec&&(ec&&t.type==="mousemove"?(fh=t.screenX-ec.screenX,hh=t.screenY-ec.screenY):hh=fh=0,ec=t),fh)},movementY:function(t){return"movementY"in t?t.movementY:hh}}),U1=sn(c0),XS=gt({},c0,{dataTransfer:0}),YS=sn(XS),QS=gt({},Sl,{relatedTarget:0}),dh=sn(QS),JS=gt({},Co,{animationName:0,elapsedTime:0,pseudoElement:0}),ZS=sn(JS),eI=gt({},Co,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),tI=sn(eI),rI=gt({},Co,{data:0}),z1=sn(rI),nI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=sI[t])?!!e[t]:!1}function Kp(){return aI}var oI=gt({},Sl,{key:function(t){if(t.key){var e=nI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$u(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kp,charCode:function(t){return t.type==="keypress"?$u(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$u(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cI=sn(oI),lI=gt({},c0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H1=sn(lI),uI=gt({},Sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kp}),fI=sn(uI),hI=gt({},Co,{propertyName:0,elapsedTime:0,pseudoElement:0}),dI=sn(hI),pI=gt({},c0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),mI=sn(pI),gI=[9,13,27,32],qp=yi&&"CompositionEvent"in window,Ec=null;yi&&"documentMode"in document&&(Ec=document.documentMode);var vI=yi&&"TextEvent"in window&&!Ec,Jy=yi&&(!qp||Ec&&8<Ec&&11>=Ec),W1=String.fromCharCode(32),$1=!1;function Zy(t,e){switch(t){case"keyup":return gI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Va=!1;function _I(t,e){switch(t){case"compositionend":return eE(e);case"keypress":return e.which!==32?null:($1=!0,W1);case"textInput":return t=e.data,t===W1&&$1?null:t;default:return null}}function xI(t,e){if(Va)return t==="compositionend"||!qp&&Zy(t,e)?(t=Qy(),Wu=jp=qi=null,Va=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Jy&&e.locale!=="ko"?null:e.data;default:return null}}var yI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!yI[t.type]:e==="textarea"}function tE(t,e,r,n){Dy(n),e=mf(e,"onChange"),0<e.length&&(r=new Gp("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var wc=null,Xc=null;function EI(t){hE(t,0)}function l0(t){var e=za(t);if(Ay(e))return t}function wI(t,e){if(t==="change")return e}var rE=!1;if(yi){var ph;if(yi){var mh="oninput"in document;if(!mh){var G1=document.createElement("div");G1.setAttribute("oninput","return;"),mh=typeof G1.oninput=="function"}ph=mh}else ph=!1;rE=ph&&(!document.documentMode||9<document.documentMode)}function K1(){wc&&(wc.detachEvent("onpropertychange",nE),Xc=wc=null)}function nE(t){if(t.propertyName==="value"&&l0(Xc)){var e=[];tE(e,Xc,t,Up(t)),My(EI,e)}}function TI(t,e,r){t==="focusin"?(K1(),wc=e,Xc=r,wc.attachEvent("onpropertychange",nE)):t==="focusout"&&K1()}function kI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return l0(Xc)}function AI(t,e){if(t==="click")return l0(e)}function SI(t,e){if(t==="input"||t==="change")return l0(e)}function II(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nn=typeof Object.is=="function"?Object.is:II;function Yc(t,e){if(Nn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!rd.call(e,i)||!Nn(t[i],e[i]))return!1}return!0}function q1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function X1(t,e){var r=q1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=q1(r)}}function iE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?iE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sE(){for(var t=window,e=cf();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=cf(t.document)}return e}function Xp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function CI(t){var e=sE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&iE(r.ownerDocument.documentElement,r)){if(n!==null&&Xp(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=X1(r,s);var a=X1(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var RI=yi&&"documentMode"in document&&11>=document.documentMode,Ba=null,Ed=null,Tc=null,wd=!1;function Y1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;wd||Ba==null||Ba!==cf(n)||(n=Ba,"selectionStart"in n&&Xp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Tc&&Yc(Tc,n)||(Tc=n,n=mf(Ed,"onSelect"),0<n.length&&(e=new Gp("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Ba)))}function vu(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ua={animationend:vu("Animation","AnimationEnd"),animationiteration:vu("Animation","AnimationIteration"),animationstart:vu("Animation","AnimationStart"),transitionend:vu("Transition","TransitionEnd")},gh={},aE={};yi&&(aE=document.createElement("div").style,"AnimationEvent"in window||(delete Ua.animationend.animation,delete Ua.animationiteration.animation,delete Ua.animationstart.animation),"TransitionEvent"in window||delete Ua.transitionend.transition);function u0(t){if(gh[t])return gh[t];if(!Ua[t])return t;var e=Ua[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in aE)return gh[t]=e[r];return t}var oE=u0("animationend"),cE=u0("animationiteration"),lE=u0("animationstart"),uE=u0("transitionend"),fE=new Map,Q1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(t,e){fE.set(t,e),la(e,[t])}for(var vh=0;vh<Q1.length;vh++){var _h=Q1[vh],PI=_h.toLowerCase(),FI=_h[0].toUpperCase()+_h.slice(1);ys(PI,"on"+FI)}ys(oE,"onAnimationEnd");ys(cE,"onAnimationIteration");ys(lE,"onAnimationStart");ys("dblclick","onDoubleClick");ys("focusin","onFocus");ys("focusout","onBlur");ys(uE,"onTransitionEnd");lo("onMouseEnter",["mouseout","mouseover"]);lo("onMouseLeave",["mouseout","mouseover"]);lo("onPointerEnter",["pointerout","pointerover"]);lo("onPointerLeave",["pointerout","pointerover"]);la("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));la("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));la("onBeforeInput",["compositionend","keypress","textInput","paste"]);la("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));la("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));la("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DI=new Set("cancel close invalid load scroll toggle".split(" ").concat(cc));function J1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,PS(n,e,void 0,t),t.currentTarget=null}function hE(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&i.isPropagationStopped())break e;J1(i,o,l),s=c}else for(a=0;a<n.length;a++){if(o=n[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&i.isPropagationStopped())break e;J1(i,o,l),s=c}}}if(uf)throw t=vd,uf=!1,vd=null,t}function ot(t,e){var r=e[Id];r===void 0&&(r=e[Id]=new Set);var n=t+"__bubble";r.has(n)||(dE(e,t,2,!1),r.add(n))}function xh(t,e,r){var n=0;e&&(n|=4),dE(r,t,n,e)}var _u="_reactListening"+Math.random().toString(36).slice(2);function Qc(t){if(!t[_u]){t[_u]=!0,yy.forEach(function(r){r!=="selectionchange"&&(DI.has(r)||xh(r,!1,t),xh(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_u]||(e[_u]=!0,xh("selectionchange",!1,e))}}function dE(t,e,r,n){switch(Yy(e)){case 1:var i=GS;break;case 4:i=KS;break;default:i=$p}r=i.bind(null,e,r,t),i=void 0,!gd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function yh(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=bs(o),a===null)return;if(c=a.tag,c===5||c===6){n=s=a;continue e}o=o.parentNode}}n=n.return}My(function(){var l=s,f=Up(r),h=[];e:{var d=fE.get(t);if(d!==void 0){var m=Gp,v=t;switch(t){case"keypress":if($u(r)===0)break e;case"keydown":case"keyup":m=cI;break;case"focusin":v="focus",m=dh;break;case"focusout":v="blur",m=dh;break;case"beforeblur":case"afterblur":m=dh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=U1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=YS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=fI;break;case oE:case cE:case lE:m=ZS;break;case uE:m=dI;break;case"scroll":m=qS;break;case"wheel":m=mI;break;case"copy":case"cut":case"paste":m=tI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=H1}var g=(e&4)!==0,E=!g&&t==="scroll",w=g?d!==null?d+"Capture":null:d;g=[];for(var T=l,_;T!==null;){_=T;var N=_.stateNode;if(_.tag===5&&N!==null&&(_=N,w!==null&&(N=jc(T,w),N!=null&&g.push(Jc(T,N,_)))),E)break;T=T.return}0<g.length&&(d=new m(d,v,null,r,f),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==pd&&(v=r.relatedTarget||r.fromElement)&&(bs(v)||v[Ei]))break e;if((m||d)&&(d=f.window===f?f:(d=f.ownerDocument)?d.defaultView||d.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=l,v=v?bs(v):null,v!==null&&(E=ua(v),v!==E||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=l),m!==v)){if(g=U1,N="onMouseLeave",w="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(g=H1,N="onPointerLeave",w="onPointerEnter",T="pointer"),E=m==null?d:za(m),_=v==null?d:za(v),d=new g(N,T+"leave",m,r,f),d.target=E,d.relatedTarget=_,N=null,bs(f)===l&&(g=new g(w,T+"enter",v,r,f),g.target=_,g.relatedTarget=E,N=g),E=N,m&&v)t:{for(g=m,w=v,T=0,_=g;_;_=Pa(_))T++;for(_=0,N=w;N;N=Pa(N))_++;for(;0<T-_;)g=Pa(g),T--;for(;0<_-T;)w=Pa(w),_--;for(;T--;){if(g===w||w!==null&&g===w.alternate)break t;g=Pa(g),w=Pa(w)}g=null}else g=null;m!==null&&Z1(h,d,m,g,!1),v!==null&&E!==null&&Z1(h,E,v,g,!0)}}e:{if(d=l?za(l):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var z=wI;else if(j1(d))if(rE)z=SI;else{z=kI;var B=TI}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(z=AI);if(z&&(z=z(t,l))){tE(h,z,r,f);break e}B&&B(t,d,l),t==="focusout"&&(B=d._wrapperState)&&B.controlled&&d.type==="number"&&ld(d,"number",d.value)}switch(B=l?za(l):window,t){case"focusin":(j1(B)||B.contentEditable==="true")&&(Ba=B,Ed=l,Tc=null);break;case"focusout":Tc=Ed=Ba=null;break;case"mousedown":wd=!0;break;case"contextmenu":case"mouseup":case"dragend":wd=!1,Y1(h,r,f);break;case"selectionchange":if(RI)break;case"keydown":case"keyup":Y1(h,r,f)}var y;if(qp)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Va?Zy(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(Jy&&r.locale!=="ko"&&(Va||k!=="onCompositionStart"?k==="onCompositionEnd"&&Va&&(y=Qy()):(qi=f,jp="value"in qi?qi.value:qi.textContent,Va=!0)),B=mf(l,k),0<B.length&&(k=new z1(k,t,null,r,f),h.push({event:k,listeners:B}),y?k.data=y:(y=eE(r),y!==null&&(k.data=y)))),(y=vI?_I(t,r):xI(t,r))&&(l=mf(l,"onBeforeInput"),0<l.length&&(f=new z1("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:l}),f.data=y))}hE(h,e)})}function Jc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function mf(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=jc(t,r),s!=null&&n.unshift(Jc(t,s,i)),s=jc(t,e),s!=null&&n.push(Jc(t,s,i))),t=t.return}return n}function Pa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Z1(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,c=o.alternate,l=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&l!==null&&(o=l,i?(c=jc(r,s),c!=null&&a.unshift(Jc(r,c,o))):i||(c=jc(r,s),c!=null&&a.push(Jc(r,c,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var NI=/\r\n?/g,OI=/\u0000|\uFFFD/g;function ev(t){return(typeof t=="string"?t:""+t).replace(NI,`
`).replace(OI,"")}function xu(t,e,r){if(e=ev(e),ev(t)!==e&&r)throw Error(ae(425))}function gf(){}var Td=null,kd=null;function Ad(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sd=typeof setTimeout=="function"?setTimeout:void 0,LI=typeof clearTimeout=="function"?clearTimeout:void 0,tv=typeof Promise=="function"?Promise:void 0,MI=typeof queueMicrotask=="function"?queueMicrotask:typeof tv<"u"?function(t){return tv.resolve(null).then(t).catch(bI)}:Sd;function bI(t){setTimeout(function(){throw t})}function Eh(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),qc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);qc(e)}function rs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ro=Math.random().toString(36).slice(2),jn="__reactFiber$"+Ro,Zc="__reactProps$"+Ro,Ei="__reactContainer$"+Ro,Id="__reactEvents$"+Ro,VI="__reactListeners$"+Ro,BI="__reactHandles$"+Ro;function bs(t){var e=t[jn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ei]||r[jn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=rv(t);t!==null;){if(r=t[jn])return r;t=rv(t)}return e}t=r,r=t.parentNode}return null}function Il(t){return t=t[jn]||t[Ei],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function za(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function f0(t){return t[Zc]||null}var Cd=[],Ha=-1;function Es(t){return{current:t}}function lt(t){0>Ha||(t.current=Cd[Ha],Cd[Ha]=null,Ha--)}function rt(t,e){Ha++,Cd[Ha]=t.current,t.current=e}var ps={},vr=Es(ps),br=Es(!1),qs=ps;function uo(t,e){var r=t.type.contextTypes;if(!r)return ps;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Vr(t){return t=t.childContextTypes,t!=null}function vf(){lt(br),lt(vr)}function nv(t,e,r){if(vr.current!==ps)throw Error(ae(168));rt(vr,e),rt(br,r)}function pE(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(ae(108,TS(t)||"Unknown",i));return gt({},r,n)}function _f(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ps,qs=vr.current,rt(vr,t),rt(br,br.current),!0}function iv(t,e,r){var n=t.stateNode;if(!n)throw Error(ae(169));r?(t=pE(t,e,qs),n.__reactInternalMemoizedMergedChildContext=t,lt(br),lt(vr),rt(vr,t)):lt(br),rt(br,r)}var li=null,h0=!1,wh=!1;function mE(t){li===null?li=[t]:li.push(t)}function UI(t){h0=!0,mE(t)}function ws(){if(!wh&&li!==null){wh=!0;var t=0,e=Qe;try{var r=li;for(Qe=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}li=null,h0=!1}catch(i){throw li!==null&&(li=li.slice(t+1)),Uy(zp,ws),i}finally{Qe=e,wh=!1}}return null}var Wa=[],$a=0,xf=null,yf=0,fn=[],hn=0,Xs=null,ui=1,fi="";function Ns(t,e){Wa[$a++]=yf,Wa[$a++]=xf,xf=t,yf=e}function gE(t,e,r){fn[hn++]=ui,fn[hn++]=fi,fn[hn++]=Xs,Xs=t;var n=ui;t=fi;var i=32-Pn(n)-1;n&=~(1<<i),r+=1;var s=32-Pn(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ui=1<<32-Pn(e)+i|r<<i|n,fi=s+t}else ui=1<<s|r<<i|n,fi=t}function Yp(t){t.return!==null&&(Ns(t,1),gE(t,1,0))}function Qp(t){for(;t===xf;)xf=Wa[--$a],Wa[$a]=null,yf=Wa[--$a],Wa[$a]=null;for(;t===Xs;)Xs=fn[--hn],fn[hn]=null,fi=fn[--hn],fn[hn]=null,ui=fn[--hn],fn[hn]=null}var Jr=null,Yr=null,ht=!1,Sn=null;function vE(t,e){var r=dn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function sv(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Jr=t,Yr=rs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Jr=t,Yr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Xs!==null?{id:ui,overflow:fi}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=dn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Jr=t,Yr=null,!0):!1;default:return!1}}function Rd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Pd(t){if(ht){var e=Yr;if(e){var r=e;if(!sv(t,e)){if(Rd(t))throw Error(ae(418));e=rs(r.nextSibling);var n=Jr;e&&sv(t,e)?vE(n,r):(t.flags=t.flags&-4097|2,ht=!1,Jr=t)}}else{if(Rd(t))throw Error(ae(418));t.flags=t.flags&-4097|2,ht=!1,Jr=t}}}function av(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Jr=t}function yu(t){if(t!==Jr)return!1;if(!ht)return av(t),ht=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ad(t.type,t.memoizedProps)),e&&(e=Yr)){if(Rd(t))throw _E(),Error(ae(418));for(;e;)vE(t,e),e=rs(e.nextSibling)}if(av(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Yr=rs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Yr=null}}else Yr=Jr?rs(t.stateNode.nextSibling):null;return!0}function _E(){for(var t=Yr;t;)t=rs(t.nextSibling)}function fo(){Yr=Jr=null,ht=!1}function Jp(t){Sn===null?Sn=[t]:Sn.push(t)}var zI=Ri.ReactCurrentBatchConfig;function tc(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ae(309));var n=r.stateNode}if(!n)throw Error(ae(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ae(284));if(!r._owner)throw Error(ae(290,t))}return t}function Eu(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ov(t){var e=t._init;return e(t._payload)}function xE(t){function e(w,T){if(t){var _=w.deletions;_===null?(w.deletions=[T],w.flags|=16):_.push(T)}}function r(w,T){if(!t)return null;for(;T!==null;)e(w,T),T=T.sibling;return null}function n(w,T){for(w=new Map;T!==null;)T.key!==null?w.set(T.key,T):w.set(T.index,T),T=T.sibling;return w}function i(w,T){return w=as(w,T),w.index=0,w.sibling=null,w}function s(w,T,_){return w.index=_,t?(_=w.alternate,_!==null?(_=_.index,_<T?(w.flags|=2,T):_):(w.flags|=2,T)):(w.flags|=1048576,T)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function o(w,T,_,N){return T===null||T.tag!==6?(T=Rh(_,w.mode,N),T.return=w,T):(T=i(T,_),T.return=w,T)}function c(w,T,_,N){var z=_.type;return z===ba?f(w,T,_.props.children,N,_.key):T!==null&&(T.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Vi&&ov(z)===T.type)?(N=i(T,_.props),N.ref=tc(w,T,_),N.return=w,N):(N=Qu(_.type,_.key,_.props,null,w.mode,N),N.ref=tc(w,T,_),N.return=w,N)}function l(w,T,_,N){return T===null||T.tag!==4||T.stateNode.containerInfo!==_.containerInfo||T.stateNode.implementation!==_.implementation?(T=Ph(_,w.mode,N),T.return=w,T):(T=i(T,_.children||[]),T.return=w,T)}function f(w,T,_,N,z){return T===null||T.tag!==7?(T=$s(_,w.mode,N,z),T.return=w,T):(T=i(T,_),T.return=w,T)}function h(w,T,_){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Rh(""+T,w.mode,_),T.return=w,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case uu:return _=Qu(T.type,T.key,T.props,null,w.mode,_),_.ref=tc(w,null,T),_.return=w,_;case Ma:return T=Ph(T,w.mode,_),T.return=w,T;case Vi:var N=T._init;return h(w,N(T._payload),_)}if(ac(T)||Yo(T))return T=$s(T,w.mode,_,null),T.return=w,T;Eu(w,T)}return null}function d(w,T,_,N){var z=T!==null?T.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return z!==null?null:o(w,T,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case uu:return _.key===z?c(w,T,_,N):null;case Ma:return _.key===z?l(w,T,_,N):null;case Vi:return z=_._init,d(w,T,z(_._payload),N)}if(ac(_)||Yo(_))return z!==null?null:f(w,T,_,N,null);Eu(w,_)}return null}function m(w,T,_,N,z){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(_)||null,o(T,w,""+N,z);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case uu:return w=w.get(N.key===null?_:N.key)||null,c(T,w,N,z);case Ma:return w=w.get(N.key===null?_:N.key)||null,l(T,w,N,z);case Vi:var B=N._init;return m(w,T,_,B(N._payload),z)}if(ac(N)||Yo(N))return w=w.get(_)||null,f(T,w,N,z,null);Eu(T,N)}return null}function v(w,T,_,N){for(var z=null,B=null,y=T,k=T=0,A=null;y!==null&&k<_.length;k++){y.index>k?(A=y,y=null):A=y.sibling;var I=d(w,y,_[k],N);if(I===null){y===null&&(y=A);break}t&&y&&I.alternate===null&&e(w,y),T=s(I,T,k),B===null?z=I:B.sibling=I,B=I,y=A}if(k===_.length)return r(w,y),ht&&Ns(w,k),z;if(y===null){for(;k<_.length;k++)y=h(w,_[k],N),y!==null&&(T=s(y,T,k),B===null?z=y:B.sibling=y,B=y);return ht&&Ns(w,k),z}for(y=n(w,y);k<_.length;k++)A=m(y,w,k,_[k],N),A!==null&&(t&&A.alternate!==null&&y.delete(A.key===null?k:A.key),T=s(A,T,k),B===null?z=A:B.sibling=A,B=A);return t&&y.forEach(function(R){return e(w,R)}),ht&&Ns(w,k),z}function g(w,T,_,N){var z=Yo(_);if(typeof z!="function")throw Error(ae(150));if(_=z.call(_),_==null)throw Error(ae(151));for(var B=z=null,y=T,k=T=0,A=null,I=_.next();y!==null&&!I.done;k++,I=_.next()){y.index>k?(A=y,y=null):A=y.sibling;var R=d(w,y,I.value,N);if(R===null){y===null&&(y=A);break}t&&y&&R.alternate===null&&e(w,y),T=s(R,T,k),B===null?z=R:B.sibling=R,B=R,y=A}if(I.done)return r(w,y),ht&&Ns(w,k),z;if(y===null){for(;!I.done;k++,I=_.next())I=h(w,I.value,N),I!==null&&(T=s(I,T,k),B===null?z=I:B.sibling=I,B=I);return ht&&Ns(w,k),z}for(y=n(w,y);!I.done;k++,I=_.next())I=m(y,w,k,I.value,N),I!==null&&(t&&I.alternate!==null&&y.delete(I.key===null?k:I.key),T=s(I,T,k),B===null?z=I:B.sibling=I,B=I);return t&&y.forEach(function(C){return e(w,C)}),ht&&Ns(w,k),z}function E(w,T,_,N){if(typeof _=="object"&&_!==null&&_.type===ba&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case uu:e:{for(var z=_.key,B=T;B!==null;){if(B.key===z){if(z=_.type,z===ba){if(B.tag===7){r(w,B.sibling),T=i(B,_.props.children),T.return=w,w=T;break e}}else if(B.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===Vi&&ov(z)===B.type){r(w,B.sibling),T=i(B,_.props),T.ref=tc(w,B,_),T.return=w,w=T;break e}r(w,B);break}else e(w,B);B=B.sibling}_.type===ba?(T=$s(_.props.children,w.mode,N,_.key),T.return=w,w=T):(N=Qu(_.type,_.key,_.props,null,w.mode,N),N.ref=tc(w,T,_),N.return=w,w=N)}return a(w);case Ma:e:{for(B=_.key;T!==null;){if(T.key===B)if(T.tag===4&&T.stateNode.containerInfo===_.containerInfo&&T.stateNode.implementation===_.implementation){r(w,T.sibling),T=i(T,_.children||[]),T.return=w,w=T;break e}else{r(w,T);break}else e(w,T);T=T.sibling}T=Ph(_,w.mode,N),T.return=w,w=T}return a(w);case Vi:return B=_._init,E(w,T,B(_._payload),N)}if(ac(_))return v(w,T,_,N);if(Yo(_))return g(w,T,_,N);Eu(w,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,T!==null&&T.tag===6?(r(w,T.sibling),T=i(T,_),T.return=w,w=T):(r(w,T),T=Rh(_,w.mode,N),T.return=w,w=T),a(w)):r(w,T)}return E}var ho=xE(!0),yE=xE(!1),Ef=Es(null),wf=null,ja=null,Zp=null;function em(){Zp=ja=wf=null}function tm(t){var e=Ef.current;lt(Ef),t._currentValue=e}function Fd(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function eo(t,e){wf=t,Zp=ja=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Mr=!0),t.firstContext=null)}function gn(t){var e=t._currentValue;if(Zp!==t)if(t={context:t,memoizedValue:e,next:null},ja===null){if(wf===null)throw Error(ae(308));ja=t,wf.dependencies={lanes:0,firstContext:t}}else ja=ja.next=t;return e}var Vs=null;function rm(t){Vs===null?Vs=[t]:Vs.push(t)}function EE(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,rm(e)):(r.next=i.next,i.next=r),e.interleaved=r,wi(t,n)}function wi(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Bi=!1;function nm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ns(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,je&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,wi(t,r)}return i=n.interleaved,i===null?(e.next=e,rm(n)):(e.next=i.next,i.next=e),n.interleaved=e,wi(t,r)}function ju(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Hp(t,r)}}function cv(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Tf(t,e,r,n){var i=t.updateQueue;Bi=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var f=t.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=l:o.next=l,f.lastBaseUpdate=c))}if(s!==null){var h=i.baseState;a=0,f=l=c=null,o=s;do{var d=o.lane,m=o.eventTime;if((n&d)===d){f!==null&&(f=f.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,g=o;switch(d=e,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(m,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,d=typeof v=="function"?v.call(m,h,d):v,d==null)break e;h=gt({},h,d);break e;case 2:Bi=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(l=f=m,c=h):f=f.next=m,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(f===null&&(c=h),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Qs|=a,t.lanes=a,t.memoizedState=h}}function lv(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ae(191,i));i.call(n)}}}var Cl={},Kn=Es(Cl),el=Es(Cl),tl=Es(Cl);function Bs(t){if(t===Cl)throw Error(ae(174));return t}function im(t,e){switch(rt(tl,e),rt(el,t),rt(Kn,Cl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:fd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=fd(e,t)}lt(Kn),rt(Kn,e)}function po(){lt(Kn),lt(el),lt(tl)}function TE(t){Bs(tl.current);var e=Bs(Kn.current),r=fd(e,t.type);e!==r&&(rt(el,t),rt(Kn,r))}function sm(t){el.current===t&&(lt(Kn),lt(el))}var pt=Es(0);function kf(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Th=[];function am(){for(var t=0;t<Th.length;t++)Th[t]._workInProgressVersionPrimary=null;Th.length=0}var Gu=Ri.ReactCurrentDispatcher,kh=Ri.ReactCurrentBatchConfig,Ys=0,mt=null,Lt=null,Ht=null,Af=!1,kc=!1,rl=0,HI=0;function ar(){throw Error(ae(321))}function om(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Nn(t[r],e[r]))return!1;return!0}function cm(t,e,r,n,i,s){if(Ys=s,mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gu.current=t===null||t.memoizedState===null?GI:KI,t=r(n,i),kc){s=0;do{if(kc=!1,rl=0,25<=s)throw Error(ae(301));s+=1,Ht=Lt=null,e.updateQueue=null,Gu.current=qI,t=r(n,i)}while(kc)}if(Gu.current=Sf,e=Lt!==null&&Lt.next!==null,Ys=0,Ht=Lt=mt=null,Af=!1,e)throw Error(ae(300));return t}function lm(){var t=rl!==0;return rl=0,t}function $n(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?mt.memoizedState=Ht=t:Ht=Ht.next=t,Ht}function vn(){if(Lt===null){var t=mt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var e=Ht===null?mt.memoizedState:Ht.next;if(e!==null)Ht=e,Lt=t;else{if(t===null)throw Error(ae(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},Ht===null?mt.memoizedState=Ht=t:Ht=Ht.next=t}return Ht}function nl(t,e){return typeof e=="function"?e(t):e}function Ah(t){var e=vn(),r=e.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=t;var n=Lt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,c=null,l=s;do{var f=l.lane;if((Ys&f)===f)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(o=c=h,a=n):c=c.next=h,mt.lanes|=f,Qs|=f}l=l.next}while(l!==null&&l!==s);c===null?a=n:c.next=o,Nn(n,e.memoizedState)||(Mr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,mt.lanes|=s,Qs|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Sh(t){var e=vn(),r=e.queue;if(r===null)throw Error(ae(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Nn(s,e.memoizedState)||(Mr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function kE(){}function AE(t,e){var r=mt,n=vn(),i=e(),s=!Nn(n.memoizedState,i);if(s&&(n.memoizedState=i,Mr=!0),n=n.queue,um(CE.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Ht!==null&&Ht.memoizedState.tag&1){if(r.flags|=2048,il(9,IE.bind(null,r,n,i,e),void 0,null),Wt===null)throw Error(ae(349));Ys&30||SE(r,e,i)}return i}function SE(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function IE(t,e,r,n){e.value=r,e.getSnapshot=n,RE(e)&&PE(t)}function CE(t,e,r){return r(function(){RE(e)&&PE(t)})}function RE(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Nn(t,r)}catch{return!0}}function PE(t){var e=wi(t,1);e!==null&&Fn(e,t,1,-1)}function uv(t){var e=$n();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nl,lastRenderedState:t},e.queue=t,t=t.dispatch=jI.bind(null,mt,t),[e.memoizedState,t]}function il(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=mt.updateQueue,e===null?(e={lastEffect:null,stores:null},mt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function FE(){return vn().memoizedState}function Ku(t,e,r,n){var i=$n();mt.flags|=t,i.memoizedState=il(1|e,r,void 0,n===void 0?null:n)}function d0(t,e,r,n){var i=vn();n=n===void 0?null:n;var s=void 0;if(Lt!==null){var a=Lt.memoizedState;if(s=a.destroy,n!==null&&om(n,a.deps)){i.memoizedState=il(e,r,s,n);return}}mt.flags|=t,i.memoizedState=il(1|e,r,s,n)}function fv(t,e){return Ku(8390656,8,t,e)}function um(t,e){return d0(2048,8,t,e)}function DE(t,e){return d0(4,2,t,e)}function NE(t,e){return d0(4,4,t,e)}function OE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function LE(t,e,r){return r=r!=null?r.concat([t]):null,d0(4,4,OE.bind(null,e,t),r)}function fm(){}function ME(t,e){var r=vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&om(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function bE(t,e){var r=vn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&om(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function VE(t,e,r){return Ys&21?(Nn(r,e)||(r=Wy(),mt.lanes|=r,Qs|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Mr=!0),t.memoizedState=r)}function WI(t,e){var r=Qe;Qe=r!==0&&4>r?r:4,t(!0);var n=kh.transition;kh.transition={};try{t(!1),e()}finally{Qe=r,kh.transition=n}}function BE(){return vn().memoizedState}function $I(t,e,r){var n=ss(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},UE(t))zE(e,r);else if(r=EE(t,e,r,n),r!==null){var i=Ir();Fn(r,t,n,i),HE(r,e,n)}}function jI(t,e,r){var n=ss(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(UE(t))zE(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Nn(o,a)){var c=e.interleaved;c===null?(i.next=i,rm(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=EE(t,e,i,n),r!==null&&(i=Ir(),Fn(r,t,n,i),HE(r,e,n))}}function UE(t){var e=t.alternate;return t===mt||e!==null&&e===mt}function zE(t,e){kc=Af=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function HE(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Hp(t,r)}}var Sf={readContext:gn,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},GI={readContext:gn,useCallback:function(t,e){return $n().memoizedState=[t,e===void 0?null:e],t},useContext:gn,useEffect:fv,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ku(4194308,4,OE.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ku(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ku(4,2,t,e)},useMemo:function(t,e){var r=$n();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=$n();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=$I.bind(null,mt,t),[n.memoizedState,t]},useRef:function(t){var e=$n();return t={current:t},e.memoizedState=t},useState:uv,useDebugValue:fm,useDeferredValue:function(t){return $n().memoizedState=t},useTransition:function(){var t=uv(!1),e=t[0];return t=WI.bind(null,t[1]),$n().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=mt,i=$n();if(ht){if(r===void 0)throw Error(ae(407));r=r()}else{if(r=e(),Wt===null)throw Error(ae(349));Ys&30||SE(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,fv(CE.bind(null,n,s,t),[t]),n.flags|=2048,il(9,IE.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=$n(),e=Wt.identifierPrefix;if(ht){var r=fi,n=ui;r=(n&~(1<<32-Pn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=rl++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=HI++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},KI={readContext:gn,useCallback:ME,useContext:gn,useEffect:um,useImperativeHandle:LE,useInsertionEffect:DE,useLayoutEffect:NE,useMemo:bE,useReducer:Ah,useRef:FE,useState:function(){return Ah(nl)},useDebugValue:fm,useDeferredValue:function(t){var e=vn();return VE(e,Lt.memoizedState,t)},useTransition:function(){var t=Ah(nl)[0],e=vn().memoizedState;return[t,e]},useMutableSource:kE,useSyncExternalStore:AE,useId:BE,unstable_isNewReconciler:!1},qI={readContext:gn,useCallback:ME,useContext:gn,useEffect:um,useImperativeHandle:LE,useInsertionEffect:DE,useLayoutEffect:NE,useMemo:bE,useReducer:Sh,useRef:FE,useState:function(){return Sh(nl)},useDebugValue:fm,useDeferredValue:function(t){var e=vn();return Lt===null?e.memoizedState=t:VE(e,Lt.memoizedState,t)},useTransition:function(){var t=Sh(nl)[0],e=vn().memoizedState;return[t,e]},useMutableSource:kE,useSyncExternalStore:AE,useId:BE,unstable_isNewReconciler:!1};function kn(t,e){if(t&&t.defaultProps){e=gt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Dd(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:gt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var p0={isMounted:function(t){return(t=t._reactInternals)?ua(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ir(),i=ss(t),s=vi(n,i);s.payload=e,r!=null&&(s.callback=r),e=ns(t,s,i),e!==null&&(Fn(e,t,i,n),ju(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ir(),i=ss(t),s=vi(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=ns(t,s,i),e!==null&&(Fn(e,t,i,n),ju(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ir(),n=ss(t),i=vi(r,n);i.tag=2,e!=null&&(i.callback=e),e=ns(t,i,n),e!==null&&(Fn(e,t,n,r),ju(e,t,n))}};function hv(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Yc(r,n)||!Yc(i,s):!0}function WE(t,e,r){var n=!1,i=ps,s=e.contextType;return typeof s=="object"&&s!==null?s=gn(s):(i=Vr(e)?qs:vr.current,n=e.contextTypes,s=(n=n!=null)?uo(t,i):ps),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=p0,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function dv(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&p0.enqueueReplaceState(e,e.state,null)}function Nd(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},nm(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=gn(s):(s=Vr(e)?qs:vr.current,i.context=uo(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Dd(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&p0.enqueueReplaceState(i,i.state,null),Tf(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function mo(t,e){try{var r="",n=e;do r+=wS(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ih(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Od(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var XI=typeof WeakMap=="function"?WeakMap:Map;function $E(t,e,r){r=vi(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Cf||(Cf=!0,$d=n),Od(t,e)},r}function jE(t,e,r){r=vi(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){Od(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Od(t,e),typeof n!="function"&&(is===null?is=new Set([this]):is.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function pv(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new XI;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=lC.bind(null,t,e,r),e.then(t,t))}function mv(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gv(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=vi(-1,1),e.tag=2,ns(r,e,1))),r.lanes|=1),t)}var YI=Ri.ReactCurrentOwner,Mr=!1;function Tr(t,e,r,n){e.child=t===null?yE(e,null,r,n):ho(e,t.child,r,n)}function vv(t,e,r,n,i){r=r.render;var s=e.ref;return eo(e,i),n=cm(t,e,r,n,s,i),r=lm(),t!==null&&!Mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ti(t,e,i)):(ht&&r&&Yp(e),e.flags|=1,Tr(t,e,n,i),e.child)}function _v(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!xm(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,GE(t,e,s,n,i)):(t=Qu(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Yc,r(a,n)&&t.ref===e.ref)return Ti(t,e,i)}return e.flags|=1,t=as(s,n),t.ref=e.ref,t.return=e,e.child=t}function GE(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Yc(s,n)&&t.ref===e.ref)if(Mr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Mr=!0);else return e.lanes=t.lanes,Ti(t,e,i)}return Ld(t,e,r,n,i)}function KE(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},rt(Ka,Kr),Kr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,rt(Ka,Kr),Kr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,rt(Ka,Kr),Kr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,rt(Ka,Kr),Kr|=n;return Tr(t,e,i,r),e.child}function qE(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Ld(t,e,r,n,i){var s=Vr(r)?qs:vr.current;return s=uo(e,s),eo(e,i),r=cm(t,e,r,n,s,i),n=lm(),t!==null&&!Mr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ti(t,e,i)):(ht&&n&&Yp(e),e.flags|=1,Tr(t,e,r,i),e.child)}function xv(t,e,r,n,i){if(Vr(r)){var s=!0;_f(e)}else s=!1;if(eo(e,i),e.stateNode===null)qu(t,e),WE(e,r,n),Nd(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,l=r.contextType;typeof l=="object"&&l!==null?l=gn(l):(l=Vr(r)?qs:vr.current,l=uo(e,l));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||c!==l)&&dv(e,a,n,l),Bi=!1;var d=e.memoizedState;a.state=d,Tf(e,n,a,i),c=e.memoizedState,o!==n||d!==c||br.current||Bi?(typeof f=="function"&&(Dd(e,r,f,n),c=e.memoizedState),(o=Bi||hv(e,r,o,n,d,c,l))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),a.props=n,a.state=c,a.context=l,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,wE(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:kn(e.type,o),a.props=l,h=e.pendingProps,d=a.context,c=r.contextType,typeof c=="object"&&c!==null?c=gn(c):(c=Vr(r)?qs:vr.current,c=uo(e,c));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==c)&&dv(e,a,n,c),Bi=!1,d=e.memoizedState,a.state=d,Tf(e,n,a,i);var v=e.memoizedState;o!==h||d!==v||br.current||Bi?(typeof m=="function"&&(Dd(e,r,m,n),v=e.memoizedState),(l=Bi||hv(e,r,l,n,d,v,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),a.props=n,a.state=v,a.context=c,n=l):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Md(t,e,r,n,s,i)}function Md(t,e,r,n,i,s){qE(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&iv(e,r,!1),Ti(t,e,s);n=e.stateNode,YI.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=ho(e,t.child,null,s),e.child=ho(e,null,o,s)):Tr(t,e,o,s),e.memoizedState=n.state,i&&iv(e,r,!0),e.child}function XE(t){var e=t.stateNode;e.pendingContext?nv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nv(t,e.context,!1),im(t,e.containerInfo)}function yv(t,e,r,n,i){return fo(),Jp(i),e.flags|=256,Tr(t,e,r,n),e.child}var bd={dehydrated:null,treeContext:null,retryLane:0};function Vd(t){return{baseLanes:t,cachePool:null,transitions:null}}function YE(t,e,r){var n=e.pendingProps,i=pt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),rt(pt,i&1),t===null)return Pd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=v0(a,n,0,null),t=$s(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Vd(r),e.memoizedState=bd,t):hm(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return QI(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var c={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=as(i,c),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=as(o,s):(s=$s(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Vd(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=bd,n}return s=t.child,t=s.sibling,n=as(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function hm(t,e){return e=v0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function wu(t,e,r,n){return n!==null&&Jp(n),ho(e,t.child,null,r),t=hm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function QI(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=Ih(Error(ae(422))),wu(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=v0({mode:"visible",children:n.children},i,0,null),s=$s(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&ho(e,t.child,null,a),e.child.memoizedState=Vd(a),e.memoizedState=bd,s);if(!(e.mode&1))return wu(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ae(419)),n=Ih(s,n,void 0),wu(t,e,a,n)}if(o=(a&t.childLanes)!==0,Mr||o){if(n=Wt,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,wi(t,i),Fn(n,t,i,-1))}return _m(),n=Ih(Error(ae(421))),wu(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=uC.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Yr=rs(i.nextSibling),Jr=e,ht=!0,Sn=null,t!==null&&(fn[hn++]=ui,fn[hn++]=fi,fn[hn++]=Xs,ui=t.id,fi=t.overflow,Xs=e),e=hm(e,n.children),e.flags|=4096,e)}function Ev(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Fd(t.return,e,r)}function Ch(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function QE(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Tr(t,e,n.children,r),n=pt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ev(t,r,e);else if(t.tag===19)Ev(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(rt(pt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&kf(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Ch(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kf(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Ch(e,!0,r,null,s);break;case"together":Ch(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ti(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Qs|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,r=as(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=as(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function JI(t,e,r){switch(e.tag){case 3:XE(e),fo();break;case 5:TE(e);break;case 1:Vr(e.type)&&_f(e);break;case 4:im(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;rt(Ef,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(rt(pt,pt.current&1),e.flags|=128,null):r&e.child.childLanes?YE(t,e,r):(rt(pt,pt.current&1),t=Ti(t,e,r),t!==null?t.sibling:null);rt(pt,pt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return QE(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),rt(pt,pt.current),n)break;return null;case 22:case 23:return e.lanes=0,KE(t,e,r)}return Ti(t,e,r)}var JE,Bd,ZE,ew;JE=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Bd=function(){};ZE=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Bs(Kn.current);var s=null;switch(r){case"input":i=od(t,i),n=od(t,n),s=[];break;case"select":i=gt({},i,{value:void 0}),n=gt({},n,{value:void 0}),s=[];break;case"textarea":i=ud(t,i),n=ud(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=gf)}hd(r,n);var a;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var o=i[l];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Wc.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(o=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==o&&(c!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Wc.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&ot("scroll",t),s||o===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};ew=function(t,e,r,n){r!==n&&(e.flags|=4)};function rc(t,e){if(!ht)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function or(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function ZI(t,e,r){var n=e.pendingProps;switch(Qp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(e),null;case 1:return Vr(e.type)&&vf(),or(e),null;case 3:return n=e.stateNode,po(),lt(br),lt(vr),am(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(yu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(Kd(Sn),Sn=null))),Bd(t,e),or(e),null;case 5:sm(e);var i=Bs(tl.current);if(r=e.type,t!==null&&e.stateNode!=null)ZE(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(ae(166));return or(e),null}if(t=Bs(Kn.current),yu(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[jn]=e,n[Zc]=s,t=(e.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(i=0;i<cc.length;i++)ot(cc[i],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":P1(n,s),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ot("invalid",n);break;case"textarea":D1(n,s),ot("invalid",n)}hd(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&xu(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&xu(n.textContent,o,t),i=["children",""+o]):Wc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ot("scroll",n)}switch(r){case"input":fu(n),F1(n,s,!0);break;case"textarea":fu(n),N1(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=gf)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Cy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[jn]=e,t[Zc]=n,JE(t,e,!1,!1),e.stateNode=t;e:{switch(a=dd(r,n),r){case"dialog":ot("cancel",t),ot("close",t),i=n;break;case"iframe":case"object":case"embed":ot("load",t),i=n;break;case"video":case"audio":for(i=0;i<cc.length;i++)ot(cc[i],t);i=n;break;case"source":ot("error",t),i=n;break;case"img":case"image":case"link":ot("error",t),ot("load",t),i=n;break;case"details":ot("toggle",t),i=n;break;case"input":P1(t,n),i=od(t,n),ot("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=gt({},n,{value:void 0}),ot("invalid",t);break;case"textarea":D1(t,n),i=ud(t,n),ot("invalid",t);break;default:i=n}hd(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?Fy(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ry(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&$c(t,c):typeof c=="number"&&$c(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wc.hasOwnProperty(s)?c!=null&&s==="onScroll"&&ot("scroll",t):c!=null&&Mp(t,s,c,a))}switch(r){case"input":fu(t),F1(t,n,!1);break;case"textarea":fu(t),N1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ds(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?Ya(t,!!n.multiple,s,!1):n.defaultValue!=null&&Ya(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=gf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return or(e),null;case 6:if(t&&e.stateNode!=null)ew(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(ae(166));if(r=Bs(tl.current),Bs(Kn.current),yu(e)){if(n=e.stateNode,r=e.memoizedProps,n[jn]=e,(s=n.nodeValue!==r)&&(t=Jr,t!==null))switch(t.tag){case 3:xu(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&xu(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[jn]=e,e.stateNode=n}return or(e),null;case 13:if(lt(pt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ht&&Yr!==null&&e.mode&1&&!(e.flags&128))_E(),fo(),e.flags|=98560,s=!1;else if(s=yu(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(ae(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ae(317));s[jn]=e}else fo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;or(e),s=!1}else Sn!==null&&(Kd(Sn),Sn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||pt.current&1?Mt===0&&(Mt=3):_m())),e.updateQueue!==null&&(e.flags|=4),or(e),null);case 4:return po(),Bd(t,e),t===null&&Qc(e.stateNode.containerInfo),or(e),null;case 10:return tm(e.type._context),or(e),null;case 17:return Vr(e.type)&&vf(),or(e),null;case 19:if(lt(pt),s=e.memoizedState,s===null)return or(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)rc(s,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=kf(t),a!==null){for(e.flags|=128,rc(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return rt(pt,pt.current&1|2),e.child}t=t.sibling}s.tail!==null&&It()>go&&(e.flags|=128,n=!0,rc(s,!1),e.lanes=4194304)}else{if(!n)if(t=kf(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),rc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!ht)return or(e),null}else 2*It()-s.renderingStartTime>go&&r!==1073741824&&(e.flags|=128,n=!0,rc(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=It(),e.sibling=null,r=pt.current,rt(pt,n?r&1|2:r&1),e):(or(e),null);case 22:case 23:return vm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Kr&1073741824&&(or(e),e.subtreeFlags&6&&(e.flags|=8192)):or(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function eC(t,e){switch(Qp(e),e.tag){case 1:return Vr(e.type)&&vf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return po(),lt(br),lt(vr),am(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return sm(e),null;case 13:if(lt(pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));fo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(pt),null;case 4:return po(),null;case 10:return tm(e.type._context),null;case 22:case 23:return vm(),null;case 24:return null;default:return null}}var Tu=!1,hr=!1,tC=typeof WeakSet=="function"?WeakSet:Set,we=null;function Ga(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Et(t,e,n)}else r.current=null}function Ud(t,e,r){try{r()}catch(n){Et(t,e,n)}}var wv=!1;function rC(t,e){if(Td=df,t=sE(),Xp(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,c=-1,l=0,f=0,h=t,d=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(c=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++l===i&&(o=a),d===s&&++f===n&&(c=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(kd={focusedElem:t,selectionRange:r},df=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,E=v.memoizedState,w=e.stateNode,T=w.getSnapshotBeforeUpdate(e.elementType===e.type?g:kn(e.type,g),E);w.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(N){Et(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return v=wv,wv=!1,v}function Ac(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Ud(e,r,s)}i=i.next}while(i!==n)}}function m0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function zd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function tw(t){var e=t.alternate;e!==null&&(t.alternate=null,tw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jn],delete e[Zc],delete e[Id],delete e[VI],delete e[BI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function rw(t){return t.tag===5||t.tag===3||t.tag===4}function Tv(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||rw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Hd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=gf));else if(n!==4&&(t=t.child,t!==null))for(Hd(t,e,r),t=t.sibling;t!==null;)Hd(t,e,r),t=t.sibling}function Wd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Wd(t,e,r),t=t.sibling;t!==null;)Wd(t,e,r),t=t.sibling}var qt=null,An=!1;function Li(t,e,r){for(r=r.child;r!==null;)nw(t,e,r),r=r.sibling}function nw(t,e,r){if(Gn&&typeof Gn.onCommitFiberUnmount=="function")try{Gn.onCommitFiberUnmount(o0,r)}catch{}switch(r.tag){case 5:hr||Ga(r,e);case 6:var n=qt,i=An;qt=null,Li(t,e,r),qt=n,An=i,qt!==null&&(An?(t=qt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):qt.removeChild(r.stateNode));break;case 18:qt!==null&&(An?(t=qt,r=r.stateNode,t.nodeType===8?Eh(t.parentNode,r):t.nodeType===1&&Eh(t,r),qc(t)):Eh(qt,r.stateNode));break;case 4:n=qt,i=An,qt=r.stateNode.containerInfo,An=!0,Li(t,e,r),qt=n,An=i;break;case 0:case 11:case 14:case 15:if(!hr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Ud(r,e,a),i=i.next}while(i!==n)}Li(t,e,r);break;case 1:if(!hr&&(Ga(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Et(r,e,o)}Li(t,e,r);break;case 21:Li(t,e,r);break;case 22:r.mode&1?(hr=(n=hr)||r.memoizedState!==null,Li(t,e,r),hr=n):Li(t,e,r);break;default:Li(t,e,r)}}function kv(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new tC),e.forEach(function(n){var i=fC.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function En(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:qt=o.stateNode,An=!1;break e;case 3:qt=o.stateNode.containerInfo,An=!0;break e;case 4:qt=o.stateNode.containerInfo,An=!0;break e}o=o.return}if(qt===null)throw Error(ae(160));nw(s,a,i),qt=null,An=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){Et(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)iw(e,t),e=e.sibling}function iw(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(En(e,t),zn(t),n&4){try{Ac(3,t,t.return),m0(3,t)}catch(g){Et(t,t.return,g)}try{Ac(5,t,t.return)}catch(g){Et(t,t.return,g)}}break;case 1:En(e,t),zn(t),n&512&&r!==null&&Ga(r,r.return);break;case 5:if(En(e,t),zn(t),n&512&&r!==null&&Ga(r,r.return),t.flags&32){var i=t.stateNode;try{$c(i,"")}catch(g){Et(t,t.return,g)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Sy(i,s),dd(o,a);var l=dd(o,s);for(a=0;a<c.length;a+=2){var f=c[a],h=c[a+1];f==="style"?Fy(i,h):f==="dangerouslySetInnerHTML"?Ry(i,h):f==="children"?$c(i,h):Mp(i,f,h,l)}switch(o){case"input":cd(i,s);break;case"textarea":Iy(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Ya(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?Ya(i,!!s.multiple,s.defaultValue,!0):Ya(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zc]=s}catch(g){Et(t,t.return,g)}}break;case 6:if(En(e,t),zn(t),n&4){if(t.stateNode===null)throw Error(ae(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Et(t,t.return,g)}}break;case 3:if(En(e,t),zn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qc(e.containerInfo)}catch(g){Et(t,t.return,g)}break;case 4:En(e,t),zn(t);break;case 13:En(e,t),zn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(mm=It())),n&4&&kv(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(hr=(l=hr)||f,En(e,t),hr=l):En(e,t),zn(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!f&&t.mode&1)for(we=t,f=t.child;f!==null;){for(h=we=f;we!==null;){switch(d=we,m=d.child,d.tag){case 0:case 11:case 14:case 15:Ac(4,d,d.return);break;case 1:Ga(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){Et(n,r,g)}}break;case 5:Ga(d,d.return);break;case 22:if(d.memoizedState!==null){Sv(h);continue}}m!==null?(m.return=d,we=m):Sv(h)}f=f.sibling}e:for(f=null,h=t;;){if(h.tag===5){if(f===null){f=h;try{i=h.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,c=h.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Py("display",a))}catch(g){Et(t,t.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(g){Et(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:En(e,t),zn(t),n&4&&kv(t);break;case 21:break;default:En(e,t),zn(t)}}function zn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(rw(r)){var n=r;break e}r=r.return}throw Error(ae(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&($c(i,""),n.flags&=-33);var s=Tv(t);Wd(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Tv(t);Hd(t,o,a);break;default:throw Error(ae(161))}}catch(c){Et(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function nC(t,e,r){we=t,sw(t)}function sw(t,e,r){for(var n=(t.mode&1)!==0;we!==null;){var i=we,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Tu;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||hr;o=Tu;var l=hr;if(Tu=a,(hr=c)&&!l)for(we=i;we!==null;)a=we,c=a.child,a.tag===22&&a.memoizedState!==null?Iv(i):c!==null?(c.return=a,we=c):Iv(i);for(;s!==null;)we=s,sw(s),s=s.sibling;we=i,Tu=o,hr=l}Av(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,we=s):Av(t)}}function Av(t){for(;we!==null;){var e=we;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hr||m0(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!hr)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:kn(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&lv(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}lv(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var f=l.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&qc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}hr||e.flags&512&&zd(e)}catch(d){Et(e,e.return,d)}}if(e===t){we=null;break}if(r=e.sibling,r!==null){r.return=e.return,we=r;break}we=e.return}}function Sv(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var r=e.sibling;if(r!==null){r.return=e.return,we=r;break}we=e.return}}function Iv(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{m0(4,e)}catch(c){Et(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){Et(e,i,c)}}var s=e.return;try{zd(e)}catch(c){Et(e,s,c)}break;case 5:var a=e.return;try{zd(e)}catch(c){Et(e,a,c)}}}catch(c){Et(e,e.return,c)}if(e===t){we=null;break}var o=e.sibling;if(o!==null){o.return=e.return,we=o;break}we=e.return}}var iC=Math.ceil,If=Ri.ReactCurrentDispatcher,dm=Ri.ReactCurrentOwner,pn=Ri.ReactCurrentBatchConfig,je=0,Wt=null,Dt=null,Jt=0,Kr=0,Ka=Es(0),Mt=0,sl=null,Qs=0,g0=0,pm=0,Sc=null,Or=null,mm=0,go=1/0,ci=null,Cf=!1,$d=null,is=null,ku=!1,Xi=null,Rf=0,Ic=0,jd=null,Xu=-1,Yu=0;function Ir(){return je&6?It():Xu!==-1?Xu:Xu=It()}function ss(t){return t.mode&1?je&2&&Jt!==0?Jt&-Jt:zI.transition!==null?(Yu===0&&(Yu=Wy()),Yu):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:Yy(t.type)),t):1}function Fn(t,e,r,n){if(50<Ic)throw Ic=0,jd=null,Error(ae(185));Al(t,r,n),(!(je&2)||t!==Wt)&&(t===Wt&&(!(je&2)&&(g0|=r),Mt===4&&zi(t,Jt)),Br(t,n),r===1&&je===0&&!(e.mode&1)&&(go=It()+500,h0&&ws()))}function Br(t,e){var r=t.callbackNode;zS(t,e);var n=hf(t,t===Wt?Jt:0);if(n===0)r!==null&&M1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&M1(r),e===1)t.tag===0?UI(Cv.bind(null,t)):mE(Cv.bind(null,t)),MI(function(){!(je&6)&&ws()}),r=null;else{switch($y(n)){case 1:r=zp;break;case 4:r=zy;break;case 16:r=ff;break;case 536870912:r=Hy;break;default:r=ff}r=dw(r,aw.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function aw(t,e){if(Xu=-1,Yu=0,je&6)throw Error(ae(327));var r=t.callbackNode;if(to()&&t.callbackNode!==r)return null;var n=hf(t,t===Wt?Jt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Pf(t,n);else{e=n;var i=je;je|=2;var s=cw();(Wt!==t||Jt!==e)&&(ci=null,go=It()+500,Ws(t,e));do try{oC();break}catch(o){ow(t,o)}while(1);em(),If.current=s,je=i,Dt!==null?e=0:(Wt=null,Jt=0,e=Mt)}if(e!==0){if(e===2&&(i=_d(t),i!==0&&(n=i,e=Gd(t,i))),e===1)throw r=sl,Ws(t,0),zi(t,n),Br(t,It()),r;if(e===6)zi(t,n);else{if(i=t.current.alternate,!(n&30)&&!sC(i)&&(e=Pf(t,n),e===2&&(s=_d(t),s!==0&&(n=s,e=Gd(t,s))),e===1))throw r=sl,Ws(t,0),zi(t,n),Br(t,It()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(ae(345));case 2:Os(t,Or,ci);break;case 3:if(zi(t,n),(n&130023424)===n&&(e=mm+500-It(),10<e)){if(hf(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ir(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Sd(Os.bind(null,t,Or,ci),e);break}Os(t,Or,ci);break;case 4:if(zi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-Pn(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=It()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*iC(n/1960))-n,10<n){t.timeoutHandle=Sd(Os.bind(null,t,Or,ci),n);break}Os(t,Or,ci);break;case 5:Os(t,Or,ci);break;default:throw Error(ae(329))}}}return Br(t,It()),t.callbackNode===r?aw.bind(null,t):null}function Gd(t,e){var r=Sc;return t.current.memoizedState.isDehydrated&&(Ws(t,e).flags|=256),t=Pf(t,e),t!==2&&(e=Or,Or=r,e!==null&&Kd(e)),t}function Kd(t){Or===null?Or=t:Or.push.apply(Or,t)}function sC(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Nn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zi(t,e){for(e&=~pm,e&=~g0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Pn(e),n=1<<r;t[r]=-1,e&=~n}}function Cv(t){if(je&6)throw Error(ae(327));to();var e=hf(t,0);if(!(e&1))return Br(t,It()),null;var r=Pf(t,e);if(t.tag!==0&&r===2){var n=_d(t);n!==0&&(e=n,r=Gd(t,n))}if(r===1)throw r=sl,Ws(t,0),zi(t,e),Br(t,It()),r;if(r===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Os(t,Or,ci),Br(t,It()),null}function gm(t,e){var r=je;je|=1;try{return t(e)}finally{je=r,je===0&&(go=It()+500,h0&&ws())}}function Js(t){Xi!==null&&Xi.tag===0&&!(je&6)&&to();var e=je;je|=1;var r=pn.transition,n=Qe;try{if(pn.transition=null,Qe=1,t)return t()}finally{Qe=n,pn.transition=r,je=e,!(je&6)&&ws()}}function vm(){Kr=Ka.current,lt(Ka)}function Ws(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,LI(r)),Dt!==null)for(r=Dt.return;r!==null;){var n=r;switch(Qp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vf();break;case 3:po(),lt(br),lt(vr),am();break;case 5:sm(n);break;case 4:po();break;case 13:lt(pt);break;case 19:lt(pt);break;case 10:tm(n.type._context);break;case 22:case 23:vm()}r=r.return}if(Wt=t,Dt=t=as(t.current,null),Jt=Kr=e,Mt=0,sl=null,pm=g0=Qs=0,Or=Sc=null,Vs!==null){for(e=0;e<Vs.length;e++)if(r=Vs[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Vs=null}return t}function ow(t,e){do{var r=Dt;try{if(em(),Gu.current=Sf,Af){for(var n=mt.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Af=!1}if(Ys=0,Ht=Lt=mt=null,kc=!1,rl=0,dm.current=null,r===null||r.return===null){Mt=1,sl=e,Dt=null;break}e:{var s=t,a=r.return,o=r,c=e;if(e=Jt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var d=f.alternate;d?(f.updateQueue=d.updateQueue,f.memoizedState=d.memoizedState,f.lanes=d.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=mv(a);if(m!==null){m.flags&=-257,gv(m,a,o,s,e),m.mode&1&&pv(s,l,e),e=m,c=l;var v=e.updateQueue;if(v===null){var g=new Set;g.add(c),e.updateQueue=g}else v.add(c);break e}else{if(!(e&1)){pv(s,l,e),_m();break e}c=Error(ae(426))}}else if(ht&&o.mode&1){var E=mv(a);if(E!==null){!(E.flags&65536)&&(E.flags|=256),gv(E,a,o,s,e),Jp(mo(c,o));break e}}s=c=mo(c,o),Mt!==4&&(Mt=2),Sc===null?Sc=[s]:Sc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=$E(s,c,e);cv(s,w);break e;case 1:o=c;var T=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(is===null||!is.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var N=jE(s,o,e);cv(s,N);break e}}s=s.return}while(s!==null)}uw(r)}catch(z){e=z,Dt===r&&r!==null&&(Dt=r=r.return);continue}break}while(1)}function cw(){var t=If.current;return If.current=Sf,t===null?Sf:t}function _m(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Wt===null||!(Qs&268435455)&&!(g0&268435455)||zi(Wt,Jt)}function Pf(t,e){var r=je;je|=2;var n=cw();(Wt!==t||Jt!==e)&&(ci=null,Ws(t,e));do try{aC();break}catch(i){ow(t,i)}while(1);if(em(),je=r,If.current=n,Dt!==null)throw Error(ae(261));return Wt=null,Jt=0,Mt}function aC(){for(;Dt!==null;)lw(Dt)}function oC(){for(;Dt!==null&&!DS();)lw(Dt)}function lw(t){var e=hw(t.alternate,t,Kr);t.memoizedProps=t.pendingProps,e===null?uw(t):Dt=e,dm.current=null}function uw(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=eC(r,e),r!==null){r.flags&=32767,Dt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,Dt=null;return}}else if(r=ZI(r,e,Kr),r!==null){Dt=r;return}if(e=e.sibling,e!==null){Dt=e;return}Dt=e=t}while(e!==null);Mt===0&&(Mt=5)}function Os(t,e,r){var n=Qe,i=pn.transition;try{pn.transition=null,Qe=1,cC(t,e,r,n)}finally{pn.transition=i,Qe=n}return null}function cC(t,e,r,n){do to();while(Xi!==null);if(je&6)throw Error(ae(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(HS(t,s),t===Wt&&(Dt=Wt=null,Jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ku||(ku=!0,dw(ff,function(){return to(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=pn.transition,pn.transition=null;var a=Qe;Qe=1;var o=je;je|=4,dm.current=null,rC(t,r),iw(r,t),CI(kd),df=!!Td,kd=Td=null,t.current=r,nC(r),NS(),je=o,Qe=a,pn.transition=s}else t.current=r;if(ku&&(ku=!1,Xi=t,Rf=i),s=t.pendingLanes,s===0&&(is=null),MS(r.stateNode),Br(t,It()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Cf)throw Cf=!1,t=$d,$d=null,t;return Rf&1&&t.tag!==0&&to(),s=t.pendingLanes,s&1?t===jd?Ic++:(Ic=0,jd=t):Ic=0,ws(),null}function to(){if(Xi!==null){var t=$y(Rf),e=pn.transition,r=Qe;try{if(pn.transition=null,Qe=16>t?16:t,Xi===null)var n=!1;else{if(t=Xi,Xi=null,Rf=0,je&6)throw Error(ae(331));var i=je;for(je|=4,we=t.current;we!==null;){var s=we,a=s.child;if(we.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var l=o[c];for(we=l;we!==null;){var f=we;switch(f.tag){case 0:case 11:case 15:Ac(8,f,s)}var h=f.child;if(h!==null)h.return=f,we=h;else for(;we!==null;){f=we;var d=f.sibling,m=f.return;if(tw(f),f===l){we=null;break}if(d!==null){d.return=m,we=d;break}we=m}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}we=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,we=a;else e:for(;we!==null;){if(s=we,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ac(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,we=w;break e}we=s.return}}var T=t.current;for(we=T;we!==null;){a=we;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,we=_;else e:for(a=T;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:m0(9,o)}}catch(z){Et(o,o.return,z)}if(o===a){we=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,we=N;break e}we=o.return}}if(je=i,ws(),Gn&&typeof Gn.onPostCommitFiberRoot=="function")try{Gn.onPostCommitFiberRoot(o0,t)}catch{}n=!0}return n}finally{Qe=r,pn.transition=e}}return!1}function Rv(t,e,r){e=mo(r,e),e=$E(t,e,1),t=ns(t,e,1),e=Ir(),t!==null&&(Al(t,1,e),Br(t,e))}function Et(t,e,r){if(t.tag===3)Rv(t,t,r);else for(;e!==null;){if(e.tag===3){Rv(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(is===null||!is.has(n))){t=mo(r,t),t=jE(e,t,1),e=ns(e,t,1),t=Ir(),e!==null&&(Al(e,1,t),Br(e,t));break}}e=e.return}}function lC(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ir(),t.pingedLanes|=t.suspendedLanes&r,Wt===t&&(Jt&r)===r&&(Mt===4||Mt===3&&(Jt&130023424)===Jt&&500>It()-mm?Ws(t,0):pm|=r),Br(t,e)}function fw(t,e){e===0&&(t.mode&1?(e=pu,pu<<=1,!(pu&130023424)&&(pu=4194304)):e=1);var r=Ir();t=wi(t,e),t!==null&&(Al(t,e,r),Br(t,r))}function uC(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),fw(t,r)}function fC(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ae(314))}n!==null&&n.delete(e),fw(t,r)}var hw;hw=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||br.current)Mr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Mr=!1,JI(t,e,r);Mr=!!(t.flags&131072)}else Mr=!1,ht&&e.flags&1048576&&gE(e,yf,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;qu(t,e),t=e.pendingProps;var i=uo(e,vr.current);eo(e,r),i=cm(null,e,n,t,i,r);var s=lm();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Vr(n)?(s=!0,_f(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,nm(e),i.updater=p0,e.stateNode=i,i._reactInternals=e,Nd(e,n,t,r),e=Md(null,e,n,!0,s,r)):(e.tag=0,ht&&s&&Yp(e),Tr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(qu(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=dC(n),t=kn(n,t),i){case 0:e=Ld(null,e,n,t,r);break e;case 1:e=xv(null,e,n,t,r);break e;case 11:e=vv(null,e,n,t,r);break e;case 14:e=_v(null,e,n,kn(n.type,t),r);break e}throw Error(ae(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:kn(n,i),Ld(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:kn(n,i),xv(t,e,n,i,r);case 3:e:{if(XE(e),t===null)throw Error(ae(387));n=e.pendingProps,s=e.memoizedState,i=s.element,wE(t,e),Tf(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=mo(Error(ae(423)),e),e=yv(t,e,n,r,i);break e}else if(n!==i){i=mo(Error(ae(424)),e),e=yv(t,e,n,r,i);break e}else for(Yr=rs(e.stateNode.containerInfo.firstChild),Jr=e,ht=!0,Sn=null,r=yE(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fo(),n===i){e=Ti(t,e,r);break e}Tr(t,e,n,r)}e=e.child}return e;case 5:return TE(e),t===null&&Pd(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,Ad(n,i)?a=null:s!==null&&Ad(n,s)&&(e.flags|=32),qE(t,e),Tr(t,e,a,r),e.child;case 6:return t===null&&Pd(e),null;case 13:return YE(t,e,r);case 4:return im(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=ho(e,null,n,r):Tr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:kn(n,i),vv(t,e,n,i,r);case 7:return Tr(t,e,e.pendingProps,r),e.child;case 8:return Tr(t,e,e.pendingProps.children,r),e.child;case 12:return Tr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,rt(Ef,n._currentValue),n._currentValue=a,s!==null)if(Nn(s.value,a)){if(s.children===i.children&&!br.current){e=Ti(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=vi(-1,r&-r),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var f=l.pending;f===null?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Fd(s.return,r,e),o.lanes|=r;break}c=c.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ae(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Fd(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Tr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,eo(e,r),i=gn(i),n=n(i),e.flags|=1,Tr(t,e,n,r),e.child;case 14:return n=e.type,i=kn(n,e.pendingProps),i=kn(n.type,i),_v(t,e,n,i,r);case 15:return GE(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:kn(n,i),qu(t,e),e.tag=1,Vr(n)?(t=!0,_f(e)):t=!1,eo(e,r),WE(e,n,i),Nd(e,n,i,r),Md(null,e,n,!0,t,r);case 19:return QE(t,e,r);case 22:return KE(t,e,r)}throw Error(ae(156,e.tag))};function dw(t,e){return Uy(t,e)}function hC(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(t,e,r,n){return new hC(t,e,r,n)}function xm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dC(t){if(typeof t=="function")return xm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vp)return 11;if(t===Bp)return 14}return 2}function as(t,e){var r=t.alternate;return r===null?(r=dn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Qu(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")xm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ba:return $s(r.children,i,s,e);case bp:a=8,i|=8;break;case nd:return t=dn(12,r,e,i|2),t.elementType=nd,t.lanes=s,t;case id:return t=dn(13,r,e,i),t.elementType=id,t.lanes=s,t;case sd:return t=dn(19,r,e,i),t.elementType=sd,t.lanes=s,t;case Ty:return v0(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ey:a=10;break e;case wy:a=9;break e;case Vp:a=11;break e;case Bp:a=14;break e;case Vi:a=16,n=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=dn(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function $s(t,e,r,n){return t=dn(7,t,n,e),t.lanes=r,t}function v0(t,e,r,n){return t=dn(22,t,n,e),t.elementType=Ty,t.lanes=r,t.stateNode={isHidden:!1},t}function Rh(t,e,r){return t=dn(6,t,null,e),t.lanes=r,t}function Ph(t,e,r){return e=dn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function pC(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uh(0),this.expirationTimes=uh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ym(t,e,r,n,i,s,a,o,c){return t=new pC(t,e,r,o,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=dn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},nm(s),t}function mC(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ma,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function pw(t){if(!t)return ps;t=t._reactInternals;e:{if(ua(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Vr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var r=t.type;if(Vr(r))return pE(t,r,e)}return e}function mw(t,e,r,n,i,s,a,o,c){return t=ym(r,n,!0,t,i,s,a,o,c),t.context=pw(null),r=t.current,n=Ir(),i=ss(r),s=vi(n,i),s.callback=e??null,ns(r,s,i),t.current.lanes=i,Al(t,i,n),Br(t,n),t}function _0(t,e,r,n){var i=e.current,s=Ir(),a=ss(i);return r=pw(r),e.context===null?e.context=r:e.pendingContext=r,e=vi(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=ns(i,e,a),t!==null&&(Fn(t,i,a,s),ju(t,i,a)),a}function Ff(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Pv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Em(t,e){Pv(t,e),(t=t.alternate)&&Pv(t,e)}function gC(){return null}var gw=typeof reportError=="function"?reportError:function(t){console.error(t)};function wm(t){this._internalRoot=t}x0.prototype.render=wm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));_0(t,e,null,null)};x0.prototype.unmount=wm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Js(function(){_0(null,t,null,null)}),e[Ei]=null}};function x0(t){this._internalRoot=t}x0.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ky();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ui.length&&e!==0&&e<Ui[r].priority;r++);Ui.splice(r,0,t),r===0&&Xy(t)}};function Tm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function y0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fv(){}function vC(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var l=Ff(a);s.call(l)}}var a=mw(e,n,t,0,null,!1,!1,"",Fv);return t._reactRootContainer=a,t[Ei]=a.current,Qc(t.nodeType===8?t.parentNode:t),Js(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var l=Ff(c);o.call(l)}}var c=ym(t,0,!1,null,null,!1,!1,"",Fv);return t._reactRootContainer=c,t[Ei]=c.current,Qc(t.nodeType===8?t.parentNode:t),Js(function(){_0(e,c,r,n)}),c}function E0(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var c=Ff(a);o.call(c)}}_0(e,a,t,i)}else a=vC(r,e,t,i,n);return Ff(a)}jy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=oc(e.pendingLanes);r!==0&&(Hp(e,r|1),Br(e,It()),!(je&6)&&(go=It()+500,ws()))}break;case 13:Js(function(){var n=wi(t,1);if(n!==null){var i=Ir();Fn(n,t,1,i)}}),Em(t,1)}};Wp=function(t){if(t.tag===13){var e=wi(t,134217728);if(e!==null){var r=Ir();Fn(e,t,134217728,r)}Em(t,134217728)}};Gy=function(t){if(t.tag===13){var e=ss(t),r=wi(t,e);if(r!==null){var n=Ir();Fn(r,t,e,n)}Em(t,e)}};Ky=function(){return Qe};qy=function(t,e){var r=Qe;try{return Qe=t,e()}finally{Qe=r}};md=function(t,e,r){switch(e){case"input":if(cd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=f0(n);if(!i)throw Error(ae(90));Ay(n),cd(n,i)}}}break;case"textarea":Iy(t,r);break;case"select":e=r.value,e!=null&&Ya(t,!!r.multiple,e,!1)}};Oy=gm;Ly=Js;var _C={usingClientEntryPoint:!1,Events:[Il,za,f0,Dy,Ny,gm]},nc={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xC={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ri.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vy(t),t===null?null:t.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||gC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Au.isDisabled&&Au.supportsFiber)try{o0=Au.inject(xC),Gn=Au}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_C;nn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tm(e))throw Error(ae(200));return mC(t,e,null,r)};nn.createRoot=function(t,e){if(!Tm(t))throw Error(ae(299));var r=!1,n="",i=gw;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=ym(t,1,!1,null,null,r,!1,n,i),t[Ei]=e.current,Qc(t.nodeType===8?t.parentNode:t),new wm(e)};nn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=Vy(e),t=t===null?null:t.stateNode,t};nn.flushSync=function(t){return Js(t)};nn.hydrate=function(t,e,r){if(!y0(e))throw Error(ae(200));return E0(null,t,e,!0,r)};nn.hydrateRoot=function(t,e,r){if(!Tm(t))throw Error(ae(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=gw;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=mw(e,null,t,1,r??null,i,!1,s,a),t[Ei]=e.current,Qc(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new x0(e)};nn.render=function(t,e,r){if(!y0(e))throw Error(ae(200));return E0(null,t,e,!1,r)};nn.unmountComponentAtNode=function(t){if(!y0(t))throw Error(ae(40));return t._reactRootContainer?(Js(function(){E0(null,null,t,!1,function(){t._reactRootContainer=null,t[Ei]=null})}),!0):!1};nn.unstable_batchedUpdates=gm;nn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!y0(r))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return E0(t,e,r,!1,n)};nn.version="18.3.1-next-f1338f8080-20240426";function vw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vw)}catch(t){console.error(t)}}vw(),vy.exports=nn;var CB=vy.exports;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},yC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},xw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,f=s>>2,h=(s&3)<<4|o>>4;let d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(r[f],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_w(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):yC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const l=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||l==null||h==null)throw new EC;const d=s<<2|o>>4;if(n.push(d),l!==64){const m=o<<4&240|l>>2;if(n.push(m),h!==64){const v=l<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class EC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(t){const e=_w(t);return xw.encodeByteArray(e,!0)},Df=function(t){return wC(t).replace(/\./g,"")},yw=function(t){try{return xw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=()=>TC().__FIREBASE_DEFAULTS__,AC=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},SC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yw(t[1]);return e&&JSON.parse(e)},w0=()=>{try{return kC()||AC()||SC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Ew=t=>{var e,r;return(r=(e=w0())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},IC=t=>{const e=Ew(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},ww=()=>{var t;return(t=w0())===null||t===void 0?void 0:t.config},Tw=t=>{var e;return(e=w0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),o="";return[Df(JSON.stringify(r)),Df(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _r(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_r())}function FC(){var t;const e=(t=w0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function DC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kw(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function NC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function OC(){const t=_r();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function LC(){return!FC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Aw(){try{return typeof indexedDB=="object"}catch{return!1}}function Sw(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}function MC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="FirebaseError";class bn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=bC,Object.setPrototypeOf(this,bn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fa.prototype.create)}}class fa{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?VC(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new bn(i,o,n)}}function VC(t,e){return t.replace(BC,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const BC=/\{\$([^}]+)}/g;function UC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function al(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const s=t[i],a=e[i];if(Dv(s)&&Dv(a)){if(!al(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Dv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rl(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function lc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function uc(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function zC(t,e){const r=new HC(t,e);return r.subscribe.bind(r)}class HC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");WC(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Fh),i.error===void 0&&(i.error=Fh),i.complete===void 0&&(i.complete=Fh);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function WC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Fh(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=1e3,jC=2,GC=4*60*60*1e3,KC=.5;function Nv(t,e=$C,r=jC){const n=e*Math.pow(r,t),i=Math.round(KC*n*(Math.random()-.5)*2);return Math.min(GC,n+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(t){return t&&t._delegate?t._delegate:t}class On{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new CC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YC(e))try{this.getOrInitializeService({instanceIdentifier:Ls})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Ls){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ls){return this.instances.has(e)}getOptions(e=Ls){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:XC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ls){return this.component?this.component.multipleInstances?e:Ls:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XC(t){return t===Ls?void 0:t}function YC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ue||(Ue={}));const JC={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},ZC=Ue.INFO,e4={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},t4=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=e4[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class T0{constructor(e){this.name=e,this._logLevel=ZC,this._logHandler=t4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const r4=(t,e)=>e.some(r=>t instanceof r);let Ov,Lv;function n4(){return Ov||(Ov=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function i4(){return Lv||(Lv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Iw=new WeakMap,qd=new WeakMap,Cw=new WeakMap,Dh=new WeakMap,km=new WeakMap;function s4(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(os(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&Iw.set(r,t)}).catch(()=>{}),km.set(e,t),e}function a4(t){if(qd.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});qd.set(t,e)}let Xd={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return qd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Cw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return os(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function o4(t){Xd=t(Xd)}function c4(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Nh(this),e,...r);return Cw.set(n,e.sort?e.sort():[e]),os(n)}:i4().includes(t)?function(...e){return t.apply(Nh(this),e),os(Iw.get(this))}:function(...e){return os(t.apply(Nh(this),e))}}function l4(t){return typeof t=="function"?c4(t):(t instanceof IDBTransaction&&a4(t),r4(t,n4())?new Proxy(t,Xd):t)}function os(t){if(t instanceof IDBRequest)return s4(t);if(Dh.has(t))return Dh.get(t);const e=l4(t);return e!==t&&(Dh.set(t,e),km.set(e,t)),e}const Nh=t=>km.get(t);function Rw(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),o=os(a);return n&&a.addEventListener("upgradeneeded",c=>{n(os(a.result),c.oldVersion,c.newVersion,os(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const u4=["get","getKey","getAll","getAllKeys","count"],f4=["put","add","delete","clear"],Oh=new Map;function Mv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Oh.get(e))return Oh.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=f4.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||u4.includes(r)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&c.done]))[0]};return Oh.set(e,s),s}o4(t=>({...t,get:(e,r,n)=>Mv(e,r)||t.get(e,r,n),has:(e,r)=>!!Mv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(d4(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function d4(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Yd="@firebase/app",bv="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki=new T0("@firebase/app"),p4="@firebase/app-compat",m4="@firebase/analytics-compat",g4="@firebase/analytics",v4="@firebase/app-check-compat",_4="@firebase/app-check",x4="@firebase/auth",y4="@firebase/auth-compat",E4="@firebase/database",w4="@firebase/data-connect",T4="@firebase/database-compat",k4="@firebase/functions",A4="@firebase/functions-compat",S4="@firebase/installations",I4="@firebase/installations-compat",C4="@firebase/messaging",R4="@firebase/messaging-compat",P4="@firebase/performance",F4="@firebase/performance-compat",D4="@firebase/remote-config",N4="@firebase/remote-config-compat",O4="@firebase/storage",L4="@firebase/storage-compat",M4="@firebase/firestore",b4="@firebase/vertexai-preview",V4="@firebase/firestore-compat",B4="firebase",U4="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd="[DEFAULT]",z4={[Yd]:"fire-core",[p4]:"fire-core-compat",[g4]:"fire-analytics",[m4]:"fire-analytics-compat",[_4]:"fire-app-check",[v4]:"fire-app-check-compat",[x4]:"fire-auth",[y4]:"fire-auth-compat",[E4]:"fire-rtdb",[w4]:"fire-data-connect",[T4]:"fire-rtdb-compat",[k4]:"fire-fn",[A4]:"fire-fn-compat",[S4]:"fire-iid",[I4]:"fire-iid-compat",[C4]:"fire-fcm",[R4]:"fire-fcm-compat",[P4]:"fire-perf",[F4]:"fire-perf-compat",[D4]:"fire-rc",[N4]:"fire-rc-compat",[O4]:"fire-gcs",[L4]:"fire-gcs-compat",[M4]:"fire-fst",[V4]:"fire-fst-compat",[b4]:"fire-vertex","fire-js":"fire-js",[B4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=new Map,H4=new Map,Jd=new Map;function Vv(t,e){try{t.container.addComponent(e)}catch(r){ki.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Zn(t){const e=t.name;if(Jd.has(e))return ki.debug(`There were multiple attempts to register component ${e}.`),!1;Jd.set(e,t);for(const r of Nf.values())Vv(r,t);for(const r of H4.values())Vv(r,t);return!0}function ha(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function hi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cs=new fa("app","Firebase",W4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new On("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=U4;function j4(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Qd,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw cs.create("bad-app-name",{appName:String(i)});if(r||(r=ww()),!r)throw cs.create("no-options");const s=Nf.get(i);if(s){if(al(r,s.options)&&al(n,s.config))return s;throw cs.create("duplicate-app",{appName:i})}const a=new QC(i);for(const c of Jd.values())a.addComponent(c);const o=new $4(r,n,a);return Nf.set(i,o),o}function Am(t=Qd){const e=Nf.get(t);if(!e&&t===Qd&&ww())return j4();if(!e)throw cs.create("no-app",{appName:t});return e}function mn(t,e,r){var n;let i=(n=z4[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ki.warn(o.join(" "));return}Zn(new On(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="firebase-heartbeat-database",K4=1,ol="firebase-heartbeat-store";let Lh=null;function Pw(){return Lh||(Lh=Rw(G4,K4,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ol)}catch(r){console.warn(r)}}}}).catch(t=>{throw cs.create("idb-open",{originalErrorMessage:t.message})})),Lh}async function q4(t){try{const r=(await Pw()).transaction(ol),n=await r.objectStore(ol).get(Fw(t));return await r.done,n}catch(e){if(e instanceof bn)ki.warn(e.message);else{const r=cs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ki.warn(r.message)}}}async function Bv(t,e){try{const n=(await Pw()).transaction(ol,"readwrite");await n.objectStore(ol).put(e,Fw(t)),await n.done}catch(r){if(r instanceof bn)ki.warn(r.message);else{const n=cs.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ki.warn(n.message)}}}function Fw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=1024,Y4=30*24*60*60*1e3;class Q4{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Z4(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Uv();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Y4}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ki.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Uv(),{heartbeatsToSend:n,unsentEntries:i}=J4(this._heartbeatsCache.heartbeats),s=Df(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return ki.warn(r),""}}}function Uv(){return new Date().toISOString().substring(0,10)}function J4(t,e=X4){const r=[];let n=t.slice();for(const i of t){const s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),zv(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),zv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Z4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Aw()?Sw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await q4(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bv(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Bv(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function zv(t){return Df(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t){Zn(new On("platform-logger",e=>new h4(e),"PRIVATE")),Zn(new On("heartbeat",e=>new Q4(e),"PRIVATE")),mn(Yd,bv,t),mn(Yd,bv,"esm2017"),mn("fire-js","")}eR("");var tR="firebase",rR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn(tR,rR,"app");function Sm(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Dw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nR=Dw,Nw=new fa("auth","Firebase",Dw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Of=new T0("@firebase/auth");function iR(t,...e){Of.logLevel<=Ue.WARN&&Of.warn(`Auth (${Po}): ${t}`,...e)}function Ju(t,...e){Of.logLevel<=Ue.ERROR&&Of.error(`Auth (${Po}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(t,...e){throw Im(t,...e)}function qn(t,...e){return Im(t,...e)}function Ow(t,e,r){const n=Object.assign(Object.assign({},nR()),{[e]:r});return new fa("auth","Firebase",n).create(e,{appName:t.name})}function ls(t){return Ow(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Im(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Nw.create(t,...e)}function Ce(t,e,...r){if(!t)throw Im(e,...r)}function di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ju(e),new Error(e)}function Ai(t,e){t||di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zd(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function sR(){return Hv()==="http:"||Hv()==="https:"}function Hv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sR()||kw()||"connection"in navigator)?navigator.onLine:!0}function oR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ai(r>e,"Short delay should be less than long delay!"),this.isMobile=PC()||NC()}get(){return aR()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cm(t,e){Ai(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=new Pl(3e4,6e4);function da(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ts(t,e,r,n,i={}){return Mw(t,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=Rl(Object.assign({key:t.config.apiKey},a)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l=Object.assign({method:e,headers:c},s);return DC()||(l.referrerPolicy="no-referrer"),Lw.fetch()(bw(t,t.config.apiHost,r,o),l)})}async function Mw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},cR),e);try{const i=new fR(t),s=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw Su(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Su(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Su(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Su(t,"user-disabled",a);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Ow(t,f,l);Ln(t,f)}}catch(i){if(i instanceof bn)throw i;Ln(t,"network-request-failed",{message:String(i)})}}async function k0(t,e,r,n,i={}){const s=await Ts(t,e,r,n,i);return"mfaPendingCredential"in s&&Ln(t,"multi-factor-auth-required",{_serverResponse:s}),s}function bw(t,e,r,n){const i=`${e}${r}?${n}`;return t.config.emulator?Cm(t.config,i):`${t.config.apiScheme}://${i}`}function uR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class fR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(qn(this.auth,"network-request-failed")),lR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Su(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=qn(t,e,n);return i.customData._tokenResponse=r,i}function Wv(t){return t!==void 0&&t.enterprise!==void 0}class hR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return uR(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function dR(t,e){return Ts(t,"GET","/v2/recaptchaConfig",da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pR(t,e){return Ts(t,"POST","/v1/accounts:delete",e)}async function Vw(t,e){return Ts(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mR(t,e=!1){const r=Tt(t),n=await r.getIdToken(e),i=Rm(n);Ce(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:Cc(Mh(i.auth_time)),issuedAtTime:Cc(Mh(i.iat)),expirationTime:Cc(Mh(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Mh(t){return Number(t)*1e3}function Rm(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Ju("JWT malformed, contained fewer than 3 sections"),null;try{const i=yw(r);return i?JSON.parse(i):(Ju("Failed to decode base64 JWT payload"),null)}catch(i){return Ju("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function $v(t){const e=Rm(t);return Ce(e,"internal-error"),Ce(typeof e.exp<"u","internal-error"),Ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cl(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof bn&&gR(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function gR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cc(this.lastLoginAt),this.creationTime=Cc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lf(t){var e;const r=t.auth,n=await t.getIdToken(),i=await cl(t,Vw(r,{idToken:n}));Ce(i==null?void 0:i.users.length,r,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Bw(s.providerUserInfo):[],o=xR(t.providerData,a),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),f=c?l:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ep(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(t,h)}async function _R(t){const e=Tt(t);await Lf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xR(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Bw(t){return t.map(e=>{var{providerId:r}=e,n=Sm(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yR(t,e){const r=await Mw(t,{},async()=>{const n=Rl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=bw(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Lw.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function ER(t,e){return Ts(t,"POST","/v2/accounts:revokeToken",da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ce(e.idToken,"internal-error"),Ce(typeof e.idToken<"u","internal-error"),Ce(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$v(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Ce(e.length!==0,"internal-error");const r=$v(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:s}=await yR(e,r);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new ro;return n&&(Ce(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(Ce(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(Ce(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ro,this.toJSON())}_performRefresh(){return di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t,e){Ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pi{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=Sm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ep(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const r=await cl(this,this.stsTokenManager.getToken(this.auth,e));return Ce(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return mR(this,e)}reload(){return _R(this)}_assign(e){this!==e&&(Ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new pi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Lf(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(hi(this.auth.app))return Promise.reject(ls(this.auth));const e=await this.getIdToken();return await cl(this,pR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,c,l,f;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,w=(l=r.createdAt)!==null&&l!==void 0?l:void 0,T=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:_,emailVerified:N,isAnonymous:z,providerData:B,stsTokenManager:y}=r;Ce(_&&y,e,"internal-error");const k=ro.fromJSON(this.name,y);Ce(typeof _=="string",e,"internal-error"),Mi(h,e.name),Mi(d,e.name),Ce(typeof N=="boolean",e,"internal-error"),Ce(typeof z=="boolean",e,"internal-error"),Mi(m,e.name),Mi(v,e.name),Mi(g,e.name),Mi(E,e.name),Mi(w,e.name),Mi(T,e.name);const A=new pi({uid:_,auth:e,email:d,emailVerified:N,displayName:h,isAnonymous:z,photoURL:v,phoneNumber:m,tenantId:g,stsTokenManager:k,createdAt:w,lastLoginAt:T});return B&&Array.isArray(B)&&(A.providerData=B.map(I=>Object.assign({},I))),E&&(A._redirectEventId=E),A}static async _fromIdTokenResponse(e,r,n=!1){const i=new ro;i.updateFromServerResponse(r);const s=new pi({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Lf(s),s}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];Ce(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Bw(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new ro;o.updateFromIdToken(n);const c=new pi({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ep(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jv=new Map;function mi(t){Ai(t instanceof Function,"Expected a class definition");let e=jv.get(t);return e?(Ai(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,jv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Uw.type="NONE";const Gv=Uw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(t,e,r){return`firebase:${t}:${e}:${r}`}class no{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Zu(this.userKey,i.apiKey,s),this.fullPersistenceKey=Zu("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new no(mi(Gv),e,n);const i=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let s=i[0]||mi(Gv);const a=Zu(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const f=await l._get(a);if(f){const h=pi._fromJSON(e,f);l!==s&&(o=h),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new no(s,e,n):(s=c[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==s)try{await l._remove(a)}catch{}})),new no(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($w(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Gw(e))return"Blackberry";if(Kw(e))return"Webos";if(Hw(e))return"Safari";if((e.includes("chrome/")||Ww(e))&&!e.includes("edge/"))return"Chrome";if(jw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function zw(t=_r()){return/firefox\//i.test(t)}function Hw(t=_r()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ww(t=_r()){return/crios\//i.test(t)}function $w(t=_r()){return/iemobile/i.test(t)}function jw(t=_r()){return/android/i.test(t)}function Gw(t=_r()){return/blackberry/i.test(t)}function Kw(t=_r()){return/webos/i.test(t)}function Pm(t=_r()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wR(t=_r()){var e;return Pm(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function TR(){return OC()&&document.documentMode===10}function qw(t=_r()){return Pm(t)||jw(t)||Kw(t)||Gw(t)||/windows phone/i.test(t)||$w(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(t,e=[]){let r;switch(t){case"Browser":r=Kv(_r());break;case"Worker":r=`${Kv(_r())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Po}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=s=>new Promise((a,o)=>{try{const c=e(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AR(t,e={}){return Ts(t,"GET","/v2/passwordPolicy",da(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SR=6;class IR{constructor(e){var r,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:SR,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qv(this),this.idTokenSubscription=new qv(this),this.beforeStateQueue=new kR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Nw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=mi(r)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await no.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Vw(this,{idToken:e}),n=await pi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(hi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Lf(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(hi(this.app))return Promise.reject(ls(this));const r=e?Tt(e):null;return r&&Ce(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return hi(this.app)?Promise.reject(ls(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return hi(this.app)?Promise.reject(ls(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AR(this),r=new IR(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new fa("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await ER(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&mi(e)||this._popupRedirectResolver;Ce(r,this,"argument-error"),this.redirectPersistenceManager=await no.create(this,[mi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ce(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{a=!0,c()}}else{const c=e.addObserver(r);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Xw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&iR(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Fo(t){return Tt(t)}class qv{constructor(e){this.auth=e,this.observer=null,this.addObserver=zC(r=>this.observer=r)}get next(){return Ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RR(t){A0=t}function Yw(t){return A0.loadJS(t)}function PR(){return A0.recaptchaEnterpriseScript}function FR(){return A0.gapiScript}function DR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const NR="recaptcha-enterprise",OR="NO_RECAPTCHA";class LR{constructor(e){this.type=NR,this.auth=Fo(e)}async verify(e="verify",r=!1){async function n(s){if(!r){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{dR(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new hR(c);return s.tenantId==null?s._agentRecaptchaConfig=l:s._tenantRecaptchaConfigs[s.tenantId]=l,a(l.siteKey)}}).catch(c=>{o(c)})})}function i(s,a,o){const c=window.grecaptcha;Wv(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(l=>{a(l)}).catch(()=>{a(OR)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,a)=>{n(this.auth).then(o=>{if(!r&&Wv(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=PR();c.length!==0&&(c+=o),Yw(c).then(()=>{i(o,s,a)}).catch(l=>{a(l)})}}).catch(o=>{a(o)})})}}async function Xv(t,e,r,n=!1){const i=new LR(t);let s;try{s=await i.verify(r)}catch{s=await i.verify(r,!0)}const a=Object.assign({},e);return n?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Yv(t,e,r,n){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Xv(t,e,r,r==="getOobCode");return n(t,s)}else return n(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Xv(t,e,r,r==="getOobCode");return n(t,a)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MR(t,e){const r=ha(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),s=r.getOptions();if(al(s,e??{}))return i;Ln(i,"already-initialized")}return r.initialize({options:e})}function bR(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(mi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function VR(t,e,r){const n=Fo(t);Ce(n._canInitEmulator,n,"emulator-config-failed"),Ce(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!(r!=null&&r.disableWarnings),s=Qw(e),{host:a,port:o}=BR(e),c=o===null?"":`:${o}`;n.config.emulator={url:`${s}//${a}${c}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||UR()}function Qw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function BR(t){const e=Qw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:Qv(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:Qv(a)}}}function Qv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function UR(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fm{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return di("not implemented")}_getIdTokenResponse(e){return di("not implemented")}_linkToIdToken(e,r){return di("not implemented")}_getReauthenticationResolver(e){return di("not implemented")}}async function zR(t,e){return Ts(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(t,e){return k0(t,"POST","/v1/accounts:signInWithPassword",da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WR(t,e){return k0(t,"POST","/v1/accounts:signInWithEmailLink",da(t,e))}async function $R(t,e){return k0(t,"POST","/v1/accounts:signInWithEmailLink",da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll extends Fm{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new ll(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new ll(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yv(e,r,"signInWithPassword",HR);case"emailLink":return WR(e,{email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yv(e,n,"signUpPassword",zR);case"emailLink":return $R(e,{idToken:r,email:this._email,oobCode:this._password});default:Ln(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function io(t,e){return k0(t,"POST","/v1/accounts:signInWithIdp",da(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR="http://localhost";class Zs extends Fm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ln("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,s=Sm(r,["providerId","signInMethod"]);if(!n||!i)return null;const a=new Zs(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return io(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,io(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,io(e,r)}buildRequest(){const e={requestUri:jR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Rl(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function KR(t){const e=lc(uc(t)).link,r=e?lc(uc(e)).deep_link_id:null,n=lc(uc(t)).deep_link_id;return(n?lc(uc(n)).link:null)||n||r||e||t}class Dm{constructor(e){var r,n,i,s,a,o;const c=lc(uc(e)),l=(r=c.apiKey)!==null&&r!==void 0?r:null,f=(n=c.oobCode)!==null&&n!==void 0?n:null,h=GR((i=c.mode)!==null&&i!==void 0?i:null);Ce(l&&f&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=c.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=c.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const r=KR(e);try{return new Dm(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.providerId=Do.PROVIDER_ID}static credential(e,r){return ll._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Dm.parseLink(r);return Ce(n,"argument-error"),ll._fromEmailAndCode(e,n.code,n.tenantId)}}Do.PROVIDER_ID="password";Do.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Do.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl extends Jw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Fl{constructor(){super("facebook.com")}static credential(e){return Zs._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Fl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Zs._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Wi.credential(r,n)}catch{return null}}}Wi.GOOGLE_SIGN_IN_METHOD="google.com";Wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Fl{constructor(){super("github.com")}static credential(e){return Zs._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.GITHUB_SIGN_IN_METHOD="github.com";$i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Fl{constructor(){super("twitter.com")}static credential(e,r){return Zs._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ji.credential(r,n)}catch{return null}}}ji.TWITTER_SIGN_IN_METHOD="twitter.com";ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const s=await pi._fromIdTokenResponse(e,n,i),a=Jv(n);return new vo({user:s,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=Jv(n);return new vo({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function Jv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf extends bn{constructor(e,r,n,i){var s;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Mf.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new Mf(e,r,n,i)}}function Zw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Mf._fromErrorAndOperation(t,s,e,n):s})}async function qR(t,e,r=!1){const n=await cl(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return vo._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR(t,e,r=!1){const{auth:n}=t;if(hi(n.app))return Promise.reject(ls(n));const i="reauthenticate";try{const s=await cl(t,Zw(n,i,e,t),r);Ce(s.idToken,n,"internal-error");const a=Rm(s.idToken);Ce(a,n,"internal-error");const{sub:o}=a;return Ce(t.uid===o,n,"user-mismatch"),vo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Ln(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eT(t,e,r=!1){if(hi(t.app))return Promise.reject(ls(t));const n="signIn",i=await Zw(t,n,e),s=await vo._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(s.user),s}async function YR(t,e){return eT(Fo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QR(t){const e=Fo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function RB(t,e,r){return hi(t.app)?Promise.reject(ls(t)):YR(Tt(t),Do.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&QR(t),n})}function JR(t,e,r,n){return Tt(t).onIdTokenChanged(e,r,n)}function ZR(t,e,r){return Tt(t).beforeAuthStateChanged(e,r)}function PB(t,e,r,n){return Tt(t).onAuthStateChanged(e,r,n)}function FB(t){return Tt(t).signOut()}const bf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(bf,"1"),this.storage.removeItem(bf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eP=1e3,tP=10;class rT extends tT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=qw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);TR()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,tP):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},eP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}rT.type="LOCAL";const rP=rT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT extends tT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}nT.type="SESSION";const iT=nT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new S0(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:s}=r.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async l=>l(r.origin,s)),c=await nP(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}S0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nm(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,c)=>{const l=Nm("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(d.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(){return window}function sP(t){Xn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sT(){return typeof Xn().WorkerGlobalScope<"u"&&typeof Xn().importScripts=="function"}async function aP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function oP(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function cP(){return sT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="firebaseLocalStorageDb",lP=1,Vf="firebaseLocalStorage",oT="fbase_key";class Dl{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function I0(t,e){return t.transaction([Vf],e?"readwrite":"readonly").objectStore(Vf)}function uP(){const t=indexedDB.deleteDatabase(aT);return new Dl(t).toPromise()}function tp(){const t=indexedDB.open(aT,lP);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Vf,{keyPath:oT})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Vf)?e(n):(n.close(),await uP(),e(await tp()))})})}async function Zv(t,e,r){const n=I0(t,!0).put({[oT]:e,value:r});return new Dl(n).toPromise()}async function fP(t,e){const r=I0(t,!1).get(e),n=await new Dl(r).toPromise();return n===void 0?null:n.value}function e_(t,e){const r=I0(t,!0).delete(e);return new Dl(r).toPromise()}const hP=800,dP=3;class cT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tp(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>dP)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return sT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=S0._getInstance(cP()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await aP(),!this.activeServiceWorker)return;this.sender=new iP(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||oP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tp();return await Zv(e,bf,"1"),await e_(e,bf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Zv(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>fP(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>e_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=I0(i,!1).getAll();return new Dl(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),hP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}cT.type="LOCAL";const pP=cT;new Pl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mP(t,e){return e?mi(e):(Ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om extends Fm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return io(e,this._buildIdpRequest())}_linkToIdToken(e,r){return io(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return io(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function gP(t){return eT(t.auth,new Om(t),t.bypassAuthState)}function vP(t){const{auth:e,user:r}=t;return Ce(r,e,"internal-error"),XR(r,new Om(t),t.bypassAuthState)}async function _P(t){const{auth:e,user:r}=t;return Ce(r,e,"internal-error"),qR(r,new Om(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e,r,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return gP;case"linkViaPopup":case"linkViaRedirect":return _P;case"reauthViaPopup":case"reauthViaRedirect":return vP;default:Ln(this.auth,"internal-error")}}resolve(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=new Pl(2e3,1e4);class qa extends lT{constructor(e,r,n,i,s){super(e,r,i,s),this.provider=n,this.authWindow=null,this.pollId=null,qa.currentPopupAction&&qa.currentPopupAction.cancel(),qa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ce(e,this.auth,"internal-error"),e}async onExecution(){Ai(this.filter.length===1,"Popup operations only handle one event");const e=Nm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(qn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(qn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,xP.get())};e()}}qa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="pendingRedirect",ef=new Map;class EP extends lT{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=ef.get(this.auth._key());if(!e){try{const n=await wP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}ef.set(this.auth._key(),e)}return this.bypassAuthState||ef.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function wP(t,e){const r=AP(e),n=kP(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function TP(t,e){ef.set(t._key(),e)}function kP(t){return mi(t._redirectPersistence)}function AP(t){return Zu(yP,t.config.apiKey,t.name)}async function SP(t,e,r=!1){if(hi(t.app))return Promise.reject(ls(t));const n=Fo(t),i=mP(n,e),a=await new EP(n,i,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP=10*60*1e3;class CP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!RP(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!uT(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(qn(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=IP&&this.cachedEventUids.clear(),this.cachedEventUids.has(t_(e))}saveEventToCache(e){this.cachedEventUids.add(t_(e)),this.lastProcessedEventTime=Date.now()}}function t_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function uT({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function RP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uT(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PP(t,e={}){return Ts(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DP=/^https?/;async function NP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await PP(t);for(const r of e)try{if(OP(r))return}catch{}Ln(t,"unauthorized-domain")}function OP(t){const e=Zd(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!DP.test(r))return!1;if(FP.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP=new Pl(3e4,6e4);function r_(){const t=Xn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function MP(t){return new Promise((e,r)=>{var n,i,s;function a(){r_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{r_(),r(qn(t,"network-request-failed"))},timeout:LP.get()})}if(!((i=(n=Xn().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Xn().gapi)===null||s===void 0)&&s.load)a();else{const o=DR("iframefcb");return Xn()[o]=()=>{gapi.load?a():r(qn(t,"network-request-failed"))},Yw(`${FR()}?onload=${o}`).catch(c=>r(c))}}).catch(e=>{throw tf=null,e})}let tf=null;function bP(t){return tf=tf||MP(t),tf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=new Pl(5e3,15e3),BP="__/auth/iframe",UP="emulator/auth/iframe",zP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},HP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WP(t){const e=t.config;Ce(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Cm(e,UP):`https://${t.config.authDomain}/${BP}`,n={apiKey:e.apiKey,appName:t.name,v:Po},i=HP.get(t.config.apiHost);i&&(n.eid=i);const s=t._getFrameworks();return s.length&&(n.fw=s.join(",")),`${r}?${Rl(n).slice(1)}`}async function $P(t){const e=await bP(t),r=Xn().gapi;return Ce(r,t,"internal-error"),e.open({where:document.body,url:WP(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zP,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=qn(t,"network-request-failed"),o=Xn().setTimeout(()=>{s(a)},VP.get());function c(){Xn().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},GP=500,KP=600,qP="_blank",XP="http://localhost";class n_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YP(t,e,r,n=GP,i=KP){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c=Object.assign(Object.assign({},jP),{width:n.toString(),height:i.toString(),top:s,left:a}),l=_r().toLowerCase();r&&(o=Ww(l)?qP:r),zw(l)&&(e=e||XP,c.scrollbars="yes");const f=Object.entries(c).reduce((d,[m,v])=>`${d}${m}=${v},`,"");if(wR(l)&&o!=="_self")return QP(e||"",o),new n_(null);const h=window.open(e||"",o,f);Ce(h,t,"popup-blocked");try{h.focus()}catch{}return new n_(h)}function QP(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP="__/auth/handler",ZP="emulator/auth/handler",eF=encodeURIComponent("fac");async function i_(t,e,r,n,i,s){Ce(t.config.authDomain,t,"auth-domain-config-required"),Ce(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Po,eventId:i};if(e instanceof Jw){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",UC(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,h]of Object.entries(s||{}))a[f]=h}if(e instanceof Fl){const f=e.getScopes().filter(h=>h!=="");f.length>0&&(a.scopes=f.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const c=await t._getAppCheckToken(),l=c?`#${eF}=${encodeURIComponent(c)}`:"";return`${tF(t)}?${Rl(o).slice(1)}${l}`}function tF({config:t}){return t.emulator?Cm(t,ZP):`https://${t.authDomain}/${JP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="webStorageSupport";class rF{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=iT,this._completeRedirectFn=SP,this._overrideRedirectResult=TP}async _openPopup(e,r,n,i){var s;Ai((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await i_(e,r,n,Zd(),i);return YP(e,a,Nm())}async _openRedirect(e,r,n,i){await this._originValidation(e);const s=await i_(e,r,n,Zd(),i);return sP(s),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:s}=this.eventManagers[r];return i?Promise.resolve(i):(Ai(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await $P(e),n=new CP(e);return r.register("authEvent",i=>(Ce(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(bh,{type:bh},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[bh];a!==void 0&&r(!!a),Ln(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=NP(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return qw()||Hw()||Pm()}}const nF=rF;var s_="@firebase/auth",a_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aF(t){Zn(new On("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Ce(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Xw(t)},l=new CR(n,i,s,c);return bR(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Zn(new On("auth-internal",e=>{const r=Fo(e.getProvider("auth").getImmediate());return(n=>new iF(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),mn(s_,a_,sF(t)),mn(s_,a_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oF=5*60,cF=Tw("authIdTokenMaxAge")||oF;let o_=null;const lF=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>cF)return;const i=r==null?void 0:r.token;o_!==i&&(o_=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function DB(t=Am()){const e=ha(t,"auth");if(e.isInitialized())return e.getImmediate();const r=MR(t,{popupRedirectResolver:nF,persistence:[pP,rP,iT]}),n=Tw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=lF(s.toString());ZR(r,a,()=>a(r.currentUser)),JR(r,o=>a(o))}}const i=Ew("auth");return i&&VR(r,`http://${i}`),r}function uF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}RR({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const s=qn("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",uF().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aF("Browser");var c_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var js,fT;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(y,k){function A(){}A.prototype=k.prototype,y.D=k.prototype,y.prototype=new A,y.prototype.constructor=y,y.C=function(I,R,C){for(var F=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)F[ve-2]=arguments[ve];return k.prototype[R].apply(I,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(y,k,A){A||(A=0);var I=Array(16);if(typeof k=="string")for(var R=0;16>R;++R)I[R]=k.charCodeAt(A++)|k.charCodeAt(A++)<<8|k.charCodeAt(A++)<<16|k.charCodeAt(A++)<<24;else for(R=0;16>R;++R)I[R]=k[A++]|k[A++]<<8|k[A++]<<16|k[A++]<<24;k=y.g[0],A=y.g[1],R=y.g[2];var C=y.g[3],F=k+(C^A&(R^C))+I[0]+3614090360&4294967295;k=A+(F<<7&4294967295|F>>>25),F=C+(R^k&(A^R))+I[1]+3905402710&4294967295,C=k+(F<<12&4294967295|F>>>20),F=R+(A^C&(k^A))+I[2]+606105819&4294967295,R=C+(F<<17&4294967295|F>>>15),F=A+(k^R&(C^k))+I[3]+3250441966&4294967295,A=R+(F<<22&4294967295|F>>>10),F=k+(C^A&(R^C))+I[4]+4118548399&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(R^k&(A^R))+I[5]+1200080426&4294967295,C=k+(F<<12&4294967295|F>>>20),F=R+(A^C&(k^A))+I[6]+2821735955&4294967295,R=C+(F<<17&4294967295|F>>>15),F=A+(k^R&(C^k))+I[7]+4249261313&4294967295,A=R+(F<<22&4294967295|F>>>10),F=k+(C^A&(R^C))+I[8]+1770035416&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(R^k&(A^R))+I[9]+2336552879&4294967295,C=k+(F<<12&4294967295|F>>>20),F=R+(A^C&(k^A))+I[10]+4294925233&4294967295,R=C+(F<<17&4294967295|F>>>15),F=A+(k^R&(C^k))+I[11]+2304563134&4294967295,A=R+(F<<22&4294967295|F>>>10),F=k+(C^A&(R^C))+I[12]+1804603682&4294967295,k=A+(F<<7&4294967295|F>>>25),F=C+(R^k&(A^R))+I[13]+4254626195&4294967295,C=k+(F<<12&4294967295|F>>>20),F=R+(A^C&(k^A))+I[14]+2792965006&4294967295,R=C+(F<<17&4294967295|F>>>15),F=A+(k^R&(C^k))+I[15]+1236535329&4294967295,A=R+(F<<22&4294967295|F>>>10),F=k+(R^C&(A^R))+I[1]+4129170786&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^R&(k^A))+I[6]+3225465664&4294967295,C=k+(F<<9&4294967295|F>>>23),F=R+(k^A&(C^k))+I[11]+643717713&4294967295,R=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(R^C))+I[0]+3921069994&4294967295,A=R+(F<<20&4294967295|F>>>12),F=k+(R^C&(A^R))+I[5]+3593408605&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^R&(k^A))+I[10]+38016083&4294967295,C=k+(F<<9&4294967295|F>>>23),F=R+(k^A&(C^k))+I[15]+3634488961&4294967295,R=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(R^C))+I[4]+3889429448&4294967295,A=R+(F<<20&4294967295|F>>>12),F=k+(R^C&(A^R))+I[9]+568446438&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^R&(k^A))+I[14]+3275163606&4294967295,C=k+(F<<9&4294967295|F>>>23),F=R+(k^A&(C^k))+I[3]+4107603335&4294967295,R=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(R^C))+I[8]+1163531501&4294967295,A=R+(F<<20&4294967295|F>>>12),F=k+(R^C&(A^R))+I[13]+2850285829&4294967295,k=A+(F<<5&4294967295|F>>>27),F=C+(A^R&(k^A))+I[2]+4243563512&4294967295,C=k+(F<<9&4294967295|F>>>23),F=R+(k^A&(C^k))+I[7]+1735328473&4294967295,R=C+(F<<14&4294967295|F>>>18),F=A+(C^k&(R^C))+I[12]+2368359562&4294967295,A=R+(F<<20&4294967295|F>>>12),F=k+(A^R^C)+I[5]+4294588738&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^R)+I[8]+2272392833&4294967295,C=k+(F<<11&4294967295|F>>>21),F=R+(C^k^A)+I[11]+1839030562&4294967295,R=C+(F<<16&4294967295|F>>>16),F=A+(R^C^k)+I[14]+4259657740&4294967295,A=R+(F<<23&4294967295|F>>>9),F=k+(A^R^C)+I[1]+2763975236&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^R)+I[4]+1272893353&4294967295,C=k+(F<<11&4294967295|F>>>21),F=R+(C^k^A)+I[7]+4139469664&4294967295,R=C+(F<<16&4294967295|F>>>16),F=A+(R^C^k)+I[10]+3200236656&4294967295,A=R+(F<<23&4294967295|F>>>9),F=k+(A^R^C)+I[13]+681279174&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^R)+I[0]+3936430074&4294967295,C=k+(F<<11&4294967295|F>>>21),F=R+(C^k^A)+I[3]+3572445317&4294967295,R=C+(F<<16&4294967295|F>>>16),F=A+(R^C^k)+I[6]+76029189&4294967295,A=R+(F<<23&4294967295|F>>>9),F=k+(A^R^C)+I[9]+3654602809&4294967295,k=A+(F<<4&4294967295|F>>>28),F=C+(k^A^R)+I[12]+3873151461&4294967295,C=k+(F<<11&4294967295|F>>>21),F=R+(C^k^A)+I[15]+530742520&4294967295,R=C+(F<<16&4294967295|F>>>16),F=A+(R^C^k)+I[2]+3299628645&4294967295,A=R+(F<<23&4294967295|F>>>9),F=k+(R^(A|~C))+I[0]+4096336452&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~R))+I[7]+1126891415&4294967295,C=k+(F<<10&4294967295|F>>>22),F=R+(k^(C|~A))+I[14]+2878612391&4294967295,R=C+(F<<15&4294967295|F>>>17),F=A+(C^(R|~k))+I[5]+4237533241&4294967295,A=R+(F<<21&4294967295|F>>>11),F=k+(R^(A|~C))+I[12]+1700485571&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~R))+I[3]+2399980690&4294967295,C=k+(F<<10&4294967295|F>>>22),F=R+(k^(C|~A))+I[10]+4293915773&4294967295,R=C+(F<<15&4294967295|F>>>17),F=A+(C^(R|~k))+I[1]+2240044497&4294967295,A=R+(F<<21&4294967295|F>>>11),F=k+(R^(A|~C))+I[8]+1873313359&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~R))+I[15]+4264355552&4294967295,C=k+(F<<10&4294967295|F>>>22),F=R+(k^(C|~A))+I[6]+2734768916&4294967295,R=C+(F<<15&4294967295|F>>>17),F=A+(C^(R|~k))+I[13]+1309151649&4294967295,A=R+(F<<21&4294967295|F>>>11),F=k+(R^(A|~C))+I[4]+4149444226&4294967295,k=A+(F<<6&4294967295|F>>>26),F=C+(A^(k|~R))+I[11]+3174756917&4294967295,C=k+(F<<10&4294967295|F>>>22),F=R+(k^(C|~A))+I[2]+718787259&4294967295,R=C+(F<<15&4294967295|F>>>17),F=A+(C^(R|~k))+I[9]+3951481745&4294967295,y.g[0]=y.g[0]+k&4294967295,y.g[1]=y.g[1]+(R+(F<<21&4294967295|F>>>11))&4294967295,y.g[2]=y.g[2]+R&4294967295,y.g[3]=y.g[3]+C&4294967295}n.prototype.u=function(y,k){k===void 0&&(k=y.length);for(var A=k-this.blockSize,I=this.B,R=this.h,C=0;C<k;){if(R==0)for(;C<=A;)i(this,y,C),C+=this.blockSize;if(typeof y=="string"){for(;C<k;)if(I[R++]=y.charCodeAt(C++),R==this.blockSize){i(this,I),R=0;break}}else for(;C<k;)if(I[R++]=y[C++],R==this.blockSize){i(this,I),R=0;break}}this.h=R,this.o+=k},n.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var k=1;k<y.length-8;++k)y[k]=0;var A=8*this.o;for(k=y.length-8;k<y.length;++k)y[k]=A&255,A/=256;for(this.u(y),y=Array(16),k=A=0;4>k;++k)for(var I=0;32>I;I+=8)y[A++]=this.g[k]>>>I&255;return y};function s(y,k){var A=o;return Object.prototype.hasOwnProperty.call(A,y)?A[y]:A[y]=k(y)}function a(y,k){this.h=k;for(var A=[],I=!0,R=y.length-1;0<=R;R--){var C=y[R]|0;I&&C==k||(A[R]=C,I=!1)}this.g=A}var o={};function c(y){return-128<=y&&128>y?s(y,function(k){return new a([k|0],0>k?-1:0)}):new a([y|0],0>y?-1:0)}function l(y){if(isNaN(y)||!isFinite(y))return h;if(0>y)return E(l(-y));for(var k=[],A=1,I=0;y>=A;I++)k[I]=y/A|0,A*=4294967296;return new a(k,0)}function f(y,k){if(y.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(y.charAt(0)=="-")return E(f(y.substring(1),k));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=l(Math.pow(k,8)),I=h,R=0;R<y.length;R+=8){var C=Math.min(8,y.length-R),F=parseInt(y.substring(R,R+C),k);8>C?(C=l(Math.pow(k,C)),I=I.j(C).add(l(F))):(I=I.j(A),I=I.add(l(F)))}return I}var h=c(0),d=c(1),m=c(16777216);t=a.prototype,t.m=function(){if(g(this))return-E(this).m();for(var y=0,k=1,A=0;A<this.g.length;A++){var I=this.i(A);y+=(0<=I?I:4294967296+I)*k,k*=4294967296}return y},t.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(v(this))return"0";if(g(this))return"-"+E(this).toString(y);for(var k=l(Math.pow(y,6)),A=this,I="";;){var R=N(A,k).g;A=w(A,R.j(k));var C=((0<A.g.length?A.g[0]:A.h)>>>0).toString(y);if(A=R,v(A))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},t.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function v(y){if(y.h!=0)return!1;for(var k=0;k<y.g.length;k++)if(y.g[k]!=0)return!1;return!0}function g(y){return y.h==-1}t.l=function(y){return y=w(this,y),g(y)?-1:v(y)?0:1};function E(y){for(var k=y.g.length,A=[],I=0;I<k;I++)A[I]=~y.g[I];return new a(A,~y.h).add(d)}t.abs=function(){return g(this)?E(this):this},t.add=function(y){for(var k=Math.max(this.g.length,y.g.length),A=[],I=0,R=0;R<=k;R++){var C=I+(this.i(R)&65535)+(y.i(R)&65535),F=(C>>>16)+(this.i(R)>>>16)+(y.i(R)>>>16);I=F>>>16,C&=65535,F&=65535,A[R]=F<<16|C}return new a(A,A[A.length-1]&-2147483648?-1:0)};function w(y,k){return y.add(E(k))}t.j=function(y){if(v(this)||v(y))return h;if(g(this))return g(y)?E(this).j(E(y)):E(E(this).j(y));if(g(y))return E(this.j(E(y)));if(0>this.l(m)&&0>y.l(m))return l(this.m()*y.m());for(var k=this.g.length+y.g.length,A=[],I=0;I<2*k;I++)A[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<y.g.length;R++){var C=this.i(I)>>>16,F=this.i(I)&65535,ve=y.i(R)>>>16,ue=y.i(R)&65535;A[2*I+2*R]+=F*ue,T(A,2*I+2*R),A[2*I+2*R+1]+=C*ue,T(A,2*I+2*R+1),A[2*I+2*R+1]+=F*ve,T(A,2*I+2*R+1),A[2*I+2*R+2]+=C*ve,T(A,2*I+2*R+2)}for(I=0;I<k;I++)A[I]=A[2*I+1]<<16|A[2*I];for(I=k;I<2*k;I++)A[I]=0;return new a(A,0)};function T(y,k){for(;(y[k]&65535)!=y[k];)y[k+1]+=y[k]>>>16,y[k]&=65535,k++}function _(y,k){this.g=y,this.h=k}function N(y,k){if(v(k))throw Error("division by zero");if(v(y))return new _(h,h);if(g(y))return k=N(E(y),k),new _(E(k.g),E(k.h));if(g(k))return k=N(y,E(k)),new _(E(k.g),k.h);if(30<y.g.length){if(g(y)||g(k))throw Error("slowDivide_ only works with positive integers.");for(var A=d,I=k;0>=I.l(y);)A=z(A),I=z(I);var R=B(A,1),C=B(I,1);for(I=B(I,2),A=B(A,2);!v(I);){var F=C.add(I);0>=F.l(y)&&(R=R.add(A),C=F),I=B(I,1),A=B(A,1)}return k=w(y,R.j(k)),new _(R,k)}for(R=h;0<=y.l(k);){for(A=Math.max(1,Math.floor(y.m()/k.m())),I=Math.ceil(Math.log(A)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=l(A),F=C.j(k);g(F)||0<F.l(y);)A-=I,C=l(A),F=C.j(k);v(C)&&(C=d),R=R.add(C),y=w(y,F)}return new _(R,y)}t.A=function(y){return N(this,y).h},t.and=function(y){for(var k=Math.max(this.g.length,y.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)&y.i(I);return new a(A,this.h&y.h)},t.or=function(y){for(var k=Math.max(this.g.length,y.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)|y.i(I);return new a(A,this.h|y.h)},t.xor=function(y){for(var k=Math.max(this.g.length,y.g.length),A=[],I=0;I<k;I++)A[I]=this.i(I)^y.i(I);return new a(A,this.h^y.h)};function z(y){for(var k=y.g.length+1,A=[],I=0;I<k;I++)A[I]=y.i(I)<<1|y.i(I-1)>>>31;return new a(A,y.h)}function B(y,k){var A=k>>5;k%=32;for(var I=y.g.length-A,R=[],C=0;C<I;C++)R[C]=0<k?y.i(C+A)>>>k|y.i(C+A+1)<<32-k:y.i(C+A);return new a(R,y.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,fT=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=f,js=a}).apply(typeof c_<"u"?c_:typeof self<"u"?self:typeof window<"u"?window:{});var Iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hT,fc,dT,rf,rp,pT,mT,gT;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,x){return u==Array.prototype||u==Object.prototype||(u[p]=x.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Iu=="object"&&Iu];for(var p=0;p<u.length;++p){var x=u[p];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(u,p){if(p)e:{var x=n;u=u.split(".");for(var P=0;P<u.length-1;P++){var G=u[P];if(!(G in x))break e;x=x[G]}u=u[u.length-1],P=x[u],p=p(P),p!=P&&p!=null&&e(x,u,{configurable:!0,writable:!0,value:p})}}function s(u,p){u instanceof String&&(u+="");var x=0,P=!1,G={next:function(){if(!P&&x<u.length){var J=x++;return{value:p(J,u[J]),done:!1}}return P=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}i("Array.prototype.values",function(u){return u||function(){return s(this,function(p,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function l(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function f(u,p,x){return u.call.apply(u.bind,arguments)}function h(u,p,x){if(!u)throw Error();if(2<arguments.length){var P=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,P),u.apply(p,G)}}return function(){return u.apply(p,arguments)}}function d(u,p,x){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:h,d.apply(null,arguments)}function m(u,p){var x=Array.prototype.slice.call(arguments,1);return function(){var P=x.slice();return P.push.apply(P,arguments),u.apply(this,P)}}function v(u,p){function x(){}x.prototype=p.prototype,u.aa=p.prototype,u.prototype=new x,u.prototype.constructor=u,u.Qb=function(P,G,J){for(var he=Array(arguments.length-2),et=2;et<arguments.length;et++)he[et-2]=arguments[et];return p.prototype[G].apply(P,he)}}function g(u){const p=u.length;if(0<p){const x=Array(p);for(let P=0;P<p;P++)x[P]=u[P];return x}return[]}function E(u,p){for(let x=1;x<arguments.length;x++){const P=arguments[x];if(c(P)){const G=u.length||0,J=P.length||0;u.length=G+J;for(let he=0;he<J;he++)u[G+he]=P[he]}else u.push(P)}}class w{constructor(p,x){this.i=p,this.j=x,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function T(u){return/^[\s\xa0]*$/.test(u)}function _(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function N(u){return N[" "](u),u}N[" "]=function(){};var z=_().indexOf("Gecko")!=-1&&!(_().toLowerCase().indexOf("webkit")!=-1&&_().indexOf("Edge")==-1)&&!(_().indexOf("Trident")!=-1||_().indexOf("MSIE")!=-1)&&_().indexOf("Edge")==-1;function B(u,p,x){for(const P in u)p.call(x,u[P],P,u)}function y(u,p){for(const x in u)p.call(void 0,u[x],x,u)}function k(u){const p={};for(const x in u)p[x]=u[x];return p}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,p){let x,P;for(let G=1;G<arguments.length;G++){P=arguments[G];for(x in P)u[x]=P[x];for(let J=0;J<A.length;J++)x=A[J],Object.prototype.hasOwnProperty.call(P,x)&&(u[x]=P[x])}}function R(u){var p=1;u=u.split(":");const x=[];for(;0<p&&u.length;)x.push(u.shift()),p--;return u.length&&x.push(u.join(":")),x}function C(u){o.setTimeout(()=>{throw u},0)}function F(){var u=W;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class ve{constructor(){this.h=this.g=null}add(p,x){const P=ue.get();P.set(p,x),this.h?this.h.next=P:this.g=P,this.h=P}}var ue=new w(()=>new Ee,u=>u.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(p,x){this.h=p,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let me,ie=!1,W=new ve,ce=()=>{const u=o.Promise.resolve(void 0);me=()=>{u.then(xe)}};var xe=()=>{for(var u;u=F();){try{u.h.call(u.g)}catch(x){C(x)}var p=ue;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}ie=!1};function b(){this.s=this.s,this.C=this.C}b.prototype.s=!1,b.prototype.ma=function(){this.s||(this.s=!0,this.N())},b.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const x=()=>{};o.addEventListener("test",x,p),o.removeEventListener("test",x,p)}catch{}return u}();function H(u,p){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var x=this.type=u.type,P=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(z){e:{try{N(p.nodeName);var G=!0;break e}catch{}G=!1}G||(p=null)}}else x=="mouseover"?p=u.fromElement:x=="mouseout"&&(p=u.toElement);this.relatedTarget=p,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ee[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&H.aa.h.call(this)}}v(H,K);var ee={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),ye=0;function de(u,p,x,P,G){this.listener=u,this.proxy=null,this.src=p,this.type=x,this.capture=!!P,this.ha=G,this.key=++ye,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Me(u){this.src=u,this.g={},this.h=0}Me.prototype.add=function(u,p,x,P,G){var J=u.toString();u=this.g[J],u||(u=this.g[J]=[],this.h++);var he=it(u,p,P,G);return-1<he?(p=u[he],x||(p.fa=!1)):(p=new de(p,this.src,J,!!P,G),p.fa=x,u.push(p)),p};function U(u,p){var x=p.type;if(x in u.g){var P=u.g[x],G=Array.prototype.indexOf.call(P,p,void 0),J;(J=0<=G)&&Array.prototype.splice.call(P,G,1),J&&(se(p),u.g[x].length==0&&(delete u.g[x],u.h--))}}function it(u,p,x,P){for(var G=0;G<u.length;++G){var J=u[G];if(!J.da&&J.listener==p&&J.capture==!!x&&J.ha==P)return G}return-1}var Ve="closure_lm_"+(1e6*Math.random()|0),Xe={};function Le(u,p,x,P,G){if(P&&P.once)return Er(u,p,x,P,G);if(Array.isArray(p)){for(var J=0;J<p.length;J++)Le(u,p[J],x,P,G);return null}return x=an(x),u&&u[le]?u.K(p,x,l(P)?!!P.capture:!!P,G):pe(u,p,x,!1,P,G)}function pe(u,p,x,P,G,J){if(!p)throw Error("Invalid event type");var he=l(G)?!!G.capture:!!G,et=jt(u);if(et||(u[Ve]=et=new Me(u)),x=et.add(p,x,P,he,J),x.proxy)return x;if(P=dt(),x.proxy=P,P.src=u,P.listener=x,u.addEventListener)j||(G=he),G===void 0&&(G=!1),u.addEventListener(p.toString(),P,G);else if(u.attachEvent)u.attachEvent(Fi(p.toString()),P);else if(u.addListener&&u.removeListener)u.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return x}function dt(){function u(x){return p.call(u.src,u.listener,x)}const p=Vn;return u}function Er(u,p,x,P,G){if(Array.isArray(p)){for(var J=0;J<p.length;J++)Er(u,p[J],x,P,G);return null}return x=an(x),u&&u[le]?u.L(p,x,l(P)?!!P.capture:!!P,G):pe(u,p,x,!0,P,G)}function Hr(u,p,x,P,G){if(Array.isArray(p))for(var J=0;J<p.length;J++)Hr(u,p[J],x,P,G);else P=l(P)?!!P.capture:!!P,x=an(x),u&&u[le]?(u=u.i,p=String(p).toString(),p in u.g&&(J=u.g[p],x=it(J,x,P,G),-1<x&&(se(J[x]),Array.prototype.splice.call(J,x,1),J.length==0&&(delete u.g[p],u.h--)))):u&&(u=jt(u))&&(p=u.g[p.toString()],u=-1,p&&(u=it(p,x,P,G)),(x=-1<u?p[u]:null)&&Wr(x))}function Wr(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[le])U(p.i,u);else{var x=u.type,P=u.proxy;p.removeEventListener?p.removeEventListener(x,P,u.capture):p.detachEvent?p.detachEvent(Fi(x),P):p.addListener&&p.removeListener&&p.removeListener(P),(x=jt(p))?(U(x,u),x.h==0&&(x.src=null,p[Ve]=null)):se(u)}}}function Fi(u){return u in Xe?Xe[u]:Xe[u]="on"+u}function Vn(u,p){if(u.da)u=!0;else{p=new H(p,this);var x=u.listener,P=u.ha||u.src;u.fa&&Wr(u),u=x.call(P,p)}return u}function jt(u){return u=u[Ve],u instanceof Me?u:null}var $r="__closure_events_fn_"+(1e9*Math.random()>>>0);function an(u){return typeof u=="function"?u:(u[$r]||(u[$r]=function(p){return u.handleEvent(p)}),u[$r])}function _t(){b.call(this),this.i=new Me(this),this.M=this,this.F=null}v(_t,b),_t.prototype[le]=!0,_t.prototype.removeEventListener=function(u,p,x,P){Hr(this,u,p,x,P)};function Ye(u,p){var x,P=u.F;if(P)for(x=[];P;P=P.F)x.push(P);if(u=u.M,P=p.type||p,typeof p=="string")p=new K(p,u);else if(p instanceof K)p.target=p.target||u;else{var G=p;p=new K(P,u),I(p,G)}if(G=!0,x)for(var J=x.length-1;0<=J;J--){var he=p.g=x[J];G=wr(he,P,!0,p)&&G}if(he=p.g=u,G=wr(he,P,!0,p)&&G,G=wr(he,P,!1,p)&&G,x)for(J=0;J<x.length;J++)he=p.g=x[J],G=wr(he,P,!1,p)&&G}_t.prototype.N=function(){if(_t.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var x=u.g[p],P=0;P<x.length;P++)se(x[P]);delete u.g[p],u.h--}}this.F=null},_t.prototype.K=function(u,p,x,P){return this.i.add(String(u),p,!1,x,P)},_t.prototype.L=function(u,p,x,P){return this.i.add(String(u),p,!0,x,P)};function wr(u,p,x,P){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var G=!0,J=0;J<p.length;++J){var he=p[J];if(he&&!he.da&&he.capture==x){var et=he.listener,Kt=he.ha||he.src;he.fa&&U(u.i,he),G=et.call(Kt,P)!==!1&&G}}return G&&!P.defaultPrevented}function Oe(u,p,x){if(typeof u=="function")x&&(u=d(u,x));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:o.setTimeout(u,p||0)}function ut(u){u.g=Oe(()=>{u.g=null,u.i&&(u.i=!1,ut(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Dr extends b{constructor(p,x){super(),this.m=p,this.l=x,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:ut(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function st(u){b.call(this),this.h=u,this.g={}}v(st,b);var Bn=[];function Bo(u){B(u.g,function(p,x){this.g.hasOwnProperty(x)&&Wr(p)},u),u.g={}}st.prototype.N=function(){st.aa.N.call(this),Bo(this)},st.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Uo=o.JSON.stringify,Y0=o.JSON.parse,Kl=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Ta(){}Ta.prototype.h=null;function zo(u){return u.h||(u.h=u.i())}function ql(){}var Ss={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Di(){K.call(this,"d")}v(Di,K);function Ho(){K.call(this,"c")}v(Ho,K);var ii={},Xl=null;function ka(){return Xl=Xl||new _t}ii.La="serverreachability";function Yl(u){K.call(this,ii.La,u)}v(Yl,K);function Is(u){const p=ka();Ye(p,new Yl(p))}ii.STAT_EVENT="statevent";function Ql(u,p){K.call(this,ii.STAT_EVENT,u),this.stat=p}v(Ql,K);function Gt(u){const p=ka();Ye(p,new Ql(p,u))}ii.Ma="timingevent";function Aa(u,p){K.call(this,ii.Ma,u),this.size=p}v(Aa,K);function Cs(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},p)}function Rs(){this.g=!0}Rs.prototype.xa=function(){this.g=!1};function Q0(u,p,x,P,G,J){u.info(function(){if(u.g)if(J)for(var he="",et=J.split("&"),Kt=0;Kt<et.length;Kt++){var Ke=et[Kt].split("=");if(1<Ke.length){var ir=Ke[0];Ke=Ke[1];var sr=ir.split("_");he=2<=sr.length&&sr[1]=="type"?he+(ir+"="+Ke+"&"):he+(ir+"=redacted&")}}else he=null;else he=J;return"XMLHTTP REQ ("+P+") [attempt "+G+"]: "+p+`
`+x+`
`+he})}function S(u,p,x,P,G,J,he){u.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+G+"]: "+p+`
`+x+`
`+J+" "+he})}function L(u,p,x,P){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+O(u,x)+(P?" "+P:"")})}function D(u,p){u.info(function(){return"TIMEOUT: "+p})}Rs.prototype.info=function(){};function O(u,p){if(!u.g)return p;if(!p)return null;try{var x=JSON.parse(p);if(x){for(u=0;u<x.length;u++)if(Array.isArray(x[u])){var P=x[u];if(!(2>P.length)){var G=P[1];if(Array.isArray(G)&&!(1>G.length)){var J=G[0];if(J!="noop"&&J!="stop"&&J!="close")for(var he=1;he<G.length;he++)G[he]=""}}}}return Uo(x)}catch{return p}}var M={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function Z(){}v(Z,Ta),Z.prototype.g=function(){return new XMLHttpRequest},Z.prototype.i=function(){return{}},X=new Z;function q(u,p,x,P){this.j=u,this.i=p,this.l=x,this.R=P||1,this.U=new st(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var Q={},ne={};function fe(u,p,x){u.L=1,u.v=eu(ai(p)),u.m=x,u.P=!0,_e(u,null)}function _e(u,p){u.F=Date.now(),Se(u),u.A=ai(u.v);var x=u.A,P=u.R;Array.isArray(P)||(P=[String(P)]),r1(x.i,"t",P),u.C=0,x=u.j.J,u.h=new Y,u.g=y1(u.j,x?p:null,!u.m),0<u.O&&(u.M=new Dr(d(u.Y,u,u.g),u.O)),p=u.U,x=u.g,P=u.ca;var G="readystatechange";Array.isArray(G)||(G&&(Bn[0]=G.toString()),G=Bn);for(var J=0;J<G.length;J++){var he=Le(x,G[J],P||p.handleEvent,!1,p.h||p);if(!he)break;p.g[he.key]=he}p=u.H?k(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Is(),Q0(u.i,u.u,u.A,u.l,u.R,u.m)}q.prototype.ca=function(u){u=u.target;const p=this.M;p&&oi(u)==3?p.j():this.Y(u)},q.prototype.Y=function(u){try{if(u==this.g)e:{const sr=oi(this.g);var p=this.g.Ba();const Ra=this.g.Z();if(!(3>sr)&&(sr!=3||this.g&&(this.h.h||this.g.oa()||l1(this.g)))){this.J||sr!=4||p==7||(p==8||0>=Ra?Is(3):Is(2)),Ze(this);var x=this.g.Z();this.X=x;t:if(oe(this)){var P=l1(this.g);u="";var G=P.length,J=oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jr(this),xt(this);var he="";break t}this.h.i=new o.TextDecoder}for(p=0;p<G;p++)this.h.h=!0,u+=this.h.i.decode(P[p],{stream:!(J&&p==G-1)});P.length=0,this.h.g+=u,this.C=0,he=this.h.g}else he=this.g.oa();if(this.o=x==200,S(this.i,this.u,this.A,this.l,this.R,sr,x),this.o){if(this.T&&!this.K){t:{if(this.g){var et,Kt=this.g;if((et=Kt.g?Kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(et)){var Ke=et;break t}}Ke=null}if(x=Ke)L(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,si(this,x);else{this.o=!1,this.s=3,Gt(12),jr(this),xt(this);break e}}if(this.P){x=!0;let yn;for(;!this.J&&this.C<he.length;)if(yn=ge(this,he),yn==ne){sr==4&&(this.s=4,Gt(14),x=!1),L(this.i,this.l,null,"[Incomplete Response]");break}else if(yn==Q){this.s=4,Gt(15),L(this.i,this.l,he,"[Invalid Chunk]"),x=!1;break}else L(this.i,this.l,yn,null),si(this,yn);if(oe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sr!=4||he.length!=0||this.h.h||(this.s=1,Gt(16),x=!1),this.o=this.o&&x,!x)L(this.i,this.l,he,"[Invalid Chunked Response]"),jr(this),xt(this);else if(0<he.length&&!this.W){this.W=!0;var ir=this.j;ir.g==this&&ir.ba&&!ir.M&&(ir.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),nh(ir),ir.M=!0,Gt(11))}}else L(this.i,this.l,he,null),si(this,he);sr==4&&jr(this),this.o&&!this.J&&(sr==4?g1(this.j,this):(this.o=!1,Se(this)))}else JA(this.g),x==400&&0<he.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),jr(this),xt(this)}}}catch{}finally{}};function oe(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ge(u,p){var x=u.C,P=p.indexOf(`
`,x);return P==-1?ne:(x=Number(p.substring(x,P)),isNaN(x)?Q:(P+=1,P+x>p.length?ne:(p=p.slice(P,P+x),u.C=P+x,p)))}q.prototype.cancel=function(){this.J=!0,jr(this)};function Se(u){u.S=Date.now()+u.I,tt(u,u.I)}function tt(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Cs(d(u.ba,u),p)}function Ze(u){u.B&&(o.clearTimeout(u.B),u.B=null)}q.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(D(this.i,this.A),this.L!=2&&(Is(),Gt(17)),jr(this),this.s=2,xt(this)):tt(this,this.S-u)};function xt(u){u.j.G==0||u.J||g1(u.j,u)}function jr(u){Ze(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Bo(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function si(u,p){try{var x=u.j;if(x.G!=0&&(x.g==u||J0(x.h,u))){if(!u.K&&J0(x.h,u)&&x.G==3){try{var P=x.Da.g.parse(p)}catch{P=null}if(Array.isArray(P)&&P.length==3){var G=P;if(G[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<u.F)au(x),iu(x);else break e;rh(x),Gt(18)}}else x.za=G[1],0<x.za-x.T&&37500>G[2]&&x.F&&x.v==0&&!x.C&&(x.C=Cs(d(x.Za,x),6e3));if(1>=on(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Ds(x,11)}else if((u.K||x.g==u)&&au(x),!T(p))for(G=x.Da.g.parse(p),p=0;p<G.length;p++){let Ke=G[p];if(x.T=Ke[0],Ke=Ke[1],x.G==2)if(Ke[0]=="c"){x.K=Ke[1],x.ia=Ke[2];const ir=Ke[3];ir!=null&&(x.la=ir,x.j.info("VER="+x.la));const sr=Ke[4];sr!=null&&(x.Aa=sr,x.j.info("SVER="+x.Aa));const Ra=Ke[5];Ra!=null&&typeof Ra=="number"&&0<Ra&&(P=1.5*Ra,x.L=P,x.j.info("backChannelRequestTimeoutMs_="+P)),P=x;const yn=u.g;if(yn){const cu=yn.g?yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cu){var J=P.h;J.g||cu.indexOf("spdy")==-1&&cu.indexOf("quic")==-1&&cu.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Z0(J,J.h),J.h=null))}if(P.D){const ih=yn.g?yn.g.getResponseHeader("X-HTTP-Session-Id"):null;ih&&(P.ya=ih,at(P.I,P.D,ih))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-u.F,x.j.info("Handshake RTT: "+x.R+"ms")),P=x;var he=u;if(P.qa=x1(P,P.J?P.ia:null,P.W),he.K){qg(P.h,he);var et=he,Kt=P.L;Kt&&(et.I=Kt),et.B&&(Ze(et),Se(et)),P.g=he}else p1(P);0<x.i.length&&su(x)}else Ke[0]!="stop"&&Ke[0]!="close"||Ds(x,7);else x.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?Ds(x,7):th(x):Ke[0]!="noop"&&x.l&&x.l.ta(Ke),x.v=0)}}Is(4)}catch{}}var Ps=class{constructor(u,p){this.g=u,this.map=p}};function Un(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sa(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function on(u){return u.h?1:u.g?u.g.size:0}function J0(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function Z0(u,p){u.g?u.g.add(p):u.h=p}function qg(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Un.prototype.cancel=function(){if(this.i=Xg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Xg(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const x of u.g.values())p=p.concat(x.D);return p}return g(u.i)}function bA(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var p=[],x=u.length,P=0;P<x;P++)p.push(u[P]);return p}p=[],x=0;for(P in u)p[x++]=u[P];return p}function VA(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var p=[];u=u.length;for(var x=0;x<u;x++)p.push(x);return p}p=[],x=0;for(const P in u)p[x++]=P;return p}}}function Yg(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var x=VA(u),P=bA(u),G=P.length,J=0;J<G;J++)p.call(void 0,P[J],x&&x[J],u)}var Qg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function BA(u,p){if(u){u=u.split("&");for(var x=0;x<u.length;x++){var P=u[x].indexOf("="),G=null;if(0<=P){var J=u[x].substring(0,P);G=u[x].substring(P+1)}else J=u[x];p(J,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function Fs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Fs){this.h=u.h,Jl(this,u.j),this.o=u.o,this.g=u.g,Zl(this,u.s),this.l=u.l;var p=u.i,x=new jo;x.i=p.i,p.g&&(x.g=new Map(p.g),x.h=p.h),Jg(this,x),this.m=u.m}else u&&(p=String(u).match(Qg))?(this.h=!1,Jl(this,p[1]||"",!0),this.o=Wo(p[2]||""),this.g=Wo(p[3]||"",!0),Zl(this,p[4]),this.l=Wo(p[5]||"",!0),Jg(this,p[6]||"",!0),this.m=Wo(p[7]||"")):(this.h=!1,this.i=new jo(null,this.h))}Fs.prototype.toString=function(){var u=[],p=this.j;p&&u.push($o(p,Zg,!0),":");var x=this.g;return(x||p=="file")&&(u.push("//"),(p=this.o)&&u.push($o(p,Zg,!0),"@"),u.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&u.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&u.push("/"),u.push($o(x,x.charAt(0)=="/"?HA:zA,!0))),(x=this.i.toString())&&u.push("?",x),(x=this.m)&&u.push("#",$o(x,$A)),u.join("")};function ai(u){return new Fs(u)}function Jl(u,p,x){u.j=x?Wo(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function Zl(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function Jg(u,p,x){p instanceof jo?(u.i=p,jA(u.i,u.h)):(x||(p=$o(p,WA)),u.i=new jo(p,u.h))}function at(u,p,x){u.i.set(p,x)}function eu(u){return at(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Wo(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function $o(u,p,x){return typeof u=="string"?(u=encodeURI(u).replace(p,UA),x&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function UA(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Zg=/[#\/\?@]/g,zA=/[#\?:]/g,HA=/[#\?]/g,WA=/[#\?@]/g,$A=/#/g;function jo(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Ni(u){u.g||(u.g=new Map,u.h=0,u.i&&BA(u.i,function(p,x){u.add(decodeURIComponent(p.replace(/\+/g," ")),x)}))}t=jo.prototype,t.add=function(u,p){Ni(this),this.i=null,u=Ia(this,u);var x=this.g.get(u);return x||this.g.set(u,x=[]),x.push(p),this.h+=1,this};function e1(u,p){Ni(u),p=Ia(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function t1(u,p){return Ni(u),p=Ia(u,p),u.g.has(p)}t.forEach=function(u,p){Ni(this),this.g.forEach(function(x,P){x.forEach(function(G){u.call(p,G,P,this)},this)},this)},t.na=function(){Ni(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),x=[];for(let P=0;P<p.length;P++){const G=u[P];for(let J=0;J<G.length;J++)x.push(p[P])}return x},t.V=function(u){Ni(this);let p=[];if(typeof u=="string")t1(this,u)&&(p=p.concat(this.g.get(Ia(this,u))));else{u=Array.from(this.g.values());for(let x=0;x<u.length;x++)p=p.concat(u[x])}return p},t.set=function(u,p){return Ni(this),this.i=null,u=Ia(this,u),t1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},t.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function r1(u,p,x){e1(u,p),0<x.length&&(u.i=null,u.g.set(Ia(u,p),g(x)),u.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var x=0;x<p.length;x++){var P=p[x];const J=encodeURIComponent(String(P)),he=this.V(P);for(P=0;P<he.length;P++){var G=J;he[P]!==""&&(G+="="+encodeURIComponent(String(he[P]))),u.push(G)}}return this.i=u.join("&")};function Ia(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function jA(u,p){p&&!u.j&&(Ni(u),u.i=null,u.g.forEach(function(x,P){var G=P.toLowerCase();P!=G&&(e1(this,P),r1(this,G,x))},u)),u.j=p}function GA(u,p){const x=new Rs;if(o.Image){const P=new Image;P.onload=m(Oi,x,"TestLoadImage: loaded",!0,p,P),P.onerror=m(Oi,x,"TestLoadImage: error",!1,p,P),P.onabort=m(Oi,x,"TestLoadImage: abort",!1,p,P),P.ontimeout=m(Oi,x,"TestLoadImage: timeout",!1,p,P),o.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=u}else p(!1)}function KA(u,p){const x=new Rs,P=new AbortController,G=setTimeout(()=>{P.abort(),Oi(x,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:P.signal}).then(J=>{clearTimeout(G),J.ok?Oi(x,"TestPingServer: ok",!0,p):Oi(x,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(G),Oi(x,"TestPingServer: error",!1,p)})}function Oi(u,p,x,P,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),P(x)}catch{}}function qA(){this.g=new Kl}function XA(u,p,x){const P=x||"";try{Yg(u,function(G,J){let he=G;l(G)&&(he=Uo(G)),p.push(P+J+"="+encodeURIComponent(he))})}catch(G){throw p.push(P+"type="+encodeURIComponent("_badmap")),G}}function tu(u){this.l=u.Ub||null,this.j=u.eb||!1}v(tu,Ta),tu.prototype.g=function(){return new ru(this.l,this.j)},tu.prototype.i=function(u){return function(){return u}}({});function ru(u,p){_t.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(ru,_t),t=ru.prototype,t.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Ko(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||o).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Go(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ko(this)),this.g&&(this.readyState=3,Ko(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;n1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function n1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?Go(this):Ko(this),this.readyState==3&&n1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Go(this))},t.Qa=function(u){this.g&&(this.response=u,Go(this))},t.ga=function(){this.g&&Go(this)};function Go(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ko(u)}t.setRequestHeader=function(u,p){this.u.append(u,p)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var x=p.next();!x.done;)x=x.value,u.push(x[0]+": "+x[1]),x=p.next();return u.join(`\r
`)};function Ko(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ru.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function i1(u){let p="";return B(u,function(x,P){p+=P,p+=":",p+=x,p+=`\r
`}),p}function eh(u,p,x){e:{for(P in x){var P=!1;break e}P=!0}P||(x=i1(x),typeof u=="string"?x!=null&&encodeURIComponent(String(x)):at(u,p,x))}function yt(u){_t.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(yt,_t);var YA=/^https?$/i,QA=["POST","PUT"];t=yt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,p,x,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?zo(this.o):zo(X),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(J){s1(this,J);return}if(u=x||"",x=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var G in P)x.set(G,P[G]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const J of P.keys())x.set(J,P.get(J));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(x.keys()).find(J=>J.toLowerCase()=="content-type"),G=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(QA,p,void 0))||P||G||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,he]of x)this.g.setRequestHeader(J,he);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{c1(this),this.u=!0,this.g.send(u),this.u=!1}catch(J){s1(this,J)}};function s1(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,a1(u),nu(u)}function a1(u){u.A||(u.A=!0,Ye(u,"complete"),Ye(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ye(this,"complete"),Ye(this,"abort"),nu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nu(this,!0)),yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?o1(this):this.bb())},t.bb=function(){o1(this)};function o1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||oi(u)!=4||u.Z()!=2)){if(u.u&&oi(u)==4)Oe(u.Ea,0,u);else if(Ye(u,"readystatechange"),oi(u)==4){u.h=!1;try{const he=u.Z();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var x;if(!(x=p)){var P;if(P=he===0){var G=String(u.D).match(Qg)[1]||null;!G&&o.self&&o.self.location&&(G=o.self.location.protocol.slice(0,-1)),P=!YA.test(G?G.toLowerCase():"")}x=P}if(x)Ye(u,"complete"),Ye(u,"success");else{u.m=6;try{var J=2<oi(u)?u.g.statusText:""}catch{J=""}u.l=J+" ["+u.Z()+"]",a1(u)}}finally{nu(u)}}}}function nu(u,p){if(u.g){c1(u);const x=u.g,P=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||Ye(u,"ready");try{x.onreadystatechange=P}catch{}}}function c1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function oi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<oi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Y0(p)}};function l1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function JA(u){const p={};u=(u.g&&2<=oi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<u.length;P++){if(T(u[P]))continue;var x=R(u[P]);const G=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const J=p[G]||[];p[G]=J,J.push(x)}y(p,function(P){return P.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function qo(u,p,x){return x&&x.internalChannelParams&&x.internalChannelParams[u]||p}function u1(u){this.Aa=0,this.i=[],this.j=new Rs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=qo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=qo("baseRetryDelayMs",5e3,u),this.cb=qo("retryDelaySeedMs",1e4,u),this.Wa=qo("forwardChannelMaxRetries",2,u),this.wa=qo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Un(u&&u.concurrentRequestLimit),this.Da=new qA,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=u1.prototype,t.la=8,t.G=1,t.connect=function(u,p,x,P){Gt(0),this.W=u,this.H=p||{},x&&P!==void 0&&(this.H.OSID=x,this.H.OAID=P),this.F=this.X,this.I=x1(this,null,this.W),su(this)};function th(u){if(f1(u),u.G==3){var p=u.U++,x=ai(u.I);if(at(x,"SID",u.K),at(x,"RID",p),at(x,"TYPE","terminate"),Xo(u,x),p=new q(u,u.j,p),p.L=2,p.v=eu(ai(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(p.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=p.v,x=!0),x||(p.g=y1(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Se(p)}_1(u)}function iu(u){u.g&&(nh(u),u.g.cancel(),u.g=null)}function f1(u){iu(u),u.u&&(o.clearTimeout(u.u),u.u=null),au(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function su(u){if(!Sa(u.h)&&!u.s){u.s=!0;var p=u.Ga;me||ce(),ie||(me(),ie=!0),W.add(p,u),u.B=0}}function ZA(u,p){return on(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Cs(d(u.Ga,u,p),v1(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const G=new q(this,this.j,u);let J=this.o;if(this.S&&(J?(J=k(J),I(J,this.S)):J=this.S),this.m!==null||this.O||(G.H=J,J=null),this.P)e:{for(var p=0,x=0;x<this.i.length;x++){t:{var P=this.i[x];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(p+=P,4096<p){p=x;break e}if(p===4096||x===this.i.length-1){p=x+1;break e}}p=1e3}else p=1e3;p=d1(this,G,p),x=ai(this.I),at(x,"RID",u),at(x,"CVER",22),this.D&&at(x,"X-HTTP-Session-Id",this.D),Xo(this,x),J&&(this.O?p="headers="+encodeURIComponent(String(i1(J)))+"&"+p:this.m&&eh(x,this.m,J)),Z0(this.h,G),this.Ua&&at(x,"TYPE","init"),this.P?(at(x,"$req",p),at(x,"SID","null"),G.T=!0,fe(G,x,null)):fe(G,x,p),this.G=2}}else this.G==3&&(u?h1(this,u):this.i.length==0||Sa(this.h)||h1(this))};function h1(u,p){var x;p?x=p.l:x=u.U++;const P=ai(u.I);at(P,"SID",u.K),at(P,"RID",x),at(P,"AID",u.T),Xo(u,P),u.m&&u.o&&eh(P,u.m,u.o),x=new q(u,u.j,x,u.B+1),u.m===null&&(x.H=u.o),p&&(u.i=p.D.concat(u.i)),p=d1(u,x,1e3),x.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Z0(u.h,x),fe(x,P,p)}function Xo(u,p){u.H&&B(u.H,function(x,P){at(p,P,x)}),u.l&&Yg({},function(x,P){at(p,P,x)})}function d1(u,p,x){x=Math.min(u.i.length,x);var P=u.l?d(u.l.Na,u.l,u):null;e:{var G=u.i;let J=-1;for(;;){const he=["count="+x];J==-1?0<x?(J=G[0].g,he.push("ofs="+J)):J=0:he.push("ofs="+J);let et=!0;for(let Kt=0;Kt<x;Kt++){let Ke=G[Kt].g;const ir=G[Kt].map;if(Ke-=J,0>Ke)J=Math.max(0,G[Kt].g-100),et=!1;else try{XA(ir,he,"req"+Ke+"_")}catch{P&&P(ir)}}if(et){P=he.join("&");break e}}}return u=u.i.splice(0,x),p.D=u,P}function p1(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;me||ce(),ie||(me(),ie=!0),W.add(p,u),u.v=0}}function rh(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Cs(d(u.Fa,u),v1(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,m1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Cs(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),iu(this),m1(this))};function nh(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function m1(u){u.g=new q(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=ai(u.qa);at(p,"RID","rpc"),at(p,"SID",u.K),at(p,"AID",u.T),at(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&at(p,"TO",u.ja),at(p,"TYPE","xmlhttp"),Xo(u,p),u.m&&u.o&&eh(p,u.m,u.o),u.L&&(u.g.I=u.L);var x=u.g;u=u.ia,x.L=1,x.v=eu(ai(p)),x.m=null,x.P=!0,_e(x,u)}t.Za=function(){this.C!=null&&(this.C=null,iu(this),rh(this),Gt(19))};function au(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function g1(u,p){var x=null;if(u.g==p){au(u),nh(u),u.g=null;var P=2}else if(J0(u.h,p))x=p.D,qg(u.h,p),P=1;else return;if(u.G!=0){if(p.o)if(P==1){x=p.m?p.m.length:0,p=Date.now()-p.F;var G=u.B;P=ka(),Ye(P,new Aa(P,x)),su(u)}else p1(u);else if(G=p.s,G==3||G==0&&0<p.X||!(P==1&&ZA(u,p)||P==2&&rh(u)))switch(x&&0<x.length&&(p=u.h,p.i=p.i.concat(x)),G){case 1:Ds(u,5);break;case 4:Ds(u,10);break;case 3:Ds(u,6);break;default:Ds(u,2)}}}function v1(u,p){let x=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(x*=2),x*p}function Ds(u,p){if(u.j.info("Error code "+p),p==2){var x=d(u.fb,u),P=u.Xa;const G=!P;P=new Fs(P||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Jl(P,"https"),eu(P),G?GA(P.toString(),x):KA(P.toString(),x)}else Gt(2);u.G=0,u.l&&u.l.sa(p),_1(u),f1(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function _1(u){if(u.G=0,u.ka=[],u.l){const p=Xg(u.h);(p.length!=0||u.i.length!=0)&&(E(u.ka,p),E(u.ka,u.i),u.h.i.length=0,g(u.i),u.i.length=0),u.l.ra()}}function x1(u,p,x){var P=x instanceof Fs?ai(x):new Fs(x);if(P.g!="")p&&(P.g=p+"."+P.g),Zl(P,P.s);else{var G=o.location;P=G.protocol,p=p?p+"."+G.hostname:G.hostname,G=+G.port;var J=new Fs(null);P&&Jl(J,P),p&&(J.g=p),G&&Zl(J,G),x&&(J.l=x),P=J}return x=u.D,p=u.ya,x&&p&&at(P,x,p),at(P,"VER",u.la),Xo(u,P),P}function y1(u,p,x){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new yt(new tu({eb:x})):new yt(u.pa),p.Ha(u.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function E1(){}t=E1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ou(){}ou.prototype.g=function(u,p){return new Gr(u,p)};function Gr(u,p){_t.call(this),this.g=new u1(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!T(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!T(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new Ca(this)}v(Gr,_t),Gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Gr.prototype.close=function(){th(this.g)},Gr.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var x={};x.__data__=u,u=x}else this.u&&(x={},x.__data__=Uo(u),u=x);p.i.push(new Ps(p.Ya++,u)),p.G==3&&su(p)},Gr.prototype.N=function(){this.g.l=null,delete this.j,th(this.g),delete this.g,Gr.aa.N.call(this)};function w1(u){Di.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const x in p){u=x;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}v(w1,Di);function T1(){Ho.call(this),this.status=1}v(T1,Ho);function Ca(u){this.g=u}v(Ca,E1),Ca.prototype.ua=function(){Ye(this.g,"a")},Ca.prototype.ta=function(u){Ye(this.g,new w1(u))},Ca.prototype.sa=function(u){Ye(this.g,new T1)},Ca.prototype.ra=function(){Ye(this.g,"b")},ou.prototype.createWebChannel=ou.prototype.g,Gr.prototype.send=Gr.prototype.o,Gr.prototype.open=Gr.prototype.m,Gr.prototype.close=Gr.prototype.close,gT=function(){return new ou},mT=function(){return ka()},pT=ii,rp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},M.NO_ERROR=0,M.TIMEOUT=8,M.HTTP_ERROR=6,rf=M,V.COMPLETE="complete",dT=V,ql.EventType=Ss,Ss.OPEN="a",Ss.CLOSE="b",Ss.ERROR="c",Ss.MESSAGE="d",_t.prototype.listen=_t.prototype.K,fc=ql,yt.prototype.listenOnce=yt.prototype.L,yt.prototype.getLastError=yt.prototype.Ka,yt.prototype.getLastErrorCode=yt.prototype.Ba,yt.prototype.getStatus=yt.prototype.Z,yt.prototype.getResponseJson=yt.prototype.Oa,yt.prototype.getResponseText=yt.prototype.oa,yt.prototype.send=yt.prototype.ea,yt.prototype.setWithCredentials=yt.prototype.Ha,hT=yt}).apply(typeof Iu<"u"?Iu:typeof self<"u"?self:typeof window<"u"?window:{});const l_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ur.UNAUTHENTICATED=new ur(null),ur.GOOGLE_CREDENTIALS=new ur("google-credentials-uid"),ur.FIRST_PARTY=new ur("first-party-uid"),ur.MOCK_USER=new ur("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let No="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ea=new T0("@firebase/firestore");function ic(){return ea.logLevel}function ke(t,...e){if(ea.logLevel<=Ue.DEBUG){const r=e.map(Lm);ea.debug(`Firestore (${No}): ${t}`,...r)}}function Si(t,...e){if(ea.logLevel<=Ue.ERROR){const r=e.map(Lm);ea.error(`Firestore (${No}): ${t}`,...r)}}function _o(t,...e){if(ea.logLevel<=Ue.WARN){const r=e.map(Lm);ea.warn(`Firestore (${No}): ${t}`,...r)}}function Lm(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t="Unexpected state"){const e=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: `+t;throw Si(e),new Error(e)}function Je(t,e){t||Re()}function De(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends bn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fF{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ur.UNAUTHENTICATED))}shutdown(){}}class hF{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class dF{constructor(e){this.t=e,this.currentUser=ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Je(this.o===void 0);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let s=new us;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new us,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new us)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Je(typeof n.accessToken=="string"),new vT(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string"),new ur(e)}}class pF{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=ur.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class mF{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new pF(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(ur.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class gF{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vF{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){Je(this.o===void 0);const n=s=>{s.error!=null&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.R;return this.R=s.token,ke("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Je(typeof r.token=="string"),this.R=r.token,new gF(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const i=_F(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}}function qe(t,e){return t<e?-1:t>e?1:0}function xo(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Te(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Te(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Te(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Vt(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qe(this.nanoseconds,e.nanoseconds):qe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new Vt(0,0))}static max(){return new Pe(new Vt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,r,n){r===void 0?r=0:r>e.length&&Re(),n===void 0?n=e.length-r:n>e.length-r&&Re(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ul.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ul?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class ct extends ul{construct(e,r,n){return new ct(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(te.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new ct(r)}static emptyPath(){return new ct([])}}const xF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qt extends ul{construct(e,r,n){return new Qt(e,r,n)}static isValidIdentifier(e){return xF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Qt(["__name__"])}static fromServerFormat(e){const r=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Te(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new Te(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Te(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Te(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qt(r)}static emptyPath(){return new Qt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(ct.fromString(e))}static fromName(e){return new Ae(ct.fromString(e).popFirst(5))}static empty(){return new Ae(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ct.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ct.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new ct(e.slice()))}}function yF(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=Pe.fromTimestamp(n===1e9?new Vt(r+1,0):new Vt(r,n));return new ms(i,Ae.empty(),e)}function EF(t){return new ms(t.readTime,t.key,-1)}class ms{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ms(Pe.min(),Ae.empty(),-1)}static max(){return new ms(Pe.max(),Ae.empty(),-1)}}function wF(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ae.comparator(t.documentKey,e.documentKey),r!==0?r:qe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class kF{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nl(t){if(t.code!==te.FAILED_PRECONDITION||t.message!==TF)throw t;ke("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new re((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof re?r:re.resolve(r)}catch(r){return re.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):re.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):re.reject(r)}static resolve(e){return new re((r,n)=>{r(e)})}static reject(e){return new re((r,n)=>{n(e)})}static waitFor(e){return new re((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=re.resolve(!1);for(const n of e)r=r.next(i=>i?re.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new re((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const l=c;r(e[l]).next(f=>{a[l]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,r){return new re((n,i)=>{const s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}}function AF(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ol(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Mm.oe=-1;function C0(t){return t==null}function Bf(t){return t===0&&1/t==-1/0}function SF(t){return typeof t=="number"&&Number.isInteger(t)&&!Bf(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function pa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function xT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,r){this.comparator=e,this.root=r||Xt.EMPTY}insert(e,r){return new vt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Xt.BLACK,null,null))}remove(e){return new vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cu(this.root,e,this.comparator,!0)}}class Cu{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xt{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??Xt.RED,this.left=i??Xt.EMPTY,this.right=s??Xt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new Xt(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Xt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Re();const e=this.left.check();if(e!==this.right.check())throw Re();return e+(this.isRed()?0:1)}}Xt.EMPTY=null,Xt.RED=!0,Xt.BLACK=!1;Xt.EMPTY=new class{constructor(){this.size=0}get key(){throw Re()}get value(){throw Re()}get color(){throw Re()}get left(){throw Re()}get right(){throw Re()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Xt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.comparator=e,this.data=new vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new f_(this.data.getIterator())}getIteratorFrom(e){return new f_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Zt(this.comparator);return r.data=e,r}}class f_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.fields=e,e.sort(Qt.comparator)}static empty(){return new Qr([])}unionWith(e){let r=new Zt(Qt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Qr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return xo(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new yT("Invalid base64 string: "+s):s}}(e);return new nr(r)}static fromUint8Array(e){const r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new nr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}nr.EMPTY_BYTE_STRING=new nr("");const IF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gs(t){if(Je(!!t),typeof t=="string"){let e=0;const r=IF.exec(t);if(Je(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:St(t.seconds),nanos:St(t.nanos)}}function St(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ta(t){return typeof t=="string"?nr.fromBase64String(t):nr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function Vm(t){const e=t.mapValue.fields.__previous_value__;return bm(e)?Vm(e):e}function fl(t){const e=gs(t.mapValue.fields.__local_write_time__.timestampValue);return new Vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CF{constructor(e,r,n,i,s,a,o,c,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}}class hl{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new hl("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function ra(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bm(t)?4:PF(t)?9007199254740991:RF(t)?10:11:Re()}function ei(t,e){if(t===e)return!0;const r=ra(t);if(r!==ra(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return fl(t).isEqual(fl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=gs(i.timestampValue),o=gs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return ta(i.bytesValue).isEqual(ta(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return St(i.geoPointValue.latitude)===St(s.geoPointValue.latitude)&&St(i.geoPointValue.longitude)===St(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return St(i.integerValue)===St(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=St(i.doubleValue),o=St(s.doubleValue);return a===o?Bf(a)===Bf(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return xo(t.arrayValue.values||[],e.arrayValue.values||[],ei);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(u_(a)!==u_(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!ei(a[c],o[c])))return!1;return!0}(t,e);default:return Re()}}function dl(t,e){return(t.values||[]).find(r=>ei(r,e))!==void 0}function yo(t,e){if(t===e)return 0;const r=ra(t),n=ra(e);if(r!==n)return qe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return qe(t.booleanValue,e.booleanValue);case 2:return function(s,a){const o=St(s.integerValue||s.doubleValue),c=St(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return h_(t.timestampValue,e.timestampValue);case 4:return h_(fl(t),fl(e));case 5:return qe(t.stringValue,e.stringValue);case 6:return function(s,a){const o=ta(s),c=ta(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){const f=qe(o[l],c[l]);if(f!==0)return f}return qe(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){const o=qe(St(s.latitude),St(a.latitude));return o!==0?o:qe(St(s.longitude),St(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return d_(t.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,l,f;const h=s.fields||{},d=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,v=(c=d.value)===null||c===void 0?void 0:c.arrayValue,g=qe(((l=m==null?void 0:m.values)===null||l===void 0?void 0:l.length)||0,((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0);return g!==0?g:d_(m,v)}(t.mapValue,e.mapValue);case 11:return function(s,a){if(s===Ru.mapValue&&a===Ru.mapValue)return 0;if(s===Ru.mapValue)return 1;if(a===Ru.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),l=a.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let h=0;h<c.length&&h<f.length;++h){const d=qe(c[h],f[h]);if(d!==0)return d;const m=yo(o[c[h]],l[f[h]]);if(m!==0)return m}return qe(c.length,f.length)}(t.mapValue,e.mapValue);default:throw Re()}}function h_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return qe(t,e);const r=gs(t),n=gs(e),i=qe(r.seconds,n.seconds);return i!==0?i:qe(r.nanos,n.nanos)}function d_(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const s=yo(r[i],n[i]);if(s)return s}return qe(r.length,n.length)}function Eo(t){return np(t)}function np(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=gs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ta(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const s of r.values||[])i?i=!1:n+=",",n+=np(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${np(r.fields[a])}`;return i+"}"}(t.mapValue):Re()}function p_(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ip(t){return!!t&&"integerValue"in t}function Bm(t){return!!t&&"arrayValue"in t}function m_(t){return!!t&&"nullValue"in t}function g_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nf(t){return!!t&&"mapValue"in t}function RF(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Rc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return pa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Rc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Rc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function PF(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.value=e}static empty(){return new Lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!nf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rc(r)}setAll(e){let r=Qt.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Rc(a):i.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){const r=this.field(e.popLast());nf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ei(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];nf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){pa(r,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Lr(Rc(this.value))}}function ET(t){const e=[];return pa(t.fields,(r,n)=>{const i=new Qt([r]);if(nf(n)){const s=ET(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new Qr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new dr(e,0,Pe.min(),Pe.min(),Pe.min(),Lr.empty(),0)}static newFoundDocument(e,r,n,i){return new dr(e,1,r,Pe.min(),n,i,0)}static newNoDocument(e,r){return new dr(e,2,r,Pe.min(),Pe.min(),Lr.empty(),0)}static newUnknownDocument(e,r){return new dr(e,3,r,Pe.min(),Pe.min(),Lr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,r){this.position=e,this.inclusive=r}}function v_(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Ae.comparator(Ae.fromName(a.referenceValue),r.key):n=yo(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function __(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ei(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,r="asc"){this.field=e,this.dir=r}}function FF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{}class Nt extends wT{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new NF(e,r,n):r==="array-contains"?new MF(e,n):r==="in"?new bF(e,n):r==="not-in"?new VF(e,n):r==="array-contains-any"?new BF(e,n):new Nt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new OF(e,n):new LF(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(yo(r,this.value)):r!==null&&ra(this.value)===ra(r)&&this.matchesComparison(yo(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Mn extends wT{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new Mn(e,r)}matches(e){return TT(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function TT(t){return t.op==="and"}function kT(t){return DF(t)&&TT(t)}function DF(t){for(const e of t.filters)if(e instanceof Mn)return!1;return!0}function sp(t){if(t instanceof Nt)return t.field.canonicalString()+t.op.toString()+Eo(t.value);if(kT(t))return t.filters.map(e=>sp(e)).join(",");{const e=t.filters.map(r=>sp(r)).join(",");return`${t.op}(${e})`}}function AT(t,e){return t instanceof Nt?function(n,i){return i instanceof Nt&&n.op===i.op&&n.field.isEqual(i.field)&&ei(n.value,i.value)}(t,e):t instanceof Mn?function(n,i){return i instanceof Mn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&AT(a,i.filters[o]),!0):!1}(t,e):void Re()}function ST(t){return t instanceof Nt?function(r){return`${r.field.canonicalString()} ${r.op} ${Eo(r.value)}`}(t):t instanceof Mn?function(r){return r.op.toString()+" {"+r.getFilters().map(ST).join(" ,")+"}"}(t):"Filter"}class NF extends Nt{constructor(e,r,n){super(e,r,n),this.key=Ae.fromName(n.referenceValue)}matches(e){const r=Ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class OF extends Nt{constructor(e,r){super(e,"in",r),this.keys=IT("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class LF extends Nt{constructor(e,r){super(e,"not-in",r),this.keys=IT("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function IT(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Ae.fromName(n.referenceValue))}class MF extends Nt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Bm(r)&&dl(r.arrayValue,this.value)}}class bF extends Nt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&dl(this.value.arrayValue,r)}}class VF extends Nt{constructor(e,r){super(e,"not-in",r)}matches(e){if(dl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!dl(this.value.arrayValue,r)}}class BF extends Nt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Bm(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>dl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}}function x_(t,e=null,r=[],n=[],i=null,s=null,a=null){return new UF(t,e,r,n,i,s,a)}function Um(t){const e=De(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>sp(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),C0(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Eo(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Eo(n)).join(",")),e.ue=r}return e.ue}function zm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!FF(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!AT(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!__(t.startAt,e.startAt)&&__(t.endAt,e.endAt)}function ap(t){return Ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function zF(t,e,r,n,i,s,a,o){return new Ll(t,e,r,n,i,s,a,o)}function Hm(t){return new Ll(t)}function y_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function CT(t){return t.collectionGroup!==null}function Pc(t){const e=De(t);if(e.ce===null){e.ce=[];const r=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zt(Qt.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zf(s,n))}),r.has(Qt.keyField().canonicalString())||e.ce.push(new zf(Qt.keyField(),n))}return e.ce}function Yn(t){const e=De(t);return e.le||(e.le=HF(e,Pc(t))),e.le}function HF(t,e){if(t.limitType==="F")return x_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zf(i.field,s)});const r=t.endAt?new Uf(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Uf(t.startAt.position,t.startAt.inclusive):null;return x_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function op(t,e){const r=t.filters.concat([e]);return new Ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function cp(t,e,r){return new Ll(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function R0(t,e){return zm(Yn(t),Yn(e))&&t.limitType===e.limitType}function RT(t){return`${Um(Yn(t))}|lt:${t.limitType}`}function Da(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ST(i)).join(", ")}]`),C0(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Eo(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Eo(i)).join(",")),`Target(${n})`}(Yn(t))}; limitType=${t.limitType})`}function P0(t,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ae.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(const s of Pc(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const l=v_(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,Pc(n),i)||n.endAt&&!function(a,o,c){const l=v_(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,Pc(n),i))}(t,e)}function WF(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function PT(t){return(e,r)=>{let n=!1;for(const i of Pc(t)){const s=$F(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function $F(t,e,r){const n=t.field.isKeyField()?Ae.comparator(e.key,r.key):function(s,a,o){const c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?yo(c,l):Re()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pa(this.inner,(r,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return xT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=new vt(Ae.comparator);function Ii(){return jF}const FT=new vt(Ae.comparator);function hc(...t){let e=FT;for(const r of t)e=e.insert(r.key,r);return e}function DT(t){let e=FT;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Us(){return Fc()}function NT(){return Fc()}function Fc(){return new Oo(t=>t.toString(),(t,e)=>t.isEqual(e))}const GF=new vt(Ae.comparator),KF=new Zt(Ae.comparator);function Be(...t){let e=KF;for(const r of t)e=e.add(r);return e}const qF=new Zt(qe);function XF(){return qF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bf(e)?"-0":e}}function OT(t){return{integerValue:""+t}}function YF(t,e){return SF(e)?OT(e):Wm(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(){this._=void 0}}function QF(t,e,r){return t instanceof Hf?function(i,s){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&bm(s)&&(s=Vm(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof pl?MT(t,e):t instanceof ml?bT(t,e):function(i,s){const a=LT(i,s),o=E_(a)+E_(i.Pe);return ip(a)&&ip(i.Pe)?OT(o):Wm(i.serializer,o)}(t,e)}function JF(t,e,r){return t instanceof pl?MT(t,e):t instanceof ml?bT(t,e):r}function LT(t,e){return t instanceof Wf?function(n){return ip(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Hf extends F0{}class pl extends F0{constructor(e){super(),this.elements=e}}function MT(t,e){const r=VT(e);for(const n of t.elements)r.some(i=>ei(i,n))||r.push(n);return{arrayValue:{values:r}}}class ml extends F0{constructor(e){super(),this.elements=e}}function bT(t,e){let r=VT(e);for(const n of t.elements)r=r.filter(i=>!ei(i,n));return{arrayValue:{values:r}}}class Wf extends F0{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function E_(t){return St(t.integerValue||t.doubleValue)}function VT(t){return Bm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ZF(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof pl&&i instanceof pl||n instanceof ml&&i instanceof ml?xo(n.elements,i.elements,ei):n instanceof Wf&&i instanceof Wf?ei(n.Pe,i.Pe):n instanceof Hf&&i instanceof Hf}(t.transform,e.transform)}class e3{constructor(e,r){this.version=e,this.transformResults=r}}class Zr{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Zr}static exists(e){return new Zr(void 0,e)}static updateTime(e){return new Zr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sf(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class D0{}function BT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new N0(t.key,Zr.none()):new Ml(t.key,t.data,Zr.none());{const r=t.data,n=Lr.empty();let i=new Zt(Qt.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ks(t.key,n,new Qr(i.toArray()),Zr.none())}}function t3(t,e,r){t instanceof Ml?function(i,s,a){const o=i.value.clone(),c=T_(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ks?function(i,s,a){if(!sf(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=T_(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(UT(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Dc(t,e,r,n){return t instanceof Ml?function(s,a,o,c){if(!sf(s.precondition,a))return o;const l=s.value.clone(),f=k_(s.fieldTransforms,c,a);return l.setAll(f),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof ks?function(s,a,o,c){if(!sf(s.precondition,a))return o;const l=k_(s.fieldTransforms,c,a),f=a.data;return f.setAll(UT(s)),f.setAll(l),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(s,a,o){return sf(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function r3(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),s=LT(n.transform,i||null);s!=null&&(r===null&&(r=Lr.empty()),r.set(n.field,s))}return r||null}function w_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&xo(n,i,(s,a)=>ZF(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ml extends D0{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ks extends D0{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function UT(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function T_(t,e,r){const n=new Map;Je(t.length===r.length);for(let i=0;i<r.length;i++){const s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,JF(a,o,r[i]))}return n}function k_(t,e,r){const n=new Map;for(const i of t){const s=i.transform,a=r.data.field(i.field);n.set(i.field,QF(s,a,e))}return n}class N0 extends D0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class n3 extends D0{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&t3(s,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Dc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Dc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=NT();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;const c=BT(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(Pe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Be())}isEqual(e){return this.batchId===e.batchId&&xo(this.mutations,e.mutations,(r,n)=>w_(r,n))&&xo(this.baseMutations,e.baseMutations,(r,n)=>w_(r,n))}}class $m{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Je(e.mutations.length===n.length);let i=function(){return GF}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new $m(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s3{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a3{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,He;function o3(t){switch(t){default:return Re();case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0}}function zT(t){if(t===void 0)return Si("GRPC error has no .code"),te.UNKNOWN;switch(t){case Rt.OK:return te.OK;case Rt.CANCELLED:return te.CANCELLED;case Rt.UNKNOWN:return te.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return te.INTERNAL;case Rt.UNAVAILABLE:return te.UNAVAILABLE;case Rt.UNAUTHENTICATED:return te.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case Rt.NOT_FOUND:return te.NOT_FOUND;case Rt.ALREADY_EXISTS:return te.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return te.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case Rt.ABORTED:return te.ABORTED;case Rt.OUT_OF_RANGE:return te.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return te.UNIMPLEMENTED;case Rt.DATA_LOSS:return te.DATA_LOSS;default:return Re()}}(He=Rt||(Rt={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=new js([4294967295,4294967295],0);function A_(t){const e=c3().encode(t),r=new fT;return r.update(e),new Uint8Array(r.digest())}function S_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new js([r,n],0),new js([i,s],0)]}class jm{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new dc(`Invalid padding: ${r}`);if(n<0)throw new dc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new dc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new dc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=js.fromNumber(this.Ie)}Ee(e,r,n){let i=e.add(r.multiply(js.fromNumber(n)));return i.compare(l3)===1&&(i=new js([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=A_(e),[n,i]=S_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new jm(s,i,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=A_(e),[n,i]=S_(r);for(let s=0;s<this.hashCount;s++){const a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class dc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,r,n,i,s){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,bl.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new O0(Pe.min(),i,new vt(qe),Ii(),Be())}}class bl{constructor(e,r,n,i,s){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new bl(n,r,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,r,n,i){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=i}}class HT{constructor(e,r){this.targetId=e,this.me=r}}class WT{constructor(e,r,n=nr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class I_{constructor(){this.fe=0,this.ge=R_(),this.pe=nr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Be(),r=Be(),n=Be();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:Re()}}),new bl(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=R_()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Je(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class u3{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ii(),this.qe=C_(),this.Qe=new vt(qe)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Re()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,i)=>{this.ze(i)&&r(i)})}He(e){const r=e.targetId,n=e.me.count,i=this.Je(r);if(i){const s=i.target;if(ap(s))if(n===0){const a=new Ae(s.path);this.Ue(r,a,dr.newNoDocument(a,Pe.min()))}else Je(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),c=o?this.Xe(o,e,a):1;if(c!==0){this.je(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,l)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=r;let a,o;try{a=ta(n).toUint8Array()}catch(c){if(c instanceof yT)return _o("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new jm(a,i,s)}catch(c){return _o(c instanceof dc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let i=0;return n.forEach(s=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,s,null),i++)}),i}rt(e){const r=new Map;this.Be.forEach((s,a)=>{const o=this.Je(a);if(o){if(s.current&&ap(o.target)){const c=new Ae(o.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,dr.newNoDocument(c,e))}s.be&&(r.set(a,s.ve()),s.Ce())}});let n=Be();this.qe.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));const i=new O0(e,r,this.Qe,this.ke,n);return this.ke=Ii(),this.qe=C_(),this.Qe=new vt(qe),i}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,r)?i.Fe(r,1):i.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new I_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Zt(qe),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||ke("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new I_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function C_(){return new vt(Ae.comparator)}function R_(){return new vt(Ae.comparator)}const f3=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),h3=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),d3=(()=>({and:"AND",or:"OR"}))();class p3{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function lp(t,e){return t.useProto3Json||C0(e)?e:{value:e}}function $f(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $T(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function m3(t,e){return $f(t,e.toTimestamp())}function Qn(t){return Je(!!t),Pe.fromTimestamp(function(r){const n=gs(r);return new Vt(n.seconds,n.nanos)}(t))}function Gm(t,e){return up(t,e).canonicalString()}function up(t,e){const r=function(i){return new ct(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function jT(t){const e=ct.fromString(t);return Je(YT(e)),e}function fp(t,e){return Gm(t.databaseId,e.path)}function Vh(t,e){const r=jT(e);if(r.get(1)!==t.databaseId.projectId)throw new Te(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Te(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Ae(KT(r))}function GT(t,e){return Gm(t.databaseId,e)}function g3(t){const e=jT(t);return e.length===4?ct.emptyPath():KT(e)}function hp(t){return new ct(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function KT(t){return Je(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function P_(t,e,r){return{name:fp(t,e),fields:r.value.mapValue.fields}}function v3(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Re()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,f){return l.useProto3Json?(Je(f===void 0||typeof f=="string"),nr.fromBase64String(f||"")):(Je(f===void 0||f instanceof Buffer||f instanceof Uint8Array),nr.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(l){const f=l.code===void 0?te.UNKNOWN:zT(l.code);return new Te(f,l.message||"")}(a);r=new WT(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Vh(t,n.document.name),s=Qn(n.document.updateTime),a=n.document.createTime?Qn(n.document.createTime):Pe.min(),o=new Lr({mapValue:{fields:n.document.fields}}),c=dr.newFoundDocument(i,s,a,o),l=n.targetIds||[],f=n.removedTargetIds||[];r=new af(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Vh(t,n.document),s=n.readTime?Qn(n.readTime):Pe.min(),a=dr.newNoDocument(i,s),o=n.removedTargetIds||[];r=new af([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Vh(t,n.document),s=n.removedTargetIds||[];r=new af([],s,i,null)}else{if(!("filter"in e))return Re();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new a3(i,s),o=n.targetId;r=new HT(o,a)}}return r}function _3(t,e){let r;if(e instanceof Ml)r={update:P_(t,e.key,e.value)};else if(e instanceof N0)r={delete:fp(t,e.key)};else if(e instanceof ks)r={update:P_(t,e.key,e.data),updateMask:I3(e.fieldMask)};else{if(!(e instanceof n3))return Re();r={verify:fp(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof Hf)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof pl)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof ml)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Wf)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Re()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:m3(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Re()}(t,e.precondition)),r}function x3(t,e){return t&&t.length>0?(Je(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Qn(i.updateTime):Qn(s);return a.isEqual(Pe.min())&&(a=Qn(s)),new e3(a,i.transformResults||[])}(r,e))):[]}function y3(t,e){return{documents:[GT(t,e.path)]}}function E3(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=GT(t,i);const s=function(l){if(l.length!==0)return XT(Mn.create(l,"and"))}(e.filters);s&&(r.structuredQuery.where=s);const a=function(l){if(l.length!==0)return l.map(f=>function(d){return{field:Na(d.field),direction:k3(d.dir)}}(f))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=lp(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:r,parent:i}}function w3(t){let e=g3(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Je(n===1);const f=r.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];r.where&&(s=function(h){const d=qT(h);return d instanceof Mn&&kT(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(v){return new zf(Oa(v.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,C0(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(h){const d=!!h.before,m=h.values||[];return new Uf(m,d)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const d=!h.before,m=h.values||[];return new Uf(m,d)}(r.endAt)),zF(e,i,a,s,o,"F",c,l)}function T3(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function qT(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Oa(r.unaryFilter.field);return Nt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Oa(r.unaryFilter.field);return Nt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Oa(r.unaryFilter.field);return Nt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Oa(r.unaryFilter.field);return Nt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Re()}}(t):t.fieldFilter!==void 0?function(r){return Nt.create(Oa(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Re()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Mn.create(r.compositeFilter.filters.map(n=>qT(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Re()}}(r.compositeFilter.op))}(t):Re()}function k3(t){return f3[t]}function A3(t){return h3[t]}function S3(t){return d3[t]}function Na(t){return{fieldPath:t.canonicalString()}}function Oa(t){return Qt.fromServerFormat(t.fieldPath)}function XT(t){return t instanceof Nt?function(r){if(r.op==="=="){if(g_(r.value))return{unaryFilter:{field:Na(r.field),op:"IS_NAN"}};if(m_(r.value))return{unaryFilter:{field:Na(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(g_(r.value))return{unaryFilter:{field:Na(r.field),op:"IS_NOT_NAN"}};if(m_(r.value))return{unaryFilter:{field:Na(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Na(r.field),op:A3(r.op),value:r.value}}}(t):t instanceof Mn?function(r){const n=r.getFilters().map(i=>XT(i));return n.length===1?n[0]:{compositeFilter:{op:S3(r.op),filters:n}}}(t):Re()}function I3(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function YT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,r,n,i,s=Pe.min(),a=Pe.min(),o=nr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(e){this.ct=e}}function R3(t){const e=w3({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(){this.un=new F3}addToCollectionParentIndex(e,r){return this.un.add(r),re.resolve()}getCollectionParents(e,r){return re.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return re.resolve()}deleteFieldIndex(e,r){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,r){return re.resolve()}getDocumentsMatchingTarget(e,r){return re.resolve(null)}getIndexType(e,r){return re.resolve(0)}getFieldIndexes(e,r){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,r){return re.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,r){return re.resolve(ms.min())}updateCollectionGroup(e,r,n){return re.resolve()}updateIndexEntries(e,r){return re.resolve()}}class F3{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Zt(ct.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Zt(ct.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new wo(0)}static kn(){return new wo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D3{constructor(){this.changes=new Oo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,dr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?re.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Dc(n.mutation,i,Qr.empty(),Vt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Be()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Be()){const i=Us();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=hc();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Us();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Be()))}populateOverlays(e,r,n){const i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Ii();const a=Fc(),o=function(){return Fc()}();return r.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(f===void 0||f.mutation instanceof ks)?s=s.insert(l.key,l):f!==void 0?(a.set(l.key,f.mutation.getFieldMask()),Dc(f.mutation,l,f.mutation.getFieldMask(),Vt.now())):a.set(l.key,Qr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>a.set(l,f)),r.forEach((l,f)=>{var h;return o.set(l,new N3(f,(h=a.get(l))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Fc();let i=new vt((a,o)=>a-o),s=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let f=n.get(c)||Qr.empty();f=o.applyToLocalView(l,f),n.set(c,f);const h=(i.get(o.batchId)||Be()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,f=c.value,h=NT();f.forEach(d=>{if(!s.has(d)){const m=BT(r.get(d),n.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,h))}return re.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):CT(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):re.resolve(Us());let o=-1,c=s;return a.next(l=>re.forEach(l,(f,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(f)?re.resolve():this.remoteDocumentCache.getEntry(e,f).next(d=>{c=c.insert(f,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Be())).next(f=>({batchId:o,changes:DT(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ae(r)).next(n=>{let i=hc();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const s=r.collectionGroup;let a=hc();return this.indexManager.getCollectionParents(e,s).next(o=>re.forEach(o,c=>{const l=function(h,d){return new Ll(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(f=>{f.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,l)=>{const f=l.getKey();a.get(f)===null&&(a=a.insert(f,dr.newInvalidDocument(f)))});let o=hc();return a.forEach((c,l)=>{const f=s.get(c);f!==void 0&&Dc(f.mutation,l,Qr.empty(),Vt.now()),P0(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return re.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Qn(i.createTime)}}(r)),re.resolve()}getNamedQuery(e,r){return re.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(i){return{name:i.name,query:R3(i.bundledQuery),readTime:Qn(i.readTime)}}(r)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M3{constructor(){this.overlays=new vt(Ae.comparator),this.Ir=new Map}getOverlay(e,r){return re.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Us();return re.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),re.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),re.resolve()}getOverlaysForCollection(e,r,n){const i=Us(),s=r.length+1,a=new Ae(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return re.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new vt((l,f)=>l-f);const a=this.overlays.getIterator();for(;a.hasNext();){const l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let f=s.get(l.largestBatchId);f===null&&(f=Us(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const o=Us(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>o.set(l,f)),!(o.size()>=i)););return re.resolve(o)}ht(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new s3(r,n));let s=this.Ir.get(r);s===void 0&&(s=Be(),this.Ir.set(r,s)),this.Ir.set(r,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(){this.sessionToken=nr.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(){this.Tr=new Zt(Ut.Er),this.dr=new Zt(Ut.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Ut(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Ut(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Ae(new ct([])),n=new Ut(r,e),i=new Ut(r,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Ae(new ct([])),n=new Ut(r,e),i=new Ut(r,e+1);let s=Be();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const r=new Ut(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Ut{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Ae.comparator(e.key,r.key)||qe(e.wr,r.wr)}static Ar(e,r){return qe(e.wr,r.wr)||Ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Zt(Ut.Er)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new i3(s,r,n,i);this.mutationQueue.push(a);for(const o of i)this.br=this.br.add(new Ut(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return re.resolve(a)}lookupMutationBatch(e,r){return re.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.vr(n),s=i<0?0:i;return re.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Ut(r,0),i=new Ut(r,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{const o=this.Dr(a.wr);s.push(o)}),re.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Zt(qe);return r.forEach(i=>{const s=new Ut(i,0),a=new Ut(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],o=>{n=n.add(o.wr)})}),re.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let s=n;Ae.isDocumentKey(s)||(s=s.child(""));const a=new Ut(new Ae(s),0);let o=new Zt(qe);return this.br.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.wr)),!0)},a),re.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const i=this.Dr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Je(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return re.forEach(r.mutations,i=>{const s=new Ut(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Ut(r,0),i=this.br.firstAfterOrEqual(n);return re.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B3{constructor(e){this.Mr=e,this.docs=function(){return new vt(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return re.resolve(n?n.document.mutableCopy():dr.newInvalidDocument(r))}getEntries(e,r){let n=Ii();return r.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():dr.newInvalidDocument(i))}),re.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Ii();const a=r.path,o=new Ae(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||wF(EF(f),n)<=0||(i.has(f.key)||P0(r,f))&&(s=s.insert(f.key,f.mutableCopy()))}return re.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Re()}Or(e,r){return re.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new U3(this)}getSize(e){return re.resolve(this.size)}}class U3 extends D3{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),re.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e){this.persistence=e,this.Nr=new Oo(r=>Um(r),zm),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Km,this.targetCount=0,this.kr=wo.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,i)=>r(i)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),re.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new wo(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,re.resolve()}updateTargetData(e,r){return this.Kn(r),re.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,r,n){let i=0;const s=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),re.waitFor(s).next(()=>i)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return re.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),re.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),re.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),re.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return re.resolve(n)}containsKey(e,r){return re.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Mm(0),this.Kr=!1,this.Kr=!0,this.$r=new b3,this.referenceDelegate=e(this),this.Ur=new z3(this),this.indexManager=new P3,this.remoteDocumentCache=function(i){return new B3(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new C3(r),this.Gr=new L3(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new M3,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new V3(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){ke("MemoryPersistence","Starting transaction:",e);const i=new W3(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,r){return re.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class W3 extends kF{constructor(e){super(),this.currentSequenceNumber=e}}class qm{constructor(e){this.persistence=e,this.Jr=new Km,this.Yr=null}static Zr(e){return new qm(e)}get Xr(){if(this.Yr)return this.Yr;throw Re()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),re.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),re.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(i=>this.Xr.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Xr,n=>{const i=Ae.fromPath(n);return this.ei(e,i).next(s=>{s||r.removeEntry(i,Pe.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return re.or([()=>re.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=i}static Wi(e,r){let n=Be(),i=Be();for(const s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Xm(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j3{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return LC()?8:AF(_r())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,i){const s={result:null};return this.Yi(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new $3;return this.Xi(e,r,a).next(o=>{if(s.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>s.result)}es(e,r,n,i){return n.documentReadCount<this.ji?(ic()<=Ue.DEBUG&&ke("QueryEngine","SDK will not create cache indexes for query:",Da(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),re.resolve()):(ic()<=Ue.DEBUG&&ke("QueryEngine","Query:",Da(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(ic()<=Ue.DEBUG&&ke("QueryEngine","The SDK decides to create cache indexes for query:",Da(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yn(r))):re.resolve())}Yi(e,r){if(y_(r))return re.resolve(null);let n=Yn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=cp(r,null,"F"),n=Yn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=Be(...s);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ts(r,o);return this.ns(r,l,a,c.readTime)?this.Yi(e,cp(r,null,"F")):this.rs(e,l,r,c)}))})))}Zi(e,r,n,i){return y_(r)||i.isEqual(Pe.min())?re.resolve(null):this.Ji.getDocuments(e,n).next(s=>{const a=this.ts(r,s);return this.ns(r,a,n,i)?re.resolve(null):(ic()<=Ue.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Da(r)),this.rs(e,a,r,yF(i,-1)).next(o=>o))})}ts(e,r){let n=new Zt(PT(e));return r.forEach((i,s)=>{P0(e,s)&&(n=n.add(s))}),n}ns(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,r,n){return ic()<=Ue.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",Da(r)),this.Ji.getDocumentsMatchingQuery(e,r,ms.min(),n)}rs(e,r,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e,r,n,i){this.persistence=e,this.ss=r,this.serializer=i,this.os=new vt(qe),this._s=new Oo(s=>Um(s),zm),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new O3(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function K3(t,e,r,n){return new G3(t,e,r,n)}async function QT(t,e){const r=De(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=Be();for(const l of i){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of s){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return r.localDocuments.getDocuments(n,c).next(l=>({hs:l,removedBatchIds:a,addedBatchIds:o}))})})}function q3(t,e){const r=De(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,c,l,f){const h=l.batch,d=h.keys();let m=re.resolve();return d.forEach(v=>{m=m.next(()=>f.getEntry(c,v)).next(g=>{const E=l.docVersions.get(v);Je(E!==null),g.version.compareTo(E)<0&&(h.applyToRemoteDocument(g,l),g.isValidDocument()&&(g.setReadTime(l.commitVersion),f.addEntry(g)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Be();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function JT(t){const e=De(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function X3(t,e){const r=De(t),n=e.snapshotVersion;let i=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});i=r.os;const o=[];e.targetChanges.forEach((f,h)=>{const d=i.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(s,f.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(s,f.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(nr.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,n)),i=i.insert(h,m),function(g,E,w){return g.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(d,m,f)&&o.push(r.Ur.updateTargetData(s,m))});let c=Ii(),l=Be();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(Y3(s,a,e.documentUpdates).next(f=>{c=f.Ps,l=f.Is})),!n.isEqual(Pe.min())){const f=r.Ur.getLastRemoteSnapshotVersion(s).next(h=>r.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return re.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(r.os=i,s))}function Y3(t,e,r){let n=Be(),i=Be();return r.forEach(s=>n=n.add(s)),e.getEntries(t,n).next(s=>{let a=Ii();return r.forEach((o,c)=>{const l=s.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(Pe.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):ke("LocalStore","Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function Q3(t,e){const r=De(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function J3(t,e){const r=De(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Ur.getTargetData(n,e).next(s=>s?(i=s,re.resolve(i)):r.Ur.allocateTargetId(n).next(a=>(i=new Yi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function dp(t,e,r){const n=De(t),i=n.os.get(e),s=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!Ol(a))throw a;ke("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)}function F_(t,e,r){const n=De(t);let i=Pe.min(),s=Be();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,l,f){const h=De(c),d=h._s.get(f);return d!==void 0?re.resolve(h.os.get(d)):h.Ur.getTargetData(l,f)}(n,a,Yn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?i:Pe.min(),r?s:Be())).next(o=>(Z3(n,WF(e),o),{documents:o,Ts:s})))}function Z3(t,e,r){let n=t.us.get(e)||Pe.min();r.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),t.us.set(e,n)}class D_{constructor(){this.activeTargetIds=XF()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eD{constructor(){this.so=new D_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new D_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ke("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ke("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pu=null;function Bh(){return Pu===null?Pu=function(){return 268435456+Math.round(2147483648*Math.random())}():Pu++,"0x"+Pu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr="WebChannelConnection";class iD extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(r,n,i,s,a){const o=Bh(),c=this.xo(r,n.toUriEncodedString());ke("RestConnection",`Sending RPC '${r}' ${o}:`,c,i);const l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,a),this.No(r,c,l,i).then(f=>(ke("RestConnection",`Received RPC '${r}' ${o}: `,f),f),f=>{throw _o("RestConnection",`RPC '${r}' ${o} failed with error: `,f,"url: ",c,"request:",i),f})}Lo(r,n,i,s,a,o){return this.Mo(r,n,i,s,a)}Oo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+No}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}xo(r,n){const i=rD[r];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,i){const s=Bh();return new Promise((a,o)=>{const c=new hT;c.setWithCredentials(!0),c.listenOnce(dT.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case rf.NO_ERROR:const f=c.getResponseJson();ke(cr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case rf.TIMEOUT:ke(cr,`RPC '${e}' ${s} timed out`),o(new Te(te.DEADLINE_EXCEEDED,"Request time out"));break;case rf.HTTP_ERROR:const h=c.getStatus();if(ke(cr,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const v=function(E){const w=E.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(w)>=0?w:te.UNKNOWN}(m.status);o(new Te(v,m.message))}else o(new Te(te.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Te(te.UNAVAILABLE,"Connection failed."));break;default:Re()}}finally{ke(cr,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);ke(cr,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",l,n,15)})}Bo(e,r,n){const i=Bh(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=gT(),o=mT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const f=s.join("");ke(cr,`Creating RPC '${e}' stream ${i}: ${f}`,c);const h=a.createWebChannel(f,c);let d=!1,m=!1;const v=new nD({Io:E=>{m?ke(cr,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(d||(ke(cr,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),ke(cr,`RPC '${e}' stream ${i} sending:`,E),h.send(E))},To:()=>h.close()}),g=(E,w,T)=>{E.listen(w,_=>{try{T(_)}catch(N){setTimeout(()=>{throw N},0)}})};return g(h,fc.EventType.OPEN,()=>{m||(ke(cr,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),g(h,fc.EventType.CLOSE,()=>{m||(m=!0,ke(cr,`RPC '${e}' stream ${i} transport closed`),v.So())}),g(h,fc.EventType.ERROR,E=>{m||(m=!0,_o(cr,`RPC '${e}' stream ${i} transport errored:`,E),v.So(new Te(te.UNAVAILABLE,"The operation could not be completed")))}),g(h,fc.EventType.MESSAGE,E=>{var w;if(!m){const T=E.data[0];Je(!!T);const _=T,N=_.error||((w=_[0])===null||w===void 0?void 0:w.error);if(N){ke(cr,`RPC '${e}' stream ${i} received error:`,N);const z=N.status;let B=function(A){const I=Rt[A];if(I!==void 0)return zT(I)}(z),y=N.message;B===void 0&&(B=te.INTERNAL,y="Unknown error status: "+z+" with message "+N.message),m=!0,v.So(new Te(B,y)),h.close()}else ke(cr,`RPC '${e}' stream ${i} received:`,T),v.bo(T)}}),g(o,pT.STAT_EVENT,E=>{E.stat===rp.PROXY?ke(cr,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===rp.NOPROXY&&ke(cr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function Uh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(t){return new p3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,r-n);i>0&&ke("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,r,n,i,s,a,o,c){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ZT(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===te.RESOURCE_EXHAUSTED?(Si(r.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===r&&this.P_(n,i)},n=>{e(()=>{const i=new Te(te.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ke("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(ke("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sD extends e2{constructor(e,r,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=v3(this.serializer,e),n=function(s){if(!("targetChange"in s))return Pe.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Pe.min():a.readTime?Qn(a.readTime):Pe.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=hp(this.serializer),r.addTarget=function(s,a){let o;const c=a.target;if(o=ap(c)?{documents:y3(s,c)}:{query:E3(s,c)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=$T(s,a.resumeToken);const l=lp(s,a.expectedCount);l!==null&&(o.expectedCount=l)}else if(a.snapshotVersion.compareTo(Pe.min())>0){o.readTime=$f(s,a.snapshotVersion.toTimestamp());const l=lp(s,a.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=T3(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=hp(this.serializer),r.removeTarget=e,this.a_(r)}}class aD extends e2{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Je(!!e.streamToken),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Je(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=x3(e.writeResults,e.commitTime),n=Qn(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=hp(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>_3(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new Te(te.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,up(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(te.UNKNOWN,s.toString())})}Lo(e,r,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,up(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Te(te.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class cD{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Si(r),this.D_=!1):ke("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(async()=>{ma(this)&&(ke("RemoteStore","Restarting streams for network reachability change."),await async function(c){const l=De(c);l.L_.add(4),await Vl(l),l.q_.set("Unknown"),l.L_.delete(4),await M0(l)}(this))})}),this.q_=new cD(n,i)}}async function M0(t){if(ma(t))for(const e of t.B_)await e(!0)}async function Vl(t){for(const e of t.B_)await e(!1)}function t2(t,e){const r=De(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Zm(r)?Jm(r):Lo(r).r_()&&Qm(r,e))}function Ym(t,e){const r=De(t),n=Lo(r);r.N_.delete(e),n.r_()&&r2(r,e),r.N_.size===0&&(n.r_()?n.o_():ma(r)&&r.q_.set("Unknown"))}function Qm(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Lo(t).A_(e)}function r2(t,e){t.Q_.xe(e),Lo(t).R_(e)}function Jm(t){t.Q_=new u3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Lo(t).start(),t.q_.v_()}function Zm(t){return ma(t)&&!Lo(t).n_()&&t.N_.size>0}function ma(t){return De(t).L_.size===0}function n2(t){t.Q_=void 0}async function uD(t){t.q_.set("Online")}async function fD(t){t.N_.forEach((e,r)=>{Qm(t,e)})}async function hD(t,e){n2(t),Zm(t)?(t.q_.M_(e),Jm(t)):t.q_.set("Unknown")}async function dD(t,e,r){if(t.q_.set("Online"),e instanceof WT&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.N_.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.N_.delete(o),i.Q_.removeTarget(o))}(t,e)}catch(n){ke("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await jf(t,n)}else if(e instanceof af?t.Q_.Ke(e):e instanceof HT?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Pe.min()))try{const n=await JT(t.localStore);r.compareTo(n)>=0&&await function(s,a){const o=s.Q_.rt(a);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.N_.get(l);f&&s.N_.set(l,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,l)=>{const f=s.N_.get(c);if(!f)return;s.N_.set(c,f.withResumeToken(nr.EMPTY_BYTE_STRING,f.snapshotVersion)),r2(s,c);const h=new Yi(f.target,c,l,f.sequenceNumber);Qm(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){ke("RemoteStore","Failed to raise snapshot:",n),await jf(t,n)}}async function jf(t,e,r){if(!Ol(e))throw e;t.L_.add(1),await Vl(t),t.q_.set("Offline"),r||(r=()=>JT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ke("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await M0(t)})}function i2(t,e){return e().catch(r=>jf(t,r,e))}async function b0(t){const e=De(t),r=vs(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pD(e);)try{const i=await Q3(e.localStore,n);if(i===null){e.O_.length===0&&r.o_();break}n=i.batchId,mD(e,i)}catch(i){await jf(e,i)}s2(e)&&a2(e)}function pD(t){return ma(t)&&t.O_.length<10}function mD(t,e){t.O_.push(e);const r=vs(t);r.r_()&&r.V_&&r.m_(e.mutations)}function s2(t){return ma(t)&&!vs(t).n_()&&t.O_.length>0}function a2(t){vs(t).start()}async function gD(t){vs(t).p_()}async function vD(t){const e=vs(t);for(const r of t.O_)e.m_(r.mutations)}async function _D(t,e,r){const n=t.O_.shift(),i=$m.from(n,e,r);await i2(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await b0(t)}async function xD(t,e){e&&vs(t).V_&&await async function(n,i){if(function(a){return o3(a)&&a!==te.ABORTED}(i.code)){const s=n.O_.shift();vs(n).s_(),await i2(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await b0(n)}}(t,e),s2(t)&&a2(t)}async function O_(t,e){const r=De(t);r.asyncQueue.verifyOperationInProgress(),ke("RemoteStore","RemoteStore received new credentials");const n=ma(r);r.L_.add(3),await Vl(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await M0(r)}async function yD(t,e){const r=De(t);e?(r.L_.delete(2),await M0(r)):e||(r.L_.add(2),await Vl(r),r.q_.set("Unknown"))}function Lo(t){return t.K_||(t.K_=function(r,n,i){const s=De(r);return s.w_(),new sD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:uD.bind(null,t),Ro:fD.bind(null,t),mo:hD.bind(null,t),d_:dD.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Zm(t)?Jm(t):t.q_.set("Unknown")):(await t.K_.stop(),n2(t))})),t.K_}function vs(t){return t.U_||(t.U_=function(r,n,i){const s=De(r);return s.w_(),new aD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:gD.bind(null,t),mo:xD.bind(null,t),f_:vD.bind(null,t),g_:_D.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await b0(t)):(await t.U_.stop(),t.O_.length>0&&(ke("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new us,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){const a=Date.now()+n,o=new eg(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tg(t,e){if(Si("AsyncQueue",`${e}: ${t}`),Ol(t))return new Te(te.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Ae.comparator(r.key,n.key):(r,n)=>Ae.comparator(r.key,n.key),this.keyedMap=hc(),this.sortedSet=new vt(this.comparator)}static emptySet(e){return new so(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof so)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new so;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(){this.W_=new vt(Ae.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Re():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class To{constructor(e,r,n,i,s,a,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,i,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new To(e,r,so.emptySet(r),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&R0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class wD{constructor(){this.queries=M_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const i=De(r),s=i.queries;i.queries=M_(),s.forEach((a,o)=>{for(const c of o.j_)c.onError(n)})})(this,new Te(te.ABORTED,"Firestore shutting down"))}}function M_(){return new Oo(t=>RT(t),R0)}async function o2(t,e){const r=De(t);let n=3;const i=e.query;let s=r.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new ED,n=e.J_()?0:1);try{switch(n){case 0:s.z_=await r.onListen(i,!0);break;case 1:s.z_=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(a){const o=tg(a,`Initialization of query '${Da(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,s),s.j_.push(e),e.Z_(r.onlineState),s.z_&&e.X_(s.z_)&&rg(r)}async function c2(t,e){const r=De(t),n=e.query;let i=3;const s=r.queries.get(n);if(s){const a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function TD(t,e){const r=De(t);let n=!1;for(const i of e){const s=i.query,a=r.queries.get(s);if(a){for(const o of a.j_)o.X_(i)&&(n=!0);a.z_=i}}n&&rg(r)}function kD(t,e,r){const n=De(t),i=n.queries.get(e);if(i)for(const s of i.j_)s.onError(r);n.queries.delete(e)}function rg(t){t.Y_.forEach(e=>{e.next()})}var pp,b_;(b_=pp||(pp={})).ea="default",b_.Cache="cache";class l2{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new To(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=To.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==pp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u2{constructor(e){this.key=e}}class f2{constructor(e){this.key=e}}class AD{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Be(),this.mutatedKeys=Be(),this.Aa=PT(e),this.Ra=new so(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new L_,i=r?r.Ra:this.Ra;let s=r?r.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,h)=>{const d=i.get(f),m=P0(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let E=!1;d&&m?d.data.isEqual(m.data)?v!==g&&(n.track({type:3,doc:m}),E=!0):this.ga(d,m)||(n.track({type:2,doc:m}),E=!0,(c&&this.Aa(m,c)>0||l&&this.Aa(m,l)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),E=!0):d&&!m&&(n.track({type:1,doc:d}),E=!0,(c||l)&&(o=!0)),E&&(m?(a=a.add(m),s=g?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{Ra:a,fa:n,ns:o,mutatedKeys:s}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((f,h)=>function(m,v){const g=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re()}};return g(m)-g(v)}(f.type,h.type)||this.Aa(f.doc,h.doc)),this.pa(n),i=i!=null&&i;const o=r&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,a.length!==0||l?{snapshot:new To(this.query,e.Ra,s,a,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new L_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Be(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new f2(n))}),this.da.forEach(n=>{e.has(n)||r.push(new u2(n))}),r}ba(e){this.Ta=e.Ts,this.da=Be();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return To.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class SD{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class ID{constructor(e){this.key=e,this.va=!1}}class CD{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Oo(o=>RT(o),R0),this.Ma=new Map,this.xa=new Set,this.Oa=new vt(Ae.comparator),this.Na=new Map,this.La=new Km,this.Ba={},this.ka=new Map,this.qa=wo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function RD(t,e,r=!0){const n=v2(t);let i;const s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await h2(n,e,r,!0),i}async function PD(t,e){const r=v2(t);await h2(r,e,!0,!1)}async function h2(t,e,r,n){const i=await J3(t.localStore,Yn(e)),s=i.targetId,a=t.sharedClientState.addLocalQueryTarget(s,r);let o;return n&&(o=await FD(t,e,s,a==="current",i.resumeToken)),t.isPrimaryClient&&r&&t2(t.remoteStore,i),o}async function FD(t,e,r,n,i){t.Ka=(h,d,m)=>async function(g,E,w,T){let _=E.view.ma(w);_.ns&&(_=await F_(g.localStore,E.query,!1).then(({documents:y})=>E.view.ma(y,_)));const N=T&&T.targetChanges.get(E.targetId),z=T&&T.targetMismatches.get(E.targetId)!=null,B=E.view.applyChanges(_,g.isPrimaryClient,N,z);return B_(g,E.targetId,B.wa),B.snapshot}(t,h,d,m);const s=await F_(t.localStore,e,!0),a=new AD(e,s.Ts),o=a.ma(s.documents),c=bl.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),l=a.applyChanges(o,t.isPrimaryClient,c);B_(t,r,l.wa);const f=new SD(e,r,a);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),l.snapshot}async function DD(t,e,r){const n=De(t),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!R0(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await dp(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Ym(n.remoteStore,i.targetId),mp(n,i.targetId)}).catch(Nl)):(mp(n,i.targetId),await dp(n.localStore,i.targetId,!0))}async function ND(t,e){const r=De(t),n=r.Fa.get(e),i=r.Ma.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Ym(r.remoteStore,n.targetId))}async function OD(t,e,r){const n=zD(t);try{const i=await function(a,o){const c=De(a),l=Vt.now(),f=o.reduce((m,v)=>m.add(v.key),Be());let h,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=Ii(),g=Be();return c.cs.getEntries(m,f).next(E=>{v=E,v.forEach((w,T)=>{T.isValidDocument()||(g=g.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,v)).next(E=>{h=E;const w=[];for(const T of o){const _=r3(T,h.get(T.key).overlayedDocument);_!=null&&w.push(new ks(T.key,_,ET(_.value.mapValue),Zr.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,w,o)}).next(E=>{d=E;const w=E.applyToLocalDocumentSet(h,g);return c.documentOverlayCache.saveOverlays(m,E.batchId,w)})}).then(()=>({batchId:d.batchId,changes:DT(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.Ba[a.currentUser.toKey()];l||(l=new vt(qe)),l=l.insert(o,c),a.Ba[a.currentUser.toKey()]=l}(n,i.batchId,r),await Bl(n,i.changes),await b0(n.remoteStore)}catch(i){const s=tg(i,"Failed to persist write");r.reject(s)}}async function d2(t,e){const r=De(t);try{const n=await X3(r.localStore,e);e.targetChanges.forEach((i,s)=>{const a=r.Na.get(s);a&&(Je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?Je(a.va):i.removedDocuments.size>0&&(Je(a.va),a.va=!1))}),await Bl(r,n,e)}catch(n){await Nl(n)}}function V_(t,e,r){const n=De(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Fa.forEach((s,a)=>{const o=a.view.Z_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=De(a);c.onlineState=o;let l=!1;c.queries.forEach((f,h)=>{for(const d of h.j_)d.Z_(o)&&(l=!0)}),l&&rg(c)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function LD(t,e,r){const n=De(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Na.get(e),s=i&&i.key;if(s){let a=new vt(Ae.comparator);a=a.insert(s,dr.newNoDocument(s,Pe.min()));const o=Be().add(s),c=new O0(Pe.min(),new Map,new vt(qe),a,o);await d2(n,c),n.Oa=n.Oa.remove(s),n.Na.delete(e),ng(n)}else await dp(n.localStore,e,!1).then(()=>mp(n,e,r)).catch(Nl)}async function MD(t,e){const r=De(t),n=e.batch.batchId;try{const i=await q3(r.localStore,e);m2(r,n,null),p2(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Bl(r,i)}catch(i){await Nl(i)}}async function bD(t,e,r){const n=De(t);try{const i=await function(a,o){const c=De(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(Je(h!==null),f=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(n.localStore,e);m2(n,e,r),p2(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Bl(n,i)}catch(i){await Nl(i)}}function p2(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function m2(t,e,r){const n=De(t);let i=n.Ba[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function mp(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||g2(t,n)})}function g2(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Ym(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),ng(t))}function B_(t,e,r){for(const n of r)n instanceof u2?(t.La.addReference(n.key,e),VD(t,n)):n instanceof f2?(ke("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||g2(t,n.key)):Re()}function VD(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(ke("SyncEngine","New document in limbo: "+r),t.xa.add(n),ng(t))}function ng(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Ae(ct.fromString(e)),n=t.qa.next();t.Na.set(n,new ID(r)),t.Oa=t.Oa.insert(r,n),t2(t.remoteStore,new Yi(Yn(Hm(r.path)),n,"TargetPurposeLimboResolution",Mm.oe))}}async function Bl(t,e,r){const n=De(t),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,c)=>{a.push(n.Ka(c,e,r).then(l=>{var f;if((l||r)&&n.isPrimaryClient){const h=l?!l.fromCache:(f=r==null?void 0:r.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(l){i.push(l);const h=Xm.Wi(c.targetId,l);s.push(h)}}))}),await Promise.all(a),n.Ca.d_(i),await async function(c,l){const f=De(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>re.forEach(l,d=>re.forEach(d.$i,m=>f.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>re.forEach(d.Ui,m=>f.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!Ol(h))throw h;ke("LocalStore","Failed to update sequence numbers: "+h)}for(const h of l){const d=h.targetId;if(!h.fromCache){const m=f.os.get(d),v=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(v);f.os=f.os.insert(d,g)}}}(n.localStore,s))}async function BD(t,e){const r=De(t);if(!r.currentUser.isEqual(e)){ke("SyncEngine","User change. New user:",e.toKey());const n=await QT(r.localStore,e);r.currentUser=e,function(s,a){s.ka.forEach(o=>{o.forEach(c=>{c.reject(new Te(te.CANCELLED,a))})}),s.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Bl(r,n.hs)}}function UD(t,e){const r=De(t),n=r.Na.get(e);if(n&&n.va)return Be().add(n.key);{let i=Be();const s=r.Ma.get(e);if(!s)return i;for(const a of s){const o=r.Fa.get(a);i=i.unionWith(o.view.Va)}return i}}function v2(t){const e=De(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=d2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=UD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LD.bind(null,e),e.Ca.d_=TD.bind(null,e.eventManager),e.Ca.$a=kD.bind(null,e.eventManager),e}function zD(t){const e=De(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bD.bind(null,e),e}class Gf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=L0(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return K3(this.persistence,new j3,e.initialUser,this.serializer)}Ga(e){return new H3(qm.Zr,this.serializer)}Wa(e){return new eD}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Gf.provider={build:()=>new Gf};class gp{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>V_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=BD.bind(null,this.syncEngine),await yD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wD}()}createDatastore(e){const r=L0(e.databaseInfo.databaseId),n=function(s){return new iD(s)}(e.databaseInfo);return function(s,a,o,c){return new oD(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new lD(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>V_(this.syncEngine,r,0),function(){return N_.D()?new N_:new tD}())}createSyncEngine(e,r){return function(i,s,a,o,c,l,f){const h=new CD(i,s,a,o,c,l);return f&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const s=De(i);ke("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Vl(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}gp.provider={build:()=>new gp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Si("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,r,n,i,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ur.UNAUTHENTICATED,this.clientId=_T.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{ke("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(ke("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new us;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=tg(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function zh(t,e){t.asyncQueue.verifyOperationInProgress(),ke("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await QT(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function U_(t,e){t.asyncQueue.verifyOperationInProgress();const r=await WD(t);ke("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>O_(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>O_(e.remoteStore,i)),t._onlineComponents=e}async function WD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ke("FirestoreClient","Using user provided OfflineComponentProvider");try{await zh(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===te.FAILED_PRECONDITION||i.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;_o("Error using user provided cache. Falling back to memory cache: "+r),await zh(t,new Gf)}}else ke("FirestoreClient","Using default OfflineComponentProvider"),await zh(t,new Gf);return t._offlineComponents}async function x2(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ke("FirestoreClient","Using user provided OnlineComponentProvider"),await U_(t,t._uninitializedComponentsProvider._online)):(ke("FirestoreClient","Using default OnlineComponentProvider"),await U_(t,new gp))),t._onlineComponents}function $D(t){return x2(t).then(e=>e.syncEngine)}async function vp(t){const e=await x2(t),r=e.eventManager;return r.onListen=RD.bind(null,e.syncEngine),r.onUnlisten=DD.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=PD.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=ND.bind(null,e.syncEngine),r}function jD(t,e,r={}){const n=new us;return t.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,l){const f=new _2({next:d=>{f.Za(),a.enqueueAndForget(()=>c2(s,h)),d.fromCache&&c.source==="server"?l.reject(new Te(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(d)},error:d=>l.reject(d)}),h=new l2(o,f,{includeMetadataChanges:!0,_a:!0});return o2(s,h)}(await vp(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(t,e,r){if(!r)throw new Te(te.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function GD(t,e,r,n){if(e===!0&&n===!0)throw new Te(te.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function H_(t){if(!Ae.isDocumentKey(t))throw new Te(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function W_(t){if(Ae.isDocumentKey(t))throw new Te(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function V0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Re()}function Jn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=V0(t);throw new Te(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Te(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Te(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=y2((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Te(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class B0{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $_(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new fF;switch(n.type){case"firstParty":return new mF(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Te(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=z_.get(r);n&&(ke("ComponentProvider","Removing Datastore"),z_.delete(r),n.terminate())}(this),Promise.resolve()}}function KD(t,e,r,n={}){var i;const s=(t=Jn(t,B0))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&_o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=ur.MOCK_USER;else{o=RC(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ur(l)}t._authCredentials=new hF(new vT(o,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ga(this.firestore,e,this._query)}}class Ur{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ur(this.firestore,e,this._key)}}class fs extends ga{constructor(e,r,n){super(e,r,Hm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ur(this.firestore,null,new Ae(e))}withConverter(e){return new fs(this.firestore,e,this._path)}}function MB(t,e,...r){if(t=Tt(t),E2("collection","path",e),t instanceof B0){const n=ct.fromString(e,...r);return W_(n),new fs(t,null,n)}{if(!(t instanceof Ur||t instanceof fs))throw new Te(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ct.fromString(e,...r));return W_(n),new fs(t.firestore,null,n)}}function bB(t,e,...r){if(t=Tt(t),arguments.length===1&&(e=_T.newId()),E2("doc","path",e),t instanceof B0){const n=ct.fromString(e,...r);return H_(n),new Ur(t,null,new Ae(n))}{if(!(t instanceof Ur||t instanceof fs))throw new Te(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(ct.fromString(e,...r));return H_(n),new Ur(t.firestore,t instanceof fs?t.converter:null,new Ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ZT(this,"async_queue_retry"),this.Vu=()=>{const n=Uh();n&&ke("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Uh();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Uh();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new us;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ol(e))throw e;ke("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Si("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const i=eg.createAndSchedule(this,e,r,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function G_(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const i=r;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class na extends B0{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new j_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new j_(e),this._firestoreClient=void 0,await e}}}function VB(t,e){const r=typeof t=="object"?t:Am(),n=typeof t=="string"?t:e||"(default)",i=ha(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=IC("firestore");s&&KD(i,...s)}return i}function U0(t){if(t._terminated)throw new Te(te.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||qD(t),t._firestoreClient}function qD(t){var e,r,n;const i=t._freezeSettings(),s=function(o,c,l,f){return new CF(o,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,y2(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new HD(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ko(nr.fromBase64String(e))}catch(r){throw new Te(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ko(nr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Te(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sg{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Te(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Te(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qe(this._lat,e._lat)||qe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=/^__.*__$/;class YD{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ks(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ml(e,this.data,r,this.fieldTransforms)}}class w2{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ks(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function T2(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re()}}class og{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new og(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Kf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(T2(this.Cu)&&XD.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class QD{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||L0(e)}Qu(e,r,n,i=!1){return new og({Cu:e,methodName:r,qu:n,path:Qt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cg(t){const e=t._freezeSettings(),r=L0(t._databaseId);return new QD(t._databaseId,!!e.ignoreUndefinedProperties,r)}function k2(t,e,r,n,i,s={}){const a=t.Qu(s.merge||s.mergeFields?2:0,e,r,i);lg("Data must be an object, but it was:",a,n);const o=A2(n,a);let c,l;if(s.merge)c=new Qr(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const h of s.mergeFields){const d=_p(e,h,r);if(!a.contains(d))throw new Te(te.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);I2(f,d)||f.push(d)}c=new Qr(f),l=a.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=a.fieldTransforms;return new YD(new Lr(o),c,l)}class H0 extends ig{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof H0}}function JD(t,e,r,n){const i=t.Qu(1,e,r);lg("Data must be an object, but it was:",i,n);const s=[],a=Lr.empty();pa(n,(c,l)=>{const f=ug(e,c,r);l=Tt(l);const h=i.Nu(f);if(l instanceof H0)s.push(f);else{const d=Ul(l,h);d!=null&&(s.push(f),a.set(f,d))}});const o=new Qr(s);return new w2(a,o,i.fieldTransforms)}function ZD(t,e,r,n,i,s){const a=t.Qu(1,e,r),o=[_p(e,n,r)],c=[i];if(s.length%2!=0)throw new Te(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)o.push(_p(e,s[d])),c.push(s[d+1]);const l=[],f=Lr.empty();for(let d=o.length-1;d>=0;--d)if(!I2(l,o[d])){const m=o[d];let v=c[d];v=Tt(v);const g=a.Nu(m);if(v instanceof H0)l.push(m);else{const E=Ul(v,g);E!=null&&(l.push(m),f.set(m,E))}}const h=new Qr(l);return new w2(f,h,a.fieldTransforms)}function eN(t,e,r,n=!1){return Ul(r,t.Qu(n?4:3,e))}function Ul(t,e){if(S2(t=Tt(t)))return lg("Unsupported field value:",e,t),A2(t,e);if(t instanceof ig)return function(n,i){if(!T2(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=Ul(o,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=Tt(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return YF(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Vt.fromDate(n);return{timestampValue:$f(i.serializer,s)}}if(n instanceof Vt){const s=new Vt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$f(i.serializer,s)}}if(n instanceof sg)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ko)return{bytesValue:$T(i.serializer,n._byteString)};if(n instanceof Ur){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Gm(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ag)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.Bu("VectorValues must only contain numeric values.");return Wm(o.serializer,c)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${V0(n)}`)}(t,e)}function A2(t,e){const r={};return xT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pa(t,(n,i)=>{const s=Ul(i,e.Mu(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function S2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Vt||t instanceof sg||t instanceof ko||t instanceof Ur||t instanceof ig||t instanceof ag)}function lg(t,e,r){if(!S2(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){const n=V0(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function _p(t,e,r){if((e=Tt(e))instanceof z0)return e._internalPath;if(typeof e=="string")return ug(t,e);throw Kf("Field path arguments must be of type string or ",t,!1,void 0,r)}const tN=new RegExp("[~\\*/\\[\\]]");function ug(t,e,r){if(e.search(tN)>=0)throw Kf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new z0(...e.split("."))._internalPath}catch{throw Kf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Kf(t,e,r,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Te(te.INVALID_ARGUMENT,o+t+c)}function I2(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,r,n,i,s){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ur(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new rN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(fg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class rN extends C2{data(){return super.data()}}function fg(t,e){return typeof e=="string"?ug(t,e):e instanceof z0?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hg{}class nN extends hg{}function BB(t,e,...r){let n=[];e instanceof hg&&n.push(e),n=n.concat(r),function(s){const a=s.filter(c=>c instanceof dg).length,o=s.filter(c=>c instanceof W0).length;if(a>1||a>0&&o>0)throw new Te(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class W0 extends nN{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new W0(e,r,n)}_apply(e){const r=this._parse(e);return P2(e._query,r),new ga(e.firestore,e.converter,op(e._query,r))}_parse(e){const r=cg(e.firestore);return function(s,a,o,c,l,f,h){let d;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new Te(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){q_(h,f);const m=[];for(const v of h)m.push(K_(c,s,v));d={arrayValue:{values:m}}}else d=K_(c,s,h)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||q_(h,f),d=eN(o,a,h,f==="in"||f==="not-in");return Nt.create(l,f,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function UB(t,e,r){const n=e,i=fg("where",t);return W0._create(i,n,r)}class dg extends hg{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new dg(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Mn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const c of o)P2(a,c),a=op(a,c)}(e._query,r),new ga(e.firestore,e.converter,op(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function K_(t,e,r){if(typeof(r=Tt(r))=="string"){if(r==="")throw new Te(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!CT(e)&&r.indexOf("/")!==-1)throw new Te(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(ct.fromString(r));if(!Ae.isDocumentKey(n))throw new Te(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return p_(t,new Ae(n))}if(r instanceof Ur)return p_(t,r._key);throw new Te(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${V0(r)}.`)}function q_(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function P2(t,e){const r=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Te(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class iN{convertValue(e,r="none"){switch(ra(e)){case 0:return null;case 1:return e.booleanValue;case 2:return St(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ta(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Re()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return pa(e,(i,s)=>{n[i]=this.convertValue(s,r)}),n}convertVectorValue(e){var r,n,i;const s=(i=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>St(a.doubleValue));return new ag(s)}convertGeoPoint(e){return new sg(St(e.latitude),St(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Vm(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(fl(e));default:return null}}convertTimestamp(e){const r=gs(e);return new Vt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=ct.fromString(e);Je(YT(n));const i=new hl(n.get(1),n.get(3)),s=new Ae(n.popFirst(5));return i.isEqual(r)||Si(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class D2 extends C2{constructor(e,r,n,i,s,a){super(e,r,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new of(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(fg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class of extends D2{data(e={}){return super.data(e)}}class N2{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new pc(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new of(this._firestore,this._userDataWriter,n.key,n,new pc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Te(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const c=new of(i._firestore,i._userDataWriter,o.doc.key,o.doc,new pc(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new of(i._firestore,i._userDataWriter,o.doc.key,o.doc,new pc(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,f=-1;return o.type!==0&&(l=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:sN(o.type),doc:c,oldIndex:l,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function sN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re()}}class pg extends iN{constructor(e){super(),this.firestore=e}convertBytes(e){return new ko(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ur(this.firestore,null,r)}}function zB(t){t=Jn(t,ga);const e=Jn(t.firestore,na),r=U0(e),n=new pg(e);return R2(t._query),jD(r,t._query).then(i=>new N2(e,n,t,i))}function HB(t,e,r){t=Jn(t,Ur);const n=Jn(t.firestore,na),i=F2(t.converter,e,r);return mg(n,[k2(cg(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Zr.none())])}function WB(t){return mg(Jn(t.firestore,na),[new N0(t._key,Zr.none())])}function $B(t,...e){var r,n,i;t=Tt(t);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||G_(e[a])||(s=e[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(G_(e[a])){const h=e[a];e[a]=(r=h.next)===null||r===void 0?void 0:r.bind(h),e[a+1]=(n=h.error)===null||n===void 0?void 0:n.bind(h),e[a+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,l,f;if(t instanceof Ur)l=Jn(t.firestore,na),f=Hm(t._key.path),c={next:h=>{e[a]&&e[a](aN(l,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Jn(t,ga);l=Jn(h.firestore,na),f=h._query;const d=new pg(l);c={next:m=>{e[a]&&e[a](new N2(l,d,h,m))},error:e[a+1],complete:e[a+2]},R2(t._query)}return function(d,m,v,g){const E=new _2(g),w=new l2(m,E,v);return d.asyncQueue.enqueueAndForget(async()=>o2(await vp(d),w)),()=>{E.Za(),d.asyncQueue.enqueueAndForget(async()=>c2(await vp(d),w))}}(U0(l),f,o,c)}function mg(t,e){return function(n,i){const s=new us;return n.asyncQueue.enqueueAndForget(async()=>OD(await $D(n),i,s)),s.promise}(U0(t),e)}function aN(t,e,r){const n=r.docs.get(e._key),i=new pg(t);return new D2(t,i,e._key,n,new pc(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=cg(e)}set(e,r,n){this._verifyNotCommitted();const i=Hh(e,this._firestore),s=F2(i.converter,r,n),a=k2(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,Zr.none())),this}update(e,r,n,...i){this._verifyNotCommitted();const s=Hh(e,this._firestore);let a;return a=typeof(r=Tt(r))=="string"||r instanceof z0?ZD(this._dataReader,"WriteBatch.update",s._key,r,n,i):JD(this._dataReader,"WriteBatch.update",s._key,r),this._mutations.push(a.toMutation(s._key,Zr.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Hh(e,this._firestore);return this._mutations=this._mutations.concat(new N0(r._key,Zr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Te(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Hh(t,e){if((t=Tt(t)).firestore!==e)throw new Te(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(t){return U0(t=Jn(t,na)),new oN(t,e=>mg(t,e))}(function(e,r=!0){(function(i){No=i})(Po),Zn(new On("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new na(new dF(n.getProvider("auth-internal")),new vF(n.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Te(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hl(l.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),mn(l_,"4.7.3",e),mn(l_,"4.7.3","esm2017")})();const O2="@firebase/installations",gg="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=1e4,M2=`w:${gg}`,b2="FIS_v2",cN="https://firebaseinstallations.googleapis.com/v1",lN=60*60*1e3,uN="installations",fN="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ia=new fa(uN,fN,hN);function V2(t){return t instanceof bn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2({projectId:t}){return`${cN}/projects/${t}/installations`}function U2(t){return{token:t.token,requestStatus:2,expiresIn:pN(t.expiresIn),creationTime:Date.now()}}async function z2(t,e){const n=(await e.json()).error;return ia.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function H2({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function dN(t,{refreshToken:e}){const r=H2(t);return r.append("Authorization",mN(e)),r}async function W2(t){const e=await t();return e.status>=500&&e.status<600?t():e}function pN(t){return Number(t.replace("s","000"))}function mN(t){return`${b2} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gN({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=B2(t),i=H2(t),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={fid:r,authVersion:b2,appId:t.appId,sdkVersion:M2},o={method:"POST",headers:i,body:JSON.stringify(a)},c=await W2(()=>fetch(n,o));if(c.ok){const l=await c.json();return{fid:l.fid||r,registrationStatus:2,refreshToken:l.refreshToken,authToken:U2(l.authToken)}}else throw await z2("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $2(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=/^[cdef][\w-]{21}$/,xp="";function xN(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=yN(t);return _N.test(r)?r:xp}catch{return xp}}function yN(t){return vN(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2=new Map;function G2(t,e){const r=$0(t);K2(r,e),EN(r,e)}function K2(t,e){const r=j2.get(t);if(r)for(const n of r)n(e)}function EN(t,e){const r=wN();r&&r.postMessage({key:t,fid:e}),TN()}let zs=null;function wN(){return!zs&&"BroadcastChannel"in self&&(zs=new BroadcastChannel("[Firebase] FID Change"),zs.onmessage=t=>{K2(t.data.key,t.data.fid)}),zs}function TN(){j2.size===0&&zs&&(zs.close(),zs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN="firebase-installations-database",AN=1,sa="firebase-installations-store";let Wh=null;function vg(){return Wh||(Wh=Rw(kN,AN,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(sa)}}})),Wh}async function qf(t,e){const r=$0(t),i=(await vg()).transaction(sa,"readwrite"),s=i.objectStore(sa),a=await s.get(r);return await s.put(e,r),await i.done,(!a||a.fid!==e.fid)&&G2(t,e.fid),e}async function q2(t){const e=$0(t),n=(await vg()).transaction(sa,"readwrite");await n.objectStore(sa).delete(e),await n.done}async function j0(t,e){const r=$0(t),i=(await vg()).transaction(sa,"readwrite"),s=i.objectStore(sa),a=await s.get(r),o=e(a);return o===void 0?await s.delete(r):await s.put(o,r),await i.done,o&&(!a||a.fid!==o.fid)&&G2(t,o.fid),o}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _g(t){let e;const r=await j0(t.appConfig,n=>{const i=SN(n),s=IN(t,i);return e=s.registrationPromise,s.installationEntry});return r.fid===xp?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function SN(t){const e=t||{fid:xN(),registrationStatus:0};return X2(e)}function IN(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(ia.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=CN(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:RN(t)}:{installationEntry:e}}async function CN(t,e){try{const r=await gN(t,e);return qf(t.appConfig,r)}catch(r){throw V2(r)&&r.customData.serverCode===409?await q2(t.appConfig):await qf(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function RN(t){let e=await X_(t.appConfig);for(;e.registrationStatus===1;)await $2(100),e=await X_(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await _g(t);return n||r}return e}function X_(t){return j0(t,e=>{if(!e)throw ia.create("installation-not-found");return X2(e)})}function X2(t){return PN(t)?{fid:t.fid,registrationStatus:0}:t}function PN(t){return t.registrationStatus===1&&t.registrationTime+L2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN({appConfig:t,heartbeatServiceProvider:e},r){const n=DN(t,r),i=dN(t,r),s=e.getImmediate({optional:!0});if(s){const l=await s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={installation:{sdkVersion:M2,appId:t.appId}},o={method:"POST",headers:i,body:JSON.stringify(a)},c=await W2(()=>fetch(n,o));if(c.ok){const l=await c.json();return U2(l)}else throw await z2("Generate Auth Token",c)}function DN(t,{fid:e}){return`${B2(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xg(t,e=!1){let r;const n=await j0(t.appConfig,s=>{if(!Y2(s))throw ia.create("not-registered");const a=s.authToken;if(!e&&LN(a))return s;if(a.requestStatus===1)return r=NN(t,e),s;{if(!navigator.onLine)throw ia.create("app-offline");const o=bN(s);return r=ON(t,o),o}});return r?await r:n.authToken}async function NN(t,e){let r=await Y_(t.appConfig);for(;r.authToken.requestStatus===1;)await $2(100),r=await Y_(t.appConfig);const n=r.authToken;return n.requestStatus===0?xg(t,e):n}function Y_(t){return j0(t,e=>{if(!Y2(e))throw ia.create("not-registered");const r=e.authToken;return VN(r)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function ON(t,e){try{const r=await FN(t,e),n=Object.assign(Object.assign({},e),{authToken:r});return await qf(t.appConfig,n),r}catch(r){if(V2(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await q2(t.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await qf(t.appConfig,n)}throw r}}function Y2(t){return t!==void 0&&t.registrationStatus===2}function LN(t){return t.requestStatus===2&&!MN(t)}function MN(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+lN}function bN(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function VN(t){return t.requestStatus===1&&t.requestTime+L2<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BN(t){const e=t,{installationEntry:r,registrationPromise:n}=await _g(e);return n?n.catch(console.error):xg(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UN(t,e=!1){const r=t;return await zN(r),(await xg(r,e)).token}async function zN(t){const{registrationPromise:e}=await _g(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(t){if(!t||!t.options)throw $h("App Configuration");if(!t.name)throw $h("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw $h(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function $h(t){return ia.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2="installations",WN="installations-internal",$N=t=>{const e=t.getProvider("app").getImmediate(),r=HN(e),n=ha(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},jN=t=>{const e=t.getProvider("app").getImmediate(),r=ha(e,Q2).getImmediate();return{getId:()=>BN(r),getToken:i=>UN(r,i)}};function GN(){Zn(new On(Q2,$N,"PUBLIC")),Zn(new On(WN,jN,"PRIVATE"))}GN();mn(O2,gg);mn(O2,gg,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xf="analytics",KN="firebase_id",qN="origin",XN=60*1e3,YN="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yg="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr=new T0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},en=new fa("analytics","Analytics",QN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(t){if(!t.startsWith(yg)){const e=en.create("invalid-gtag-resource",{gtagURL:t});return zr.warn(e.message),""}return t}function J2(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function ZN(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function eO(t,e){const r=ZN("firebase-js-sdk-policy",{createScriptURL:JN}),n=document.createElement("script"),i=`${yg}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}function tO(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function rO(t,e,r,n,i,s){const a=n[i];try{if(a)await e[a];else{const c=(await J2(r)).find(l=>l.measurementId===i);c&&await e[c.appId]}}catch(o){zr.error(o)}t("config",i,s)}async function nO(t,e,r,n,i){try{let s=[];if(i&&i.send_to){let a=i.send_to;Array.isArray(a)||(a=[a]);const o=await J2(r);for(const c of a){const l=o.find(h=>h.measurementId===c),f=l&&e[l.appId];if(f)s.push(f);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",n,i||{})}catch(s){zr.error(s)}}function iO(t,e,r,n){async function i(s,...a){try{if(s==="event"){const[o,c]=a;await nO(t,e,r,o,c)}else if(s==="config"){const[o,c]=a;await rO(t,e,r,n,o,c)}else if(s==="consent"){const[o,c]=a;t("consent",o,c)}else if(s==="get"){const[o,c,l]=a;t("get",o,c,l)}else if(s==="set"){const[o]=a;t("set",o)}else t(s,...a)}catch(o){zr.error(o)}}return i}function sO(t,e,r,n,i){let s=function(...a){window[n].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=iO(s,t,e,r),{gtagCore:s,wrappedGtag:window[i]}}function aO(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(yg)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=30,cO=1e3;class lO{constructor(e={},r=cO){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Z2=new lO;function uO(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function fO(t){var e;const{appId:r,apiKey:n}=t,i={method:"GET",headers:uO(n)},s=YN.replace("{app-id}",r),a=await fetch(s,i);if(a.status!==200&&a.status!==304){let o="";try{const c=await a.json();!((e=c.error)===null||e===void 0)&&e.message&&(o=c.error.message)}catch{}throw en.create("config-fetch-failed",{httpStatus:a.status,responseMessage:o})}return a.json()}async function hO(t,e=Z2,r){const{appId:n,apiKey:i,measurementId:s}=t.options;if(!n)throw en.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw en.create("no-api-key")}const a=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new mO;return setTimeout(async()=>{o.abort()},r!==void 0?r:XN),ek({appId:n,apiKey:i,measurementId:s},a,o,e)}async function ek(t,{throttleEndTimeMillis:e,backoffCount:r},n,i=Z2){var s;const{appId:a,measurementId:o}=t;try{await dO(n,e)}catch(c){if(o)return zr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:a,measurementId:o};throw c}try{const c=await fO(t);return i.deleteThrottleMetadata(a),c}catch(c){const l=c;if(!pO(l)){if(i.deleteThrottleMetadata(a),o)return zr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:a,measurementId:o};throw c}const f=Number((s=l==null?void 0:l.customData)===null||s===void 0?void 0:s.httpStatus)===503?Nv(r,i.intervalMillis,oO):Nv(r,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return i.setThrottleMetadata(a,h),zr.debug(`Calling attemptFetch again in ${f} millis`),ek(t,h,n,i)}}function dO(t,e){return new Promise((r,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(r,i);t.addEventListener(()=>{clearTimeout(s),n(en.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function pO(t){if(!(t instanceof bn)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class mO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function gO(t,e,r,n,i){if(i&&i.global){t("event",r,n);return}else{const s=await e,a=Object.assign(Object.assign({},n),{send_to:s});t("event",r,a)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vO(){if(Aw())try{await Sw()}catch(t){return zr.warn(en.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return zr.warn(en.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function _O(t,e,r,n,i,s,a){var o;const c=hO(t);c.then(m=>{r[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&zr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>zr.error(m)),e.push(c);const l=vO().then(m=>{if(m)return n.getId()}),[f,h]=await Promise.all([c,l]);aO(s)||eO(s,f.measurementId),i("js",new Date);const d=(o=a==null?void 0:a.config)!==null&&o!==void 0?o:{};return d[qN]="firebase",d.update=!0,h!=null&&(d[KN]=h),i("config",f.measurementId,d),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e){this.app=e}_delete(){return delete Nc[this.app.options.appId],Promise.resolve()}}let Nc={},Q_=[];const J_={};let jh="dataLayer",yO="gtag",Z_,tk,ex=!1;function EO(){const t=[];if(kw()&&t.push("This is a browser extension environment."),MC()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,i)=>`(${i+1}) ${n}`).join(" "),r=en.create("invalid-analytics-context",{errorInfo:e});zr.warn(r.message)}}function wO(t,e,r){EO();const n=t.options.appId;if(!n)throw en.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)zr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw en.create("no-api-key");if(Nc[n]!=null)throw en.create("already-exists",{id:n});if(!ex){tO(jh);const{wrappedGtag:s,gtagCore:a}=sO(Nc,Q_,J_,jh,yO);tk=s,Z_=a,ex=!0}return Nc[n]=_O(t,Q_,J_,e,Z_,jh,r),new xO(t)}function GB(t=Am()){t=Tt(t);const e=ha(t,Xf);return e.isInitialized()?e.getImmediate():TO(t)}function TO(t,e={}){const r=ha(t,Xf);if(r.isInitialized()){const i=r.getImmediate();if(al(e,r.getOptions()))return i;throw en.create("already-initialized")}return r.initialize({options:e})}function kO(t,e,r,n){t=Tt(t),gO(tk,Nc[t.app.options.appId],e,r,n).catch(i=>zr.error(i))}const tx="@firebase/analytics",rx="0.10.8";function AO(){Zn(new On(Xf,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return wO(n,i,r)},"PUBLIC")),Zn(new On("analytics-internal",t,"PRIVATE")),mn(tx,rx),mn(tx,rx,"esm2017");function t(e){try{const r=e.getProvider(Xf).getImmediate();return{logEvent:(n,i,s)=>kO(r,n,i,s)}}catch(r){throw en.create("interop-component-reg-failed",{reason:r})}}}AO();/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rk=1252,SO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Eg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wg=function(t){SO.indexOf(t)!=-1&&(rk=Eg[0]=t)};function IO(){wg(1252)}var Cn=function(t){wg(t)};function nk(){Cn(1200),IO()}function nx(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function CO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function ik(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var mc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?CO(t.slice(2)):e==254&&r==255?ik(t.slice(2)):e==65279?t.slice(1):t},Fu=function(e){return String.fromCharCode(e)},ix=function(e){return String.fromCharCode(e)},Gi,Qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function sx(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),s=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,i=t.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Qi.charAt(s)+Qi.charAt(a)+Qi.charAt(o)+Qi.charAt(c);return e}function rn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)s=Qi.indexOf(t.charAt(l++)),a=Qi.indexOf(t.charAt(l++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Qi.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Qi.indexOf(t.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),va=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function _s(t){return ze?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ax(t){return ze?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var In=function(e){return ze?va(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function _a(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Tg(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Tg(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ki=ze?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:va(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function RO(t){for(var e=[],r=0,n=t.length+250,i=_s(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=_s(65535),n=65530)}return e.push(i.slice(0,r)),Ki(e)}var Cr=/\u0000/g,gc=/[\u0001-\u0006]/g;function ao(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Rn(t,e){var r=""+t;return r.length>=e?r:wt("0",e-r.length)+r}function kg(t,e){var r=""+t;return r.length>=e?r:wt(" ",e-r.length)+r}function Yf(t,e){var r=""+t;return r.length>=e?r:r+wt(" ",e-r.length)}function PO(t,e){var r=""+Math.round(t);return r.length>=e?r:wt("0",e-r.length)+r}function FO(t,e){var r=""+t;return r.length>=e?r:wt("0",e-r.length)+r}var ox=Math.pow(2,32);function Fa(t,e){if(t>ox||t<-ox)return PO(t,e);var r=Math.round(t);return FO(r,e)}function Qf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var cx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Gh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function DO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ne={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},lx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},NO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Jf(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,l=0,f=0,h=Math.floor(i);l<e&&(h=Math.floor(i),o=h*a+s,f=h*l+c,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,c=l,l=f;if(f>e&&(l>e?(f=c,o=s):(f=l,o=a)),!r)return[0,n*o,f];var d=Math.floor(n*o/f);return[d,n*o-d*f,f]}function Hs(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=BO(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var sk=new Date(1899,11,31,0,0,0),OO=sk.getTime(),LO=new Date(1900,2,1,0,0,0);function ak(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=LO&&(r+=24*60*60*1e3),(r-(OO+(t.getTimezoneOffset()-sk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ag(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function MO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function bO(t){var e=t<0?12:11,r=Ag(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function VO(t){var e=Ag(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function gl(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=bO(t):e===10?r=t.toFixed(10).substr(0,12):r=VO(t),Ag(MO(r.toUpperCase()))}function aa(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):gl(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return _n(14,ak(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function BO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function UO(t,e,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return Gh[r.m-1][1];case 5:return Gh[r.m-1][0];default:return Gh[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return cx[r.q][0];default:return cx[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Rn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Rn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var f=l>0?Rn(c,l):"";return f}function Ji(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var ok=/%/g;function zO(t,e,r){var n=e.replace(ok,""),i=e.length-n.length;return _i(t,n,r*Math.pow(10,2*i))+wt("%",i)}function HO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return _i(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ck(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ck(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lk=/# (\?+)( ?)\/( ?)(\d+)/;function WO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?wt(" ",t[1].length+1+t[4].length):kg(a,t[1].length)+t[2]+"/"+t[3]+Rn(o,t[4].length))}function $O(t,e,r){return r+(e===0?"":""+e)+wt(" ",t[1].length+2+t[4].length)}var uk=/^#*0*\.([0#]+)/,fk=/\).*[0#]/,hk=/\(###\) ###\\?-####/;function kr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function ux(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function fx(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function GO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ln(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ln("n",n,r):"("+ln("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return HO(t,e,r);if(e.indexOf("%")!==-1)return zO(t,e,r);if(e.indexOf("E")!==-1)return ck(e,r);if(e.charCodeAt(0)===36)return"$"+ln(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Fa(c,e.length);if(e.match(/^[#?]+$/))return i=Fa(r,0),i==="0"&&(i=""),i.length>e.length?i:kr(e.substr(0,e.length-i.length))+i;if(s=e.match(lk))return WO(s,c,l);if(e.match(/^#+0+$/))return l+Fa(c,e.length-e.indexOf("0"));if(s=e.match(uk))return i=ux(r,s[1].length).replace(/^([^\.]+)$/,"$1."+kr(s[1])).replace(/\.$/,"."+kr(s[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+wt("0",kr(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+ux(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+Ji(Fa(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ln(t,e,-r):Ji(""+(Math.floor(r)+jO(r,s[1].length)))+"."+Rn(fx(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ln(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ao(ln(t,e.replace(/[\\-]/g,""),r)),a=0,ao(ao(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(hk))return i=ln(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jf(c,Math.pow(10,a)-1,!1),i=""+l,f=_i("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Yf(o[2],a),f.length<s[4].length&&(f=kr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jf(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kg(o[1],a)+s[2]+"/"+s[3]+Yf(o[2],a):wt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Fa(r,0),e.length<=i.length?i:kr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return kr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=fx(r,s[1].length),r<0?"-"+ln(t,e,-r):Ji(GO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Rn(0,3-v.length):"")+v})+"."+Rn(a,s[1].length);switch(e){case"###,##0.00":return ln(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ji(Fa(c,0));return m!=="0"?l+m:"";case"###,###.00":return ln(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ln(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function KO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return _i(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function qO(t,e,r){var n=e.replace(ok,""),i=e.length-n.length;return _i(t,n,r*Math.pow(10,2*i))+wt("%",i)}function dk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dk(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,f){return c+l+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Wn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wn("n",n,r):"("+Wn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return KO(t,e,r);if(e.indexOf("%")!==-1)return qO(t,e,r);if(e.indexOf("E")!==-1)return dk(e,r);if(e.charCodeAt(0)===36)return"$"+Wn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Rn(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:kr(e.substr(0,e.length-i.length))+i;if(s=e.match(lk))return $O(s,c,l);if(e.match(/^#+0+$/))return l+Rn(c,e.length-e.indexOf("0"));if(s=e.match(uk))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kr(s[1])).replace(/\.$/,"."+kr(s[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+wt("0",kr(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+Ji(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wn(t,e,-r):Ji(""+r)+"."+wt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Wn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ao(Wn(t,e.replace(/[\\-]/g,""),r)),a=0,ao(ao(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(hk))return i=Wn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Jf(c,Math.pow(10,a)-1,!1),i=""+l,f=_i("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Yf(o[2],a),f.length<s[4].length&&(f=kr(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Jf(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?kg(o[1],a)+s[2]+"/"+s[3]+Yf(o[2],a):wt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:kr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=e.indexOf(".")-a,d=e.length-i.length-h;return kr(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Wn(t,e,-r):Ji(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Rn(0,3-v.length):"")+v})+"."+Rn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Ji(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return Wn(t,e.slice(0,e.lastIndexOf(".")),r)+kr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function _i(t,e,r){return(r|0)===r?Wn(t,e,r):ln(t,e,r)}function XO(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var pk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mo(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Qf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(pk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function YO(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",l,f,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Qf(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),v=m==="("||m===")"?m:"t";i[i.length]={t:v,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=Hs(e,r,t.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=Hs(e,r),l==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(l==null&&(l=Hs(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(g.v=l.H>=12?"P":"A"),g.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(g.v=l.H>=12?"PM":"AM"),g.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(l!=null&&(g.v=l.H>=12?"":""),g.t="T",a+=5,d="h"):(g.t="t",++a),l==null&&g.t==="T")return"";i[i.length]=g,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(pk)){if(l==null&&(l=Hs(e,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mo(t)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var E=0,w=0,T;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",E<1&&(E=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(w=Math.max(w,T[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var _="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=UO(i[a].t.charCodeAt(0),i[a].v,l,w),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;_+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=aa(e,r);break}var z="",B,y;if(_.length>0){_.charCodeAt(0)==40?(B=e<0&&_.charCodeAt(0)===45?-e:e,y=_i("n",_,B)):(B=e<0&&n>1?-e:e,y=_i("n",_,B),B<0&&i[0]&&i[0].t=="t"&&(y=y.substr(1),i[0].v="-"+i[0].v)),N=y.length-1;var k=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){k=a;break}var A=i.length;if(k===i.length&&y.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=y.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=y.substr(0,N+1),N=-1),i[a].t="t",A=a);N>=0&&A<i.length&&(i[A].v=y.substr(0,N+1)+i[A].v)}else if(k!==i.length&&y.indexOf("E")===-1){for(N=y.indexOf(".")-1,a=k;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")-1:i[a].v.length-1,z=i[a].v.substr(f+1);f>=0;--f)N>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(z=y.charAt(N--)+z);i[a].v=z,i[a].t="t",A=a}for(N>=0&&A<i.length&&(i[A].v=y.substr(0,N+1)+i[A].v),N=y.indexOf(".")+1,a=k;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==k)){for(f=i[a].v.indexOf(".")>-1&&a===k?i[a].v.indexOf(".")+1:0,z=i[a].v.substr(0,f);f<i[a].v.length;++f)N<y.length&&(z+=y.charAt(N++));i[a].v=z,i[a].t="t",A=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=_i(i[a].t,i[a].v,B),i[a].t="t");var I="";for(a=0;a!==i.length;++a)i[a]!=null&&(I+=i[a].v);return I}var hx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function dx(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function QO(t,e){var r=XO(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(hx),o=r[1].match(hx);return dx(e,a)?[n,r[0]]:dx(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function _n(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ne)[t],n==null&&(n=r.table&&r.table[lx[t]]||Ne[lx[t]]),n==null&&(n=NO[t]||"General");break}if(Qf(n,0))return aa(e,r);e instanceof Date&&(e=ak(e,r.date1904));var i=QO(n,e);if(Qf(i[1]))return aa(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return YO(i[1],e,r,i[0])}function Gs(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ne[r]==null){e<0&&(e=r);continue}if(Ne[r]==t){e=r;break}}e<0&&(e=391)}return Ne[e]=t,e}function mk(){Ne=DO()}var JO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZO(t){var e=typeof t=="number"?Ne[t]:t;return e=e.replace(gk,"(\\d+)"),new RegExp("^"+e+"$")}function e6(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(gk)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:i=m;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?f:l+"T"+f}var t6=function(){var t={};t.version="1.2.0";function e(){for(var y=0,k=new Array(256),A=0;A!=256;++A)y=A,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,k[A]=y;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(y){var k=0,A=0,I=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)R[I]=y[I];for(I=0;I!=256;++I)for(A=y[I],k=256+I;k<4096;k+=256)A=R[k]=A>>>8^y[A&255];var C=[];for(I=1;I!=16;++I)C[I-1]=typeof Int32Array<"u"?R.subarray(I*256,I*256+256):R.slice(I*256,I*256+256);return C}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],f=i[5],h=i[6],d=i[7],m=i[8],v=i[9],g=i[10],E=i[11],w=i[12],T=i[13],_=i[14];function N(y,k){for(var A=k^-1,I=0,R=y.length;I<R;)A=A>>>8^r[(A^y.charCodeAt(I++))&255];return~A}function z(y,k){for(var A=k^-1,I=y.length-15,R=0;R<I;)A=_[y[R++]^A&255]^T[y[R++]^A>>8&255]^w[y[R++]^A>>16&255]^E[y[R++]^A>>>24]^g[y[R++]]^v[y[R++]]^m[y[R++]]^d[y[R++]]^h[y[R++]]^f[y[R++]]^l[y[R++]]^c[y[R++]]^o[y[R++]]^a[y[R++]]^s[y[R++]]^r[y[R++]];for(I+=15;R<I;)A=A>>>8^r[(A^y[R++])&255];return~A}function B(y,k){for(var A=k^-1,I=0,R=y.length,C=0,F=0;I<R;)C=y.charCodeAt(I++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,F=y.charCodeAt(I++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|F>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|F&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return t.table=r,t.bstr=N,t.buf=z,t.str=B,t}(),We=function(){var e={};e.version="1.2.1";function r(S,L){for(var D=S.split("/"),O=L.split("/"),M=0,V=0,X=Math.min(D.length,O.length);M<X;++M){if(V=D[M].length-O[M].length)return V;if(D[M]!=O[M])return D[M]<O[M]?-1:1}return D.length-O.length}function n(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:n(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(0,L+1)}function i(S){if(S.charAt(S.length-1)=="/")return i(S.slice(0,-1));var L=S.lastIndexOf("/");return L===-1?S:S.slice(L+1)}function s(S,L){typeof L=="string"&&(L=new Date(L));var D=L.getHours();D=D<<6|L.getMinutes(),D=D<<5|L.getSeconds()>>>1,S.write_shift(2,D);var O=L.getFullYear()-1980;O=O<<4|L.getMonth()+1,O=O<<5|L.getDate(),S.write_shift(2,O)}function a(S){var L=S.read_shift(2)&65535,D=S.read_shift(2)&65535,O=new Date,M=D&31;D>>>=5;var V=D&15;D>>>=4,O.setMilliseconds(0),O.setFullYear(D+1980),O.setMonth(V-1),O.setDate(M);var X=L&31;L>>>=5;var Z=L&63;return L>>>=6,O.setHours(L),O.setMinutes(Z),O.setSeconds(X<<1),O}function o(S){Yt(S,0);for(var L={},D=0;S.l<=S.length-4;){var O=S.read_shift(2),M=S.read_shift(2),V=S.l+M,X={};switch(O){case 21589:D=S.read_shift(1),D&1&&(X.mtime=S.read_shift(4)),M>5&&(D&2&&(X.atime=S.read_shift(4)),D&4&&(X.ctime=S.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}S.l=V,L[O]=X}return L}var c;function l(){return c||(c={})}function f(S,L){if(S[0]==80&&S[1]==75)return zo(S,L);if((S[0]|32)==109&&(S[1]|32)==105)return Is(S,L);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var D=3,O=512,M=0,V=0,X=0,Z=0,q=0,Y=[],Q=S.slice(0,512);Yt(Q,0);var ne=h(Q);switch(D=ne[0],D){case 3:O=512;break;case 4:O=4096;break;case 0:if(ne[1]==0)return zo(S,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}O!==512&&(Q=S.slice(0,O),Yt(Q,28));var fe=S.slice(0,O);d(Q,D);var _e=Q.read_shift(4,"i");if(D===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);Q.l+=4,X=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),Z=Q.read_shift(4,"i"),M=Q.read_shift(4,"i"),q=Q.read_shift(4,"i"),V=Q.read_shift(4,"i");for(var oe=-1,ge=0;ge<109&&(oe=Q.read_shift(4,"i"),!(oe<0));++ge)Y[ge]=oe;var Se=m(S,O);E(q,V,Se,O,Y);var tt=T(Se,X,Y,O);tt[X].name="!Directory",M>0&&Z!==F&&(tt[Z].name="!MiniFAT"),tt[Y[0]].name="!FAT",tt.fat_addrs=Y,tt.ssz=O;var Ze={},xt=[],jr=[],si=[];_(X,tt,Se,xt,M,Ze,jr,Z),v(jr,si,xt),xt.shift();var Ps={FileIndex:jr,FullPaths:si};return L&&L.raw&&(Ps.raw={header:fe,sectors:Se}),Ps}function h(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(ve,"Header Signature: "),S.l+=16;var L=S.read_shift(2,"u");return[S.read_shift(2,"u"),L]}function d(S,L){var D=9;switch(S.l+=2,D=S.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function m(S,L){for(var D=Math.ceil(S.length/L)-1,O=[],M=1;M<D;++M)O[M-1]=S.slice(M*L,(M+1)*L);return O[D-1]=S.slice(D*L),O}function v(S,L,D){for(var O=0,M=0,V=0,X=0,Z=0,q=D.length,Y=[],Q=[];O<q;++O)Y[O]=Q[O]=O,L[O]=D[O];for(;Z<Q.length;++Z)O=Q[Z],M=S[O].L,V=S[O].R,X=S[O].C,Y[O]===O&&(M!==-1&&Y[M]!==M&&(Y[O]=Y[M]),V!==-1&&Y[V]!==V&&(Y[O]=Y[V])),X!==-1&&(Y[X]=O),M!==-1&&O!=Y[O]&&(Y[M]=Y[O],Q.lastIndexOf(M)<Z&&Q.push(M)),V!==-1&&O!=Y[O]&&(Y[V]=Y[O],Q.lastIndexOf(V)<Z&&Q.push(V));for(O=1;O<q;++O)Y[O]===O&&(V!==-1&&Y[V]!==V?Y[O]=Y[V]:M!==-1&&Y[M]!==M&&(Y[O]=Y[M]));for(O=1;O<q;++O)if(S[O].type!==0){if(Z=O,Z!=Y[Z])do Z=Y[Z],L[O]=L[Z]+"/"+L[O];while(Z!==0&&Y[Z]!==-1&&Z!=Y[Z]);Y[O]=-1}for(L[0]+="/",O=1;O<q;++O)S[O].type!==2&&(L[O]+="/")}function g(S,L,D){for(var O=S.start,M=S.size,V=[],X=O;D&&M>0&&X>=0;)V.push(L.slice(X*C,X*C+C)),M-=C,X=Ms(D,X*4);return V.length===0?Ot(0):Ki(V).slice(0,S.size)}function E(S,L,D,O,M){var V=F;if(S===F){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var X=D[S],Z=(O>>>2)-1;if(!X)return;for(var q=0;q<Z&&(V=Ms(X,q*4))!==F;++q)M.push(V);E(Ms(X,O-4),L-1,D,O,M)}}function w(S,L,D,O,M){var V=[],X=[];M||(M=[]);var Z=O-1,q=0,Y=0;for(q=L;q>=0;){M[q]=!0,V[V.length]=q,X.push(S[q]);var Q=D[Math.floor(q*4/O)];if(Y=q*4&Z,O<4+Y)throw new Error("FAT boundary crossed: "+q+" 4 "+O);if(!S[Q])break;q=Ms(S[Q],Y)}return{nodes:V,data:Tx([X])}}function T(S,L,D,O){var M=S.length,V=[],X=[],Z=[],q=[],Y=O-1,Q=0,ne=0,fe=0,_e=0;for(Q=0;Q<M;++Q)if(Z=[],fe=Q+L,fe>=M&&(fe-=M),!X[fe]){q=[];var oe=[];for(ne=fe;ne>=0;){oe[ne]=!0,X[ne]=!0,Z[Z.length]=ne,q.push(S[ne]);var ge=D[Math.floor(ne*4/O)];if(_e=ne*4&Y,O<4+_e)throw new Error("FAT boundary crossed: "+ne+" 4 "+O);if(!S[ge]||(ne=Ms(S[ge],_e),oe[ne]))break}V[fe]={nodes:Z,data:Tx([q])}}return V}function _(S,L,D,O,M,V,X,Z){for(var q=0,Y=O.length?2:0,Q=L[S].data,ne=0,fe=0,_e;ne<Q.length;ne+=128){var oe=Q.slice(ne,ne+128);Yt(oe,64),fe=oe.read_shift(2),_e=Pg(oe,0,fe-Y),O.push(_e);var ge={name:_e,type:oe.read_shift(1),color:oe.read_shift(1),L:oe.read_shift(4,"i"),R:oe.read_shift(4,"i"),C:oe.read_shift(4,"i"),clsid:oe.read_shift(16),state:oe.read_shift(4,"i"),start:0,size:0},Se=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);Se!==0&&(ge.ct=N(oe,oe.l-8));var tt=oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2)+oe.read_shift(2);tt!==0&&(ge.mt=N(oe,oe.l-8)),ge.start=oe.read_shift(4,"i"),ge.size=oe.read_shift(4,"i"),ge.size<0&&ge.start<0&&(ge.size=ge.type=0,ge.start=F,ge.name=""),ge.type===5?(q=ge.start,M>0&&q!==F&&(L[q].name="!StreamData")):ge.size>=4096?(ge.storage="fat",L[ge.start]===void 0&&(L[ge.start]=w(D,ge.start,L.fat_addrs,L.ssz)),L[ge.start].name=ge.name,ge.content=L[ge.start].data.slice(0,ge.size)):(ge.storage="minifat",ge.size<0?ge.size=0:q!==F&&ge.start!==F&&L[q]&&(ge.content=g(ge,L[q].data,(L[Z]||{}).data))),ge.content&&Yt(ge.content,0),V[_e]=ge,X.push(ge)}}function N(S,L){return new Date((qr(S,L+4)/1e7*Math.pow(2,32)+qr(S,L)/1e7-11644473600)*1e3)}function z(S,L){return l(),f(c.readFileSync(S),L)}function B(S,L){var D=L&&L.type;switch(D||ze&&Buffer.isBuffer(S)&&(D="buffer"),D||"base64"){case"file":return z(S,L);case"base64":return f(In(rn(S)),L);case"binary":return f(In(S),L)}return f(S,L)}function y(S,L){var D=L||{},O=D.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=O+"/",S.FileIndex[0]={name:O,type:5}),D.CLSID&&(S.FileIndex[0].clsid=D.CLSID),k(S)}function k(S){var L="Sh33tJ5";if(!We.find(S,"/"+L)){var D=Ot(4);D[0]=55,D[1]=D[3]=50,D[2]=54,S.FileIndex.push({name:L,type:2,content:D,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+L),A(S)}}function A(S,L){y(S);for(var D=!1,O=!1,M=S.FullPaths.length-1;M>=0;--M){var V=S.FileIndex[M];switch(V.type){case 0:O?D=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(V.R*V.L*V.C)&&(D=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!L)){var X=new Date(1987,1,19),Z=0,q=Object.create?Object.create(null):{},Y=[];for(M=0;M<S.FullPaths.length;++M)q[S.FullPaths[M]]=!0,S.FileIndex[M].type!==0&&Y.push([S.FullPaths[M],S.FileIndex[M]]);for(M=0;M<Y.length;++M){var Q=n(Y[M][0]);O=q[Q],O||(Y.push([Q,{name:i(Q).replace("/",""),type:1,clsid:Ee,ct:X,mt:X,content:null}]),q[Q]=!0)}for(Y.sort(function(_e,oe){return r(_e[0],oe[0])}),S.FullPaths=[],S.FileIndex=[],M=0;M<Y.length;++M)S.FullPaths[M]=Y[M][0],S.FileIndex[M]=Y[M][1];for(M=0;M<Y.length;++M){var ne=S.FileIndex[M],fe=S.FullPaths[M];if(ne.name=i(fe).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||Ee,M===0)ne.C=Y.length>1?1:-1,ne.size=0,ne.type=5;else if(fe.slice(-1)=="/"){for(Z=M+1;Z<Y.length&&n(S.FullPaths[Z])!=fe;++Z);for(ne.C=Z>=Y.length?-1:Z,Z=M+1;Z<Y.length&&n(S.FullPaths[Z])!=n(fe);++Z);ne.R=Z>=Y.length?-1:Z,ne.type=1}else n(S.FullPaths[M+1]||"")==n(fe)&&(ne.R=M+1),ne.type=2}}}function I(S,L){var D=L||{};if(D.fileType=="mad")return Ql(S,D);switch(A(S),D.fileType){case"zip":return Ss(S,D)}var O=function(_e){for(var oe=0,ge=0,Se=0;Se<_e.FileIndex.length;++Se){var tt=_e.FileIndex[Se];if(tt.content){var Ze=tt.content.length;Ze>0&&(Ze<4096?oe+=Ze+63>>6:ge+=Ze+511>>9)}}for(var xt=_e.FullPaths.length+3>>2,jr=oe+7>>3,si=oe+127>>7,Ps=jr+ge+xt+si,Un=Ps+127>>7,Sa=Un<=109?0:Math.ceil((Un-109)/127);Ps+Un+Sa+127>>7>Un;)Sa=++Un<=109?0:Math.ceil((Un-109)/127);var on=[1,Sa,Un,si,xt,ge,oe,0];return _e.FileIndex[0].size=oe<<6,on[7]=(_e.FileIndex[0].start=on[0]+on[1]+on[2]+on[3]+on[4]+on[5])+(on[6]+7>>3),on}(S),M=Ot(O[7]<<9),V=0,X=0;{for(V=0;V<8;++V)M.write_shift(1,ue[V]);for(V=0;V<8;++V)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),V=0;V<3;++V)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,O[2]),M.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:F),M.write_shift(4,O[3]),M.write_shift(-4,O[1]?O[0]-1:F),M.write_shift(4,O[1]),V=0;V<109;++V)M.write_shift(-4,V<O[2]?O[1]+V:-1)}if(O[1])for(X=0;X<O[1];++X){for(;V<236+X*127;++V)M.write_shift(-4,V<O[2]?O[1]+V:-1);M.write_shift(-4,X===O[1]-1?F:X+1)}var Z=function(_e){for(X+=_e;V<X-1;++V)M.write_shift(-4,V+1);_e&&(++V,M.write_shift(-4,F))};for(X=V=0,X+=O[1];V<X;++V)M.write_shift(-4,me.DIFSECT);for(X+=O[2];V<X;++V)M.write_shift(-4,me.FATSECT);Z(O[3]),Z(O[4]);for(var q=0,Y=0,Q=S.FileIndex[0];q<S.FileIndex.length;++q)Q=S.FileIndex[q],Q.content&&(Y=Q.content.length,!(Y<4096)&&(Q.start=X,Z(Y+511>>9)));for(Z(O[6]+7>>3);M.l&511;)M.write_shift(-4,me.ENDOFCHAIN);for(X=V=0,q=0;q<S.FileIndex.length;++q)Q=S.FileIndex[q],Q.content&&(Y=Q.content.length,!(!Y||Y>=4096)&&(Q.start=X,Z(Y+63>>6)));for(;M.l&511;)M.write_shift(-4,me.ENDOFCHAIN);for(V=0;V<O[4]<<2;++V){var ne=S.FullPaths[V];if(!ne||ne.length===0){for(q=0;q<17;++q)M.write_shift(4,0);for(q=0;q<3;++q)M.write_shift(4,-1);for(q=0;q<12;++q)M.write_shift(4,0);continue}Q=S.FileIndex[V],V===0&&(Q.start=Q.size?Q.start-1:F);var fe=V===0&&D.root||Q.name;if(Y=2*(fe.length+1),M.write_shift(64,fe,"utf16le"),M.write_shift(2,Y),M.write_shift(1,Q.type),M.write_shift(1,Q.color),M.write_shift(-4,Q.L),M.write_shift(-4,Q.R),M.write_shift(-4,Q.C),Q.clsid)M.write_shift(16,Q.clsid,"hex");else for(q=0;q<4;++q)M.write_shift(4,0);M.write_shift(4,Q.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,Q.start),M.write_shift(4,Q.size),M.write_shift(4,0)}for(V=1;V<S.FileIndex.length;++V)if(Q=S.FileIndex[V],Q.size>=4096)if(M.l=Q.start+1<<9,ze&&Buffer.isBuffer(Q.content))Q.content.copy(M,M.l,0,Q.size),M.l+=Q.size+511&-512;else{for(q=0;q<Q.size;++q)M.write_shift(1,Q.content[q]);for(;q&511;++q)M.write_shift(1,0)}for(V=1;V<S.FileIndex.length;++V)if(Q=S.FileIndex[V],Q.size>0&&Q.size<4096)if(ze&&Buffer.isBuffer(Q.content))Q.content.copy(M,M.l,0,Q.size),M.l+=Q.size+63&-64;else{for(q=0;q<Q.size;++q)M.write_shift(1,Q.content[q]);for(;q&63;++q)M.write_shift(1,0)}if(ze)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function R(S,L){var D=S.FullPaths.map(function(q){return q.toUpperCase()}),O=D.map(function(q){var Y=q.split("/");return Y[Y.length-(q.slice(-1)=="/"?2:1)]}),M=!1;L.charCodeAt(0)===47?(M=!0,L=D[0].slice(0,-1)+L):M=L.indexOf("/")!==-1;var V=L.toUpperCase(),X=M===!0?D.indexOf(V):O.indexOf(V);if(X!==-1)return S.FileIndex[X];var Z=!V.match(gc);for(V=V.replace(Cr,""),Z&&(V=V.replace(gc,"!")),X=0;X<D.length;++X)if((Z?D[X].replace(gc,"!"):D[X]).replace(Cr,"")==V||(Z?O[X].replace(gc,"!"):O[X]).replace(Cr,"")==V)return S.FileIndex[X];return null}var C=64,F=-2,ve="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(S,L,D){l();var O=I(S,D);c.writeFileSync(L,O)}function W(S){for(var L=new Array(S.length),D=0;D<S.length;++D)L[D]=String.fromCharCode(S[D]);return L.join("")}function ce(S,L){var D=I(S,L);switch(L&&L.type||"buffer"){case"file":return l(),c.writeFileSync(L.filename,D),D;case"binary":return typeof D=="string"?D:W(D);case"base64":return sx(typeof D=="string"?D:W(D));case"buffer":if(ze)return Buffer.isBuffer(D)?D:va(D);case"array":return typeof D=="string"?In(D):D}return D}var xe;function b(S){try{var L=S.InflateRaw,D=new L;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)xe=S;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function K(S,L){if(!xe)return Kl(S,L);var D=xe.InflateRaw,O=new D,M=O._processChunk(S.slice(S.l),O._finishFlushFlag);return S.l+=O.bytesRead,M}function j(S){return xe?xe.deflateRawSync(S):Oe(S)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(S){var L=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(L>>16|L>>8|L)&255}for(var de=typeof Uint8Array<"u",se=de?new Uint8Array(256):[],Me=0;Me<256;++Me)se[Me]=ye(Me);function U(S,L){var D=se[S&255];return L<=8?D>>>8-L:(D=D<<8|se[S>>8&255],L<=16?D>>>16-L:(D=D<<8|se[S>>16&255],D>>>24-L))}function it(S,L){var D=L&7,O=L>>>3;return(S[O]|(D<=6?0:S[O+1]<<8))>>>D&3}function Ve(S,L){var D=L&7,O=L>>>3;return(S[O]|(D<=5?0:S[O+1]<<8))>>>D&7}function Xe(S,L){var D=L&7,O=L>>>3;return(S[O]|(D<=4?0:S[O+1]<<8))>>>D&15}function Le(S,L){var D=L&7,O=L>>>3;return(S[O]|(D<=3?0:S[O+1]<<8))>>>D&31}function pe(S,L){var D=L&7,O=L>>>3;return(S[O]|(D<=1?0:S[O+1]<<8))>>>D&127}function dt(S,L,D){var O=L&7,M=L>>>3,V=(1<<D)-1,X=S[M]>>>O;return D<8-O||(X|=S[M+1]<<8-O,D<16-O)||(X|=S[M+2]<<16-O,D<24-O)||(X|=S[M+3]<<24-O),X&V}function Er(S,L,D){var O=L&7,M=L>>>3;return O<=5?S[M]|=(D&7)<<O:(S[M]|=D<<O&255,S[M+1]=(D&7)>>8-O),L+3}function Hr(S,L,D){var O=L&7,M=L>>>3;return D=(D&1)<<O,S[M]|=D,L+1}function Wr(S,L,D){var O=L&7,M=L>>>3;return D<<=O,S[M]|=D&255,D>>>=8,S[M+1]=D,L+8}function Fi(S,L,D){var O=L&7,M=L>>>3;return D<<=O,S[M]|=D&255,D>>>=8,S[M+1]=D&255,S[M+2]=D>>>8,L+16}function Vn(S,L){var D=S.length,O=2*D>L?2*D:L+5,M=0;if(D>=L)return S;if(ze){var V=ax(O);if(S.copy)S.copy(V);else for(;M<S.length;++M)V[M]=S[M];return V}else if(de){var X=new Uint8Array(O);if(X.set)X.set(S);else for(;M<D;++M)X[M]=S[M];return X}return S.length=O,S}function jt(S){for(var L=new Array(S),D=0;D<S;++D)L[D]=0;return L}function $r(S,L,D){var O=1,M=0,V=0,X=0,Z=0,q=S.length,Y=de?new Uint16Array(32):jt(32);for(V=0;V<32;++V)Y[V]=0;for(V=q;V<D;++V)S[V]=0;q=S.length;var Q=de?new Uint16Array(q):jt(q);for(V=0;V<q;++V)Y[M=S[V]]++,O<M&&(O=M),Q[V]=0;for(Y[0]=0,V=1;V<=O;++V)Y[V+16]=Z=Z+Y[V-1]<<1;for(V=0;V<q;++V)Z=S[V],Z!=0&&(Q[V]=Y[Z+16]++);var ne=0;for(V=0;V<q;++V)if(ne=S[V],ne!=0)for(Z=U(Q[V],O)>>O-ne,X=(1<<O+4-ne)-1;X>=0;--X)L[Z|X<<ne]=ne&15|V<<4;return O}var an=de?new Uint16Array(512):jt(512),_t=de?new Uint16Array(32):jt(32);if(!de){for(var Ye=0;Ye<512;++Ye)an[Ye]=0;for(Ye=0;Ye<32;++Ye)_t[Ye]=0}(function(){for(var S=[],L=0;L<32;L++)S.push(5);$r(S,_t,32);var D=[];for(L=0;L<=143;L++)D.push(8);for(;L<=255;L++)D.push(9);for(;L<=279;L++)D.push(7);for(;L<=287;L++)D.push(8);$r(D,an,288)})();var wr=function(){for(var L=de?new Uint8Array(32768):[],D=0,O=0;D<le.length-1;++D)for(;O<le[D+1];++O)L[O]=D;for(;O<32768;++O)L[O]=29;var M=de?new Uint8Array(259):[];for(D=0,O=0;D<ee.length-1;++D)for(;O<ee[D+1];++O)M[O]=D;function V(Z,q){for(var Y=0;Y<Z.length;){var Q=Math.min(65535,Z.length-Y),ne=Y+Q==Z.length;for(q.write_shift(1,+ne),q.write_shift(2,Q),q.write_shift(2,~Q&65535);Q-- >0;)q[q.l++]=Z[Y++]}return q.l}function X(Z,q){for(var Y=0,Q=0,ne=de?new Uint16Array(32768):[];Q<Z.length;){var fe=Math.min(65535,Z.length-Q);if(fe<10){for(Y=Er(q,Y,+(Q+fe==Z.length)),Y&7&&(Y+=8-(Y&7)),q.l=Y/8|0,q.write_shift(2,fe),q.write_shift(2,~fe&65535);fe-- >0;)q[q.l++]=Z[Q++];Y=q.l*8;continue}Y=Er(q,Y,+(Q+fe==Z.length)+2);for(var _e=0;fe-- >0;){var oe=Z[Q];_e=(_e<<5^oe)&32767;var ge=-1,Se=0;if((ge=ne[_e])&&(ge|=Q&-32768,ge>Q&&(ge-=32768),ge<Q))for(;Z[ge+Se]==Z[Q+Se]&&Se<250;)++Se;if(Se>2){oe=M[Se],oe<=22?Y=Wr(q,Y,se[oe+1]>>1)-1:(Wr(q,Y,3),Y+=5,Wr(q,Y,se[oe-23]>>5),Y+=3);var tt=oe<8?0:oe-4>>2;tt>0&&(Fi(q,Y,Se-ee[oe]),Y+=tt),oe=L[Q-ge],Y=Wr(q,Y,se[oe]>>3),Y-=3;var Ze=oe<4?0:oe-2>>1;Ze>0&&(Fi(q,Y,Q-ge-le[oe]),Y+=Ze);for(var xt=0;xt<Se;++xt)ne[_e]=Q&32767,_e=(_e<<5^Z[Q])&32767,++Q;fe-=Se-1}else oe<=143?oe=oe+48:Y=Hr(q,Y,1),Y=Wr(q,Y,se[oe]),ne[_e]=Q&32767,++Q}Y=Wr(q,Y,0)-1}return q.l=(Y+7)/8|0,q.l}return function(q,Y){return q.length<8?V(q,Y):X(q,Y)}}();function Oe(S){var L=Ot(50+Math.floor(S.length*1.1)),D=wr(S,L);return L.slice(0,D)}var ut=de?new Uint16Array(32768):jt(32768),Dr=de?new Uint16Array(32768):jt(32768),st=de?new Uint16Array(128):jt(128),Bn=1,Bo=1;function Uo(S,L){var D=Le(S,L)+257;L+=5;var O=Le(S,L)+1;L+=5;var M=Xe(S,L)+4;L+=4;for(var V=0,X=de?new Uint8Array(19):jt(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,Y=de?new Uint8Array(8):jt(8),Q=de?new Uint8Array(8):jt(8),ne=X.length,fe=0;fe<M;++fe)X[H[fe]]=V=Ve(S,L),q<V&&(q=V),Y[V]++,L+=3;var _e=0;for(Y[0]=0,fe=1;fe<=q;++fe)Q[fe]=_e=_e+Y[fe-1]<<1;for(fe=0;fe<ne;++fe)(_e=X[fe])!=0&&(Z[fe]=Q[_e]++);var oe=0;for(fe=0;fe<ne;++fe)if(oe=X[fe],oe!=0){_e=se[Z[fe]]>>8-oe;for(var ge=(1<<7-oe)-1;ge>=0;--ge)st[_e|ge<<oe]=oe&7|fe<<3}var Se=[];for(q=1;Se.length<D+O;)switch(_e=st[pe(S,L)],L+=_e&7,_e>>>=3){case 16:for(V=3+it(S,L),L+=2,_e=Se[Se.length-1];V-- >0;)Se.push(_e);break;case 17:for(V=3+Ve(S,L),L+=3;V-- >0;)Se.push(0);break;case 18:for(V=11+pe(S,L),L+=7;V-- >0;)Se.push(0);break;default:Se.push(_e),q<_e&&(q=_e);break}var tt=Se.slice(0,D),Ze=Se.slice(D);for(fe=D;fe<286;++fe)tt[fe]=0;for(fe=O;fe<30;++fe)Ze[fe]=0;return Bn=$r(tt,ut,286),Bo=$r(Ze,Dr,30),L}function Y0(S,L){if(S[0]==3&&!(S[1]&3))return[_s(L),2];for(var D=0,O=0,M=ax(L||1<<18),V=0,X=M.length>>>0,Z=0,q=0;!(O&1);){if(O=Ve(S,D),D+=3,O>>>1)O>>1==1?(Z=9,q=5):(D=Uo(S,D),Z=Bn,q=Bo);else{D&7&&(D+=8-(D&7));var Y=S[D>>>3]|S[(D>>>3)+1]<<8;if(D+=32,Y>0)for(!L&&X<V+Y&&(M=Vn(M,V+Y),X=M.length);Y-- >0;)M[V++]=S[D>>>3],D+=8;continue}for(;;){!L&&X<V+32767&&(M=Vn(M,V+32767),X=M.length);var Q=dt(S,D,Z),ne=O>>>1==1?an[Q]:ut[Q];if(D+=ne&15,ne>>>=4,!(ne>>>8&255))M[V++]=ne;else{if(ne==256)break;ne-=257;var fe=ne<8?0:ne-4>>2;fe>5&&(fe=0);var _e=V+ee[ne];fe>0&&(_e+=dt(S,D,fe),D+=fe),Q=dt(S,D,q),ne=O>>>1==1?_t[Q]:Dr[Q],D+=ne&15,ne>>>=4;var oe=ne<4?0:ne-2>>1,ge=le[ne];for(oe>0&&(ge+=dt(S,D,oe),D+=oe),!L&&X<_e&&(M=Vn(M,_e+100),X=M.length);V<_e;)M[V]=M[V-ge],++V}}}return L?[M,D+7>>>3]:[M.slice(0,V),D+7>>>3]}function Kl(S,L){var D=S.slice(S.l||0),O=Y0(D,L);return S.l+=O[1],O[0]}function Ta(S,L){if(S)typeof console<"u"&&console.error(L);else throw new Error(L)}function zo(S,L){var D=S;Yt(D,0);var O=[],M=[],V={FileIndex:O,FullPaths:M};y(V,{root:L.root});for(var X=D.length-4;(D[X]!=80||D[X+1]!=75||D[X+2]!=5||D[X+3]!=6)&&X>=0;)--X;D.l=X+4,D.l+=4;var Z=D.read_shift(2);D.l+=6;var q=D.read_shift(4);for(D.l=q,X=0;X<Z;++X){D.l+=20;var Y=D.read_shift(4),Q=D.read_shift(4),ne=D.read_shift(2),fe=D.read_shift(2),_e=D.read_shift(2);D.l+=8;var oe=D.read_shift(4),ge=o(D.slice(D.l+ne,D.l+ne+fe));D.l+=ne+fe+_e;var Se=D.l;D.l=oe+4,ql(D,Y,Q,V,ge),D.l=Se}return V}function ql(S,L,D,O,M){S.l+=2;var V=S.read_shift(2),X=S.read_shift(2),Z=a(S);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var q=S.read_shift(4),Y=S.read_shift(4),Q=S.read_shift(4),ne=S.read_shift(2),fe=S.read_shift(2),_e="",oe=0;oe<ne;++oe)_e+=String.fromCharCode(S[S.l++]);if(fe){var ge=o(S.slice(S.l,S.l+fe));(ge[21589]||{}).mt&&(Z=ge[21589].mt),((M||{})[21589]||{}).mt&&(Z=M[21589].mt)}S.l+=fe;var Se=S.slice(S.l,S.l+Y);switch(X){case 8:Se=K(S,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var tt=!1;V&8&&(q=S.read_shift(4),q==134695760&&(q=S.read_shift(4),tt=!0),Y=S.read_shift(4),Q=S.read_shift(4)),Y!=L&&Ta(tt,"Bad compressed size: "+L+" != "+Y),Q!=D&&Ta(tt,"Bad uncompressed size: "+D+" != "+Q),Aa(O,_e,Se,{unsafe:!0,mt:Z})}function Ss(S,L){var D=L||{},O=[],M=[],V=Ot(1),X=D.compression?8:0,Z=0,q=0,Y=0,Q=0,ne=0,fe=S.FullPaths[0],_e=fe,oe=S.FileIndex[0],ge=[],Se=0;for(q=1;q<S.FullPaths.length;++q)if(_e=S.FullPaths[q].slice(fe.length),oe=S.FileIndex[q],!(!oe.size||!oe.content||_e=="Sh33tJ5")){var tt=Q,Ze=Ot(_e.length);for(Y=0;Y<_e.length;++Y)Ze.write_shift(1,_e.charCodeAt(Y)&127);Ze=Ze.slice(0,Ze.l),ge[ne]=t6.buf(oe.content,0);var xt=oe.content;X==8&&(xt=j(xt)),V=Ot(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,Z),V.write_shift(2,X),oe.mt?s(V,oe.mt):V.write_shift(4,0),V.write_shift(-4,ge[ne]),V.write_shift(4,xt.length),V.write_shift(4,oe.content.length),V.write_shift(2,Ze.length),V.write_shift(2,0),Q+=V.length,O.push(V),Q+=Ze.length,O.push(Ze),Q+=xt.length,O.push(xt),V=Ot(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,Z),V.write_shift(2,X),V.write_shift(4,0),V.write_shift(-4,ge[ne]),V.write_shift(4,xt.length),V.write_shift(4,oe.content.length),V.write_shift(2,Ze.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,tt),Se+=V.l,M.push(V),Se+=Ze.length,M.push(Ze),++ne}return V=Ot(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,ne),V.write_shift(2,ne),V.write_shift(4,Se),V.write_shift(4,Q),V.write_shift(2,0),Ki([Ki(O),Ki(M),V])}var Di={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ho(S,L){if(S.ctype)return S.ctype;var D=S.name||"",O=D.match(/\.([^\.]+)$/);return O&&Di[O[1]]||L&&(O=(D=L).match(/[\.\\]([^\.\\])+$/),O&&Di[O[1]])?Di[O[1]]:"application/octet-stream"}function ii(S){for(var L=sx(S),D=[],O=0;O<L.length;O+=76)D.push(L.slice(O,O+76));return D.join(`\r
`)+`\r
`}function Xl(S){var L=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var Q=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],O=L.split(`\r
`),M=0;M<O.length;++M){var V=O[M];if(V.length==0){D.push("");continue}for(var X=0;X<V.length;){var Z=76,q=V.slice(X,X+Z);q.charAt(Z-1)=="="?Z--:q.charAt(Z-2)=="="?Z-=2:q.charAt(Z-3)=="="&&(Z-=3),q=V.slice(X,X+Z),X+=Z,X<V.length&&(q+="="),D.push(q)}}return D.join(`\r
`)}function ka(S){for(var L=[],D=0;D<S.length;++D){for(var O=S[D];D<=S.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+S[++D];L.push(O)}for(var M=0;M<L.length;++M)L[M]=L[M].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return In(L.join(`\r
`))}function Yl(S,L,D){for(var O="",M="",V="",X,Z=0;Z<10;++Z){var q=L[Z];if(!q||q.match(/^\s*$/))break;var Y=q.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":O=Y[2].trim();break;case"content-type":V=Y[2].trim();break;case"content-transfer-encoding":M=Y[2].trim();break}}switch(++Z,M.toLowerCase()){case"base64":X=In(rn(L.slice(Z).join("")));break;case"quoted-printable":X=ka(L.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var Q=Aa(S,O.slice(D.length),X,{unsafe:!0});V&&(Q.ctype=V)}function Is(S,L){if(W(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=L&&L.root||"",O=(ze&&Buffer.isBuffer(S)?S.toString("binary"):W(S)).split(`\r
`),M=0,V="";for(M=0;M<O.length;++M)if(V=O[M],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),D||(D=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),V.slice(0,D.length)!=D););var X=(O[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var Z="--"+(X[1]||""),q=[],Y=[],Q={FileIndex:q,FullPaths:Y};y(Q);var ne,fe=0;for(M=0;M<O.length;++M){var _e=O[M];_e!==Z&&_e!==Z+"--"||(fe++&&Yl(Q,O.slice(ne,M),D),ne=M)}return Q}function Ql(S,L){var D=L||{},O=D.boundary||"SheetJS";O="------="+O;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],V=S.FullPaths[0],X=V,Z=S.FileIndex[0],q=1;q<S.FullPaths.length;++q)if(X=S.FullPaths[q].slice(V.length),Z=S.FileIndex[q],!(!Z.size||!Z.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Se){return"_x"+Se.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Se){return"_u"+Se.charCodeAt(0).toString(16)+"_"});for(var Y=Z.content,Q=ze&&Buffer.isBuffer(Y)?Y.toString("binary"):W(Y),ne=0,fe=Math.min(1024,Q.length),_e=0,oe=0;oe<=fe;++oe)(_e=Q.charCodeAt(oe))>=32&&_e<128&&++ne;var ge=ne>=fe*4/5;M.push(O),M.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+X),M.push("Content-Transfer-Encoding: "+(ge?"quoted-printable":"base64")),M.push("Content-Type: "+Ho(Z,X)),M.push(""),M.push(ge?Xl(Q):ii(Q))}return M.push(O+`--\r
`),M.join(`\r
`)}function Gt(S){var L={};return y(L,S),L}function Aa(S,L,D,O){var M=O&&O.unsafe;M||y(S);var V=!M&&We.find(S,L);if(!V){var X=S.FullPaths[0];L.slice(0,X.length)==X?X=L:(X.slice(-1)!="/"&&(X+="/"),X=(X+L).replace("//","/")),V={name:i(L),type:2},S.FileIndex.push(V),S.FullPaths.push(X),M||We.utils.cfb_gc(S)}return V.content=D,V.size=D?D.length:0,O&&(O.CLSID&&(V.clsid=O.CLSID),O.mt&&(V.mt=O.mt),O.ct&&(V.ct=O.ct)),V}function Cs(S,L){y(S);var D=We.find(S,L);if(D){for(var O=0;O<S.FileIndex.length;++O)if(S.FileIndex[O]==D)return S.FileIndex.splice(O,1),S.FullPaths.splice(O,1),!0}return!1}function Rs(S,L,D){y(S);var O=We.find(S,L);if(O){for(var M=0;M<S.FileIndex.length;++M)if(S.FileIndex[M]==O)return S.FileIndex[M].name=i(D),S.FullPaths[M]=D,!0}return!1}function Q0(S){A(S,!0)}return e.find=R,e.read=B,e.parse=f,e.write=ce,e.writeFile=ie,e.utils={cfb_new:Gt,cfb_add:Aa,cfb_del:Cs,cfb_mov:Rs,cfb_gc:Q0,ReadShift:Oc,CheckField:Bk,prep_blob:Yt,bconcat:Ki,use_zlib:b,_deflateRaw:Oe,_inflateRaw:Kl,consts:me},e}();function r6(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function ti(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Sg(t){for(var e=[],r=ti(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Zf=new Date(1899,11,30,0,0,0);function Rr(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=Zf.getTime()+(t.getTimezoneOffset()-Zf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vk=new Date,n6=Zf.getTime()+(vk.getTimezoneOffset()-Zf.getTimezoneOffset())*6e4,px=vk.getTimezoneOffset();function G0(t){var e=new Date;return e.setTime(t*24*60*60*1e3+n6),e.getTimezoneOffset()!==px&&e.setTime(e.getTime()+(e.getTimezoneOffset()-px)*6e4),e}function i6(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var mx=new Date("2017-02-19T19:06:09.000Z"),_k=isNaN(mx.getFullYear())?new Date("2/19/17"):mx,s6=_k.getFullYear()==2017;function $t(t,e){var r=new Date(t);if(s6)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(_k.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function oa(t,e){if(ze&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return _c(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return _c(ik(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return _c(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return _c(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function er(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=er(t[r]));return e}function wt(t,e){for(var r="";r.length<e;)r+=t;return r}function Dn(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var a6=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ao(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&a6.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var o6=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function xk(t){return t?t.content&&t.type?oa(t.content,!0):t.data?mc(t.data):t.asNodeBuffer&&ze?mc(t.asNodeBuffer().toString("binary")):t.asBinary?mc(t.asBinary()):t._data&&t._data.getContent?mc(oa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function yk(t){if(!t)return null;if(t.data)return nx(t.data);if(t.asNodeBuffer&&ze)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?nx(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function c6(t){return t&&t.name.slice(-4)===".bin"?yk(t):xk(t)}function un(t,e){for(var r=t.FullPaths||ti(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Ig(t,e){var r=un(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Pt(t,e,r){if(!r)return c6(Ig(t,e));if(!e)return null;try{return Pt(t,e)}catch{return null}}function Xr(t,e,r){if(!r)return xk(Ig(t,e));if(!e)return null;try{return Xr(t,e)}catch{return null}}function Ek(t,e,r){if(!r)return yk(Ig(t,e));if(!e)return null;try{return Ek(t,e)}catch{return null}}function gx(t){for(var e=t.FullPaths||ti(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function l6(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ze?n=va(r):n=RO(r),We.utils.cfb_add(t,e,n)}We.utils.cfb_add(t,e,r)}else t.file(e,r)}function wk(t,e){switch(e.type){case"base64":return We.read(t,{type:"base64"});case"binary":return We.read(t,{type:"binary"});case"buffer":case"array":return We.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function vc(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Tk=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,u6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,vx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,f6=/<[^>]*>/g,yr=Tk.match(vx)?vx:f6,h6=/<\w*:/,d6=/<(\/?)\w+:/;function Ie(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(u6),o=0,c="",l=0,f="",h="",d=1;if(a)for(l=0;l!=a.length;++l){for(h=a[l],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(f=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,c=h.slice(s+1+d,h.length-d),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,r||(n[f.toLowerCase()]=c);else{var m=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[m]&&f.slice(o-3,o)=="ext")continue;n[m]=c,r||(n[m.toLowerCase()]=c)}}return n}function ri(t){return t.replace(d6,"<$1")}var kk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},p6=Sg(kk),Ge=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,c){return kk[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),m6=/[&<>'"]/g,g6=/[\u0000-\u001f]/g;function Cg(t){var e=t+"";return e.replace(m6,function(r){return p6[r]}).replace(/\n/g,"<br/>").replace(g6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var _x=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function ft(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kh(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function xx(t){var e=_s(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function yx(t){return va(t,"binary").toString("utf8")}var Du="foo bar baz",nt=ze&&(yx(Du)==Kh(Du)&&yx||xx(Du)==Kh(Du)&&xx)||Kh,_c=ze?function(t){return va(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},vl=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Ak=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),v6=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_6=/<\/?(?:vt:)?variant>/g,x6=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ex(t,e){var r=Ie(t),n=t.match(v6(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_6,"").match(x6);a&&i.push({v:nt(a[2]),t:a[1]})}),i}var y6=/(^\s|\s$|\n)/;function E6(t){return ti(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function w6(t,e,r){return"<"+t+(r!=null?E6(r):"")+(e!=null?(e.match(y6)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Rg(t){if(ze&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return nt(_a(Tg(t)));throw new Error("Bad input format: expected Buffer or string")}var _l=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,T6={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},k6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function A6(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function S6(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var wx=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Tx=ze?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:va(e)})):wx(t)}:wx,kx=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(gi(t,i)));return n.join("").replace(Cr,"")},Pg=ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Cr,""):kx(t,e,r)}:kx,Ax=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Sk=ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Ax(t,e,r)}:Ax,Sx=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(La(t,i)));return n.join("")},zl=ze?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Sx(e,r,n)}:Sx,Ik=function(t,e){var r=qr(t,e);return r>0?zl(t,e+4,e+4+r-1):""},Ck=Ik,Rk=function(t,e){var r=qr(t,e);return r>0?zl(t,e+4,e+4+r-1):""},Pk=Rk,Fk=function(t,e){var r=2*qr(t,e);return r>0?zl(t,e+4,e+4+r-1):""},Dk=Fk,Nk=function(e,r){var n=qr(e,r);return n>0?Pg(e,r+4,r+4+n):""},Ok=Nk,Lk=function(t,e){var r=qr(t,e);return r>0?zl(t,e+4,e+4+r):""},Mk=Lk,bk=function(t,e){return A6(t,e)},e0=bk,Vk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ze&&(Ck=function(e,r){if(!Buffer.isBuffer(e))return Ik(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Pk=function(e,r){if(!Buffer.isBuffer(e))return Rk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Dk=function(e,r){if(!Buffer.isBuffer(e))return Fk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Ok=function(e,r){if(!Buffer.isBuffer(e))return Nk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Mk=function(e,r){if(!Buffer.isBuffer(e))return Lk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},e0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):bk(e,r)},Vk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var La=function(t,e){return t[e]},gi=function(t,e){return t[e+1]*256+t[e]},I6=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},qr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ms=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},C6=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Oc(t,e){var r="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(gi(this,l)),l+=2;t*=2;break;case"utf8":r=zl(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Pg(this,this.l,this.l+t);break;case"wstr":return Oc.call(this,t,"dbcs");case"lpstr-ansi":r=Ck(this,this.l),t=4+qr(this,this.l);break;case"lpstr-cp":r=Pk(this,this.l),t=4+qr(this,this.l);break;case"lpwstr":r=Dk(this,this.l),t=4+2*qr(this,this.l);break;case"lpp4":t=4+qr(this,this.l),r=Ok(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+qr(this,this.l),r=Mk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=La(this,this.l+t++))!==0;)s.push(Fu(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=gi(this,this.l+t))!==0;)s.push(Fu(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=La(this,l),this.l=l+1,o=Oc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Fu(gi(this,l))),l+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=La(this,l),this.l=l+1,o=Oc.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Fu(La(this,l))),l+=1}r=s.join("");break;default:switch(t){case 1:return n=La(this,this.l),this.l++,n;case 2:return n=(e==="i"?I6:gi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Ms:C6)(this,this.l),this.l+=4,n):(i=qr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=e0(this,this.l):i=e0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Sk(this,this.l,t);break}}return this.l+=t,r}var R6=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},P6=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},F6=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function D6(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)F6(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,R6(this,e,this.l);break;case 8:if(n=8,r==="f"){S6(this,e,this.l);break}case 16:break;case-4:n=4,P6(this,e,this.l);break}return this.l+=n,this}function Bk(t,e){var r=Sk(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Yt(t,e){t.l=e,t.read_shift=Oc,t.chk=Bk,t.write_shift=D6}function xr(t,e){t.l+=e}function Ot(t){var e=_s(t);return Yt(e,0),e}function Pi(t,e,r){if(t){var n,i,s;Yt(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=a0[o]||a0[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;c=t.l+s;var f=l.f&&l.f(t,s,r);if(t.l=c,e(f,l,o))return}}}function yp(){var t=[],e=ze?256:2048,r=function(l){var f=Ot(l);return Yt(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,e)))},a=function(){return i(),Ki(t)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Lc(t,e,r){var n=er(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ix(t,e,r){var n=er(t);return n.s=Lc(n.s,e.s,r),n.e=Lc(n.e,e.s,r),n}function Mc(t,e){if(t.cRel&&t.c<0)for(t=er(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=er(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Fe(t);return!t.cRel&&t.cRel!=null&&(r=L6(r)),!t.rRel&&t.rRel!=null&&(r=N6(r)),r}function qh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+bt(t.s.c)+":"+(t.e.cRel?"":"$")+bt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+tr(t.s.r)+":"+(t.e.rRel?"":"$")+tr(t.e.r):Mc(t.s,e.biff)+":"+Mc(t.e,e.biff)}function Fg(t){return parseInt(O6(t),10)-1}function tr(t){return""+(t+1)}function N6(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function O6(t){return t.replace(/\$(\d+)$/,"$1")}function Dg(t){for(var e=M6(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function bt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function L6(t){return t.replace(/^([A-Z])/,"$$$1")}function M6(t){return t.replace(/^\$([A-Z])/,"$1")}function b6(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Fe(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function bo(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function $e(t,e){return typeof e>"u"||typeof e=="number"?$e(t.s,t.e):(typeof t!="string"&&(t=Fe(t)),typeof e!="string"&&(e=Fe(e)),t==e?t:t+":"+e)}function kt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Cx(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=_n(t.z,r?Rr(e):e)}catch{}try{return t.w=_n((t.XF||{}).numFmtId||(r?14:0),r?Rr(e):e)}catch{return""+e}}function Ci(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ea[t.v]||t.v:e==null?Cx(t,t.v):Cx(t,e))}function As(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Uk(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Sr(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=kt(s["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),a==-1&&(l.e.r=a=f.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},v=a+h,g=o+d;if(l.s.r>v&&(l.s.r=v),l.s.c>g&&(l.s.c=g),l.e.r<v&&(l.e.r=v),l.e.c<g&&(l.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Ne[14],n.cellDates?(m.t="d",m.w=_n(m.z,Rr(m.v))):(m.t="n",m.v=Rr(m.v),m.w=_n(m.z,m.v))):m.t="s";if(i)s[v]||(s[v]=[]),s[v][g]&&s[v][g].z&&(m.z=s[v][g].z),s[v][g]=m;else{var E=Fe({c:g,r:v});s[E]&&s[E].z&&(m.z=s[E].z),s[E]=m}}}return l.s.c<1e7&&(s["!ref"]=$e(l)),s}function Vo(t,e){return Uk(null,t,e)}function V6(t){return t.read_shift(4,"i")}function gr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function B6(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Ng(t,e){var r=t.l,n=t.read_shift(1),i=gr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(B6(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var U6=Ng;function xn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function xa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var z6=gr;function Og(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var H6=gr,Ep=Og;function Lg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?e0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ms(e,0)>>2;return r?i/100:i}function zk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var ya=zk;function pr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function W6(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=Ks[i];l&&(e.rgb=yl(l));break;case 2:e.rgb=yl([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function $6(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Hk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function j6(t){return Hk(t,1)}function G6(t){return Hk(t,2)}var Mg=2,Nr=3,Nu=11,Rx=12,t0=19,Ou=64,K6=65,q6=71,X6=4108,Y6=4126,zt=80,Wk=81,Q6=[zt,Wk],J6={1:{n:"CodePage",t:Mg},2:{n:"Category",t:zt},3:{n:"PresentationFormat",t:zt},4:{n:"ByteCount",t:Nr},5:{n:"LineCount",t:Nr},6:{n:"ParagraphCount",t:Nr},7:{n:"SlideCount",t:Nr},8:{n:"NoteCount",t:Nr},9:{n:"HiddenCount",t:Nr},10:{n:"MultimediaClipCount",t:Nr},11:{n:"ScaleCrop",t:Nu},12:{n:"HeadingPairs",t:X6},13:{n:"TitlesOfParts",t:Y6},14:{n:"Manager",t:zt},15:{n:"Company",t:zt},16:{n:"LinksUpToDate",t:Nu},17:{n:"CharacterCount",t:Nr},19:{n:"SharedDoc",t:Nu},22:{n:"HyperlinksChanged",t:Nu},23:{n:"AppVersion",t:Nr,p:"version"},24:{n:"DigSig",t:K6},26:{n:"ContentType",t:zt},27:{n:"ContentStatus",t:zt},28:{n:"Language",t:zt},29:{n:"Version",t:zt},255:{},2147483648:{n:"Locale",t:t0},2147483651:{n:"Behavior",t:t0},1919054434:{}},Z6={1:{n:"CodePage",t:Mg},2:{n:"Title",t:zt},3:{n:"Subject",t:zt},4:{n:"Author",t:zt},5:{n:"Keywords",t:zt},6:{n:"Comments",t:zt},7:{n:"Template",t:zt},8:{n:"LastAuthor",t:zt},9:{n:"RevNumber",t:zt},10:{n:"EditTime",t:Ou},11:{n:"LastPrinted",t:Ou},12:{n:"CreatedDate",t:Ou},13:{n:"ModifiedDate",t:Ou},14:{n:"PageCount",t:Nr},15:{n:"WordCount",t:Nr},16:{n:"CharCount",t:Nr},17:{n:"Thumbnail",t:q6},18:{n:"Application",t:zt},19:{n:"DocSecurity",t:Nr},255:{},2147483648:{n:"Locale",t:t0},2147483651:{n:"Behavior",t:t0},1919054434:{}},Px={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tL(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var rL=tL([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ks=er(rL),Ea={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$k={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function nL(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iL(t){var e=nL();if(!t||!t.match)return e;var r={};if((t.match(yr)||[]).forEach(function(n){var i=Ie(n);switch(i[0].replace(h6,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Fx[i.ContentType]]!==void 0&&e[Fx[i.ContentType]].push(i.PartName);break}}),e.xmlns!==T6.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Xa={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wp(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function bc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(yr)||[]).forEach(function(i){var s=Ie(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:vc(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}var sL="application/vnd.oasis.opendocument.spreadsheet";function aL(t,e){for(var r=Rg(t),n,i;n=_l.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ie(n[0],!1),i.path=="/"&&i.type!==sL)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Vc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],oL=function(){for(var t=new Array(Vc.length),e=0;e<Vc.length;++e){var r=Vc[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function jk(t){var e={};t=nt(t);for(var r=0;r<Vc.length;++r){var n=Vc[r],i=t.match(oL[r]);i!=null&&i.length>0&&(e[n[1]]=Ge(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=$t(e[n[1]]))}return e}var cL=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Gk(t,e,r,n){var i=[];if(typeof t=="string")i=Ex(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?Ex(e,n).map(function(f){return f.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function lL(t,e,r){var n={};return e||(e={}),t=nt(t),cL.forEach(function(i){var s=(t.match(vl(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Ge(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Gk(n.HeadingPairs,n.TitlesOfParts,e,r),e}var uL=/<[^>]+>[^<]*/g;function fL(t,e){var r={},n="",i=t.match(uL);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ie(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ge(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),f=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=Ge(f);break;case"bool":r[n]=ft(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=$t(f);break;case"cy":case"error":r[n]=Ge(f);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var hL={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Xh;function dL(t,e,r){Xh||(Xh=Sg(hL)),e=Xh[e]||e,t[e]=r}function bg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Kk(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function qk(t,e,r){var n=t.read_shift(0,"lpwstr");return r&&(t.l+=4-(n.length+1&3)&3),n}function Xk(t,e,r){return e===31?qk(t):Kk(t,e,r)}function Tp(t,e,r){return Xk(t,e,r===!1?0:4)}function pL(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Xk(t,e,0)}function mL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Cr,""),t.l-i&2&&(t.l+=2)}return r}function gL(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Cr,"");return r}function vL(t){var e=t.l,r=r0(t,Wk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=r0(t,Nr);return[r,n]}function _L(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(vL(t));return r}function Dx(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Cr,"").replace(gc,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>2+1<<2),n}function Yk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function xL(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function r0(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Rx&&n!==e&&Q6.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Rx?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return Kk(t,n,4).replace(Cr,"");case 31:return qk(t);case 64:return bg(t);case 65:return Yk(t);case 71:return xL(t);case 80:return Tp(t,n,!s.raw).replace(Cr,"");case 81:return pL(t,n).replace(Cr,"");case 4108:return _L(t);case 4126:case 4127:return n==4127?mL(t):gL(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Nx(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var f=t.read_shift(4),h=t.read_shift(4);s[a]=[f,h+r]}s.sort(function(T,_){return T[1]-_[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=r0(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Cn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=r0(t,Mg),Cn(o),c!==-1){var g=t.l;t.l=s[c][1],l=Dx(t,o),t.l=g}}else if(s[a][0]===0){if(o===0){c=a,t.l=s[a+1][1];continue}l=Dx(t,o)}else{var E=l[s[a][0]],w;switch(t[t.l]){case 65:t.l+=4,w=Yk(t);break;case 30:t.l+=4,w=Tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,w=Tp(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,w=t.read_shift(4,"i");break;case 19:t.l+=4,w=t.read_shift(4);break;case 5:t.l+=4,w=t.read_shift(8,"f");break;case 11:t.l+=4,w=At(t,4);break;case 64:t.l+=4,w=$t(bg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[E]=w}}return t.l=r+n,d}function Ox(t,e,r){var n=t.content;if(!n)return{};Yt(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),f=n.read_shift(16);if(f!==We.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var h=Nx(n,e),d={SystemIdentifier:l};for(var m in h)d[m]=h[m];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=Nx(n,null)}catch{}for(m in v)d[m]=v[m];return d.FMTID=[s,a],d}function bi(t,e){return t.read_shift(e),null}function yL(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function At(t,e){return t.read_shift(e)===1}function Ft(t){return t.read_shift(2,"u")}function Qk(t,e){return yL(t,e,Ft)}function EL(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Hl(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?t.read_shift(n,i):"";return a}function wL(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,s=1+(r&1),a=0,o,c={};i&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",f=e===0?"":t.read_shift(e,l);return i&&(t.l+=4*a),n&&(t.l+=o),c.t=f,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function ca(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Wl(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ca(t,n,r)}function wa(t,e,r){if(r.biff>5)return Wl(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function TL(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function kL(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Cr,"");return n&&(t.l+=24),i}function AL(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Cr,"");return r+a}function SL(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return kL(t);case"0303000000000000c000000000000046":return AL(t);default:throw new Error("Unsupported Moniker "+r)}}function Lu(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Cr,""):"";return r}function IL(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,c,l="",f,h;i&16&&(s=Lu(t,r-t.l)),i&128&&(a=Lu(t,r-t.l)),(i&257)===257&&(o=Lu(t,r-t.l)),(i&257)===1&&(c=SL(t,r-t.l)),i&8&&(l=Lu(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(h=bg(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return f&&(m.guid=f),h&&(m.time=h),s&&(m.Tooltip=s),m}function Jk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function Zk(t,e){var r=Jk(t);return r[3]=0,r}function ni(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function CL(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function RL(t,e,r){return e===0?"":wa(t,e,r)}function PL(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function eA(t){var e=t.read_shift(2),r=Lg(t);return[e,r]}function FL(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Hl(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function K0(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function tA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var DL=tA;function rA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function NL(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function OL(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function lr(t){t.l+=2,t.l+=t.read_shift(2)}var LL={0:lr,4:lr,5:lr,6:lr,7:OL,8:lr,9:lr,10:lr,11:lr,12:lr,13:NL,14:lr,15:lr,16:lr,17:lr,18:lr,19:lr,20:lr,21:rA};function ML(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(LL[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Mu(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function bL(t,e){return e===0||t.read_shift(2),1200}function VL(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=wa(t,0,r);return t.read_shift(e+n-t.l),i}function BL(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function UL(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Hl(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function zL(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(wL(t));return s.Count=n,s.Unique=i,s}function HL(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function WL(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function $L(t){var e=CL(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function jL(t){return t.read_shift(2),t.read_shift(4)}function Lx(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function GL(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function KL(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function qL(){}function XL(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Hl(t,0,r),n}function YL(t){var e=ni(t);return e.isst=t.read_shift(4),e}function QL(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=ni(t);r.biff==2&&t.l++;var s=Wl(t,n-t.l,r);return i.val=s,i}function JL(t,e,r){var n=t.read_shift(2),i=wa(t,0,r);return[n,i]}var ZL=wa;function Mx(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c}}}function eM(t){var e=t.read_shift(2),r=t.read_shift(2),n=eA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function tM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(eA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function rM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function nM(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return i.patternType=eL[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function iM(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=nM(t,e,n.fStyle,r),n}function sM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function bx(t,e,r){var n=ni(t);(r.biff==2||e==9)&&++t.l;var i=EL(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function aM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ni(t),i=pr(t);return n.val=i,n}var Vx=RL;function oM(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=ca(t,s),o=[];n>t.l;)o.push(Wl(t));return[s,i,a,o]}function Bx(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=FL(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var cM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ux(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=ca(t,a,r);i&32&&(l=cM[l.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var h=n==t.l||o===0||!(f>0)?[]:W9(t,f,r,o);return{chKey:s,Name:l,itab:c,rgce:h}}function nA(t,e,r){if(r.biff<8)return lM(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(PL(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function lM(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Hl(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function uM(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=ca(t,n,r),a=ca(t,i,r);return[s,a]}function fM(t,e,r){var n=tA(t);t.l++;var i=t.read_shift(1);return e-=8,[$9(t,e,r),i,n]}function zx(t,e,r){var n=DL(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,z9(t,e,r)]}function hM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function dM(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=wa(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function pM(t,e,r){return dM(t,e,r)}function mM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(K0(t));return r}function gM(t,e,r){if(r&&r.biff<8)return _M(t,e,r);var n=rA(t),i=ML(t,e-22,n[1]);return{cmo:n,ft:i}}var vM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function _M(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((vM[n]||xr)(t,e,r)),{cmo:[i,n,s],ft:a}}function xM(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=TL(t,6,r);var o=t.read_shift(2);t.read_shift(2),Ft(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var f=t[t.l],h=ca(t,t.lens[l+1]-t.lens[l]-1);if(i+=h,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function yM(t,e){var r=K0(t);t.l+=16;var n=IL(t,e-24);return[r,n]}function EM(t,e){t.read_shift(2);var r=K0(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Cr,""),[r,n]}function wM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Px[r]||r,r=t.read_shift(2),e[1]=Px[r]||r,e}function TM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Zk(t));return r}function kM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Zk(t));return r}function AM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function iA(t,e,r){if(!r.cellStyles)return xr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function SM(t,e){var r={};return e<32||(t.l+=16,r.header=pr(t),r.footer=pr(t),t.l+=2),r}function IM(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var CM=ni,RM=Qk,PM=Wl;function FM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function DM(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ni(t);++t.l;var i=wa(t,e-7,r);return n.t="str",n.val=i,n}function NM(t){var e=ni(t);++t.l;var r=pr(t);return e.t="n",e.val=r,e}function OM(t){var e=ni(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function LM(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function MM(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function bM(t,e,r){var n=t.l+e,i=ni(t),s=t.read_shift(2),a=ca(t,s,r);return t.l=n,i.t="str",i.val=a,i}var VM=[2,3,48,49,131,139,140,245],Hx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],f=_s(1);switch(c.type){case"base64":f=In(rn(o));break;case"binary":f=In(o);break;case"buffer":case"array":f=o;break}Yt(f,0);var h=f.read_shift(1),d=!!(h&136),m=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,E=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(E=f.read_shift(2));var w=f.read_shift(2),T=c.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(T=t[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],N={},z=Math.min(f.length,h==2?521:E-10-(m?264:0)),B=v?32:11;f.l<z&&f[f.l]!=13;)switch(N={},N.name=Gi.utils.decode(T,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,N.type=String.fromCharCode(f.read_shift(1)),h!=2&&!v&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),h==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&_.push(N),h!=2&&(f.l+=v?13:14),N.type){case"B":(!m||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=E-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=E;var y=0,k=0;for(l[0]=[],k=0;k!=_.length;++k)l[0][k]=_[k].name;for(;g-- >0;){if(f[f.l]===42){f.l+=w;continue}for(++f.l,l[++y]=[],k=0,k=0;k!=_.length;++k){var A=f.slice(f.l,f.l+_[k].len);f.l+=_[k].len,Yt(A,0);var I=Gi.utils.decode(T,A);switch(_[k].type){case"C":I.trim().length&&(l[y][k]=I.replace(/\s+$/,""));break;case"D":I.length===8?l[y][k]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):l[y][k]=I;break;case"F":l[y][k]=parseFloat(I.trim());break;case"+":case"I":l[y][k]=v?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":l[y][k]=!0;break;case"N":case"F":l[y][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));l[y][k]="##MEMO##"+(v?parseInt(I.trim(),10):A.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(l[y][k]=+I||0);break;case"@":l[y][k]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":l[y][k]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":l[y][k]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[y][k]=-A.read_shift(-8,"f");break;case"B":if(m&&_[k].len==8){l[y][k]=A.read_shift(8,"f");break}case"G":case"P":A.l+=_[k].len;break;case"0":if(_[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[k].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=_,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Vo(r(o,l),l);return f["!cols"]=l.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete l.DBF,f}function i(o,c){try{return As(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&Cn(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=yp(),h=Rp(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),v=o["!cols"]||[],g=0,E=0,w=0,T=1;for(g=0;g<d.length;++g){if(((v[g]||{}).DBF||{}).name){d[g]=v[g].DBF.name,++w;continue}if(d[g]!=null){if(++w,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(E=0;E<1024;++E)if(d.indexOf(d[g]+"_"+E)==-1){d[g]+="_"+E;break}}}}var _=kt(o["!ref"]),N=[],z=[],B=[];for(g=0;g<=_.e.c-_.s.c;++g){var y="",k="",A=0,I=[];for(E=0;E<m.length;++E)m[E][g]!=null&&I.push(m[E][g]);if(I.length==0||d[g]==null){N[g]="?";continue}for(E=0;E<I.length;++E){switch(typeof I[E]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=I[E]instanceof Date?"D":"C";break;default:k="C"}A=Math.max(A,String(I[E]).length),y=y&&y!=k?"C":k}A>250&&(A=250),k=((v[g]||{}).DBF||{}).type,k=="C"&&v[g].DBF.len>A&&(A=v[g].DBF.len),y=="B"&&k=="N"&&(y="N",B[g]=v[g].DBF.dec,A=v[g].DBF.len),z[g]=y=="C"||k=="N"?A:s[y]||0,T+=z[g],N[g]=y}var R=f.next(32);for(R.write_shift(4,318902576),R.write_shift(4,m.length),R.write_shift(2,296+32*w),R.write_shift(2,T),g=0;g<4;++g)R.write_shift(4,0);for(R.write_shift(4,0|(+e[rk]||3)<<8),g=0,E=0;g<d.length;++g)if(d[g]!=null){var C=f.next(32),F=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,F,"sbcs"),C.write_shift(1,N[g]=="?"?"C":N[g],"sbcs"),C.write_shift(4,E),C.write_shift(1,z[g]||s[N[g]]||0),C.write_shift(1,B[g]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),E+=z[g]||s[N[g]]||0}var ve=f.next(264);for(ve.write_shift(4,13),g=0;g<65;++g)ve.write_shift(4,0);for(g=0;g<m.length;++g){var ue=f.next(T);for(ue.write_shift(1,0),E=0;E<d.length;++E)if(d[E]!=null)switch(N[E]){case"L":ue.write_shift(1,m[g][E]==null?63:m[g][E]?84:70);break;case"B":ue.write_shift(8,m[g][E]||0,"f");break;case"N":var Ee="0";for(typeof m[g][E]=="number"&&(Ee=m[g][E].toFixed(B[E]||0)),w=0;w<z[E]-Ee.length;++w)ue.write_shift(1,32);ue.write_shift(1,Ee,"sbcs");break;case"D":m[g][E]?(ue.write_shift(4,("0000"+m[g][E].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(m[g][E].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+m[g][E].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var me=String(m[g][E]!=null?m[g][E]:"").slice(0,z[E]);for(ue.write_shift(1,me,"sbcs"),w=0;w<z[E]-me.length;++w)ue.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),BM=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ti(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var v=t[m];return typeof v=="number"?ix(v):v},n=function(d,m,v){var g=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?d:ix(g)};t["|"]=254;function i(d,m){switch(m.type){case"base64":return s(rn(d),m);case"binary":return s(d,m);case"buffer":return s(ze&&Buffer.isBuffer(d)?d.toString("binary"):_a(d),m);case"array":return s(oa(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var v=d.split(/[\n\r]+/),g=-1,E=-1,w=0,T=0,_=[],N=[],z=null,B={},y=[],k=[],A=[],I=0,R;for(+m.codepage>=0&&Cn(+m.codepage);w!==v.length;++w){I=0;var C=v[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=C.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ve=F[0],ue;if(C.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&N.push(C.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,me=!1,ie=!1,W=!1,ce=-1,xe=-1;for(T=1;T<F.length;++T)switch(F[T].charAt(0)){case"A":break;case"X":E=parseInt(F[T].slice(1))-1,me=!0;break;case"Y":for(g=parseInt(F[T].slice(1))-1,me||(E=0),R=_.length;R<=g;++R)_[R]=[];break;case"K":ue=F[T].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Dn(ue))?isNaN(Ao(ue).getDate())||(ue=$t(ue)):(ue=Dn(ue),z!==null&&Mo(z)&&(ue=G0(ue))),Ee=!0;break;case"E":W=!0;var b=oo(F[T].slice(1),{r:g,c:E});_[g][E]=[_[g][E],b];break;case"S":ie=!0,_[g][E]=[_[g][E],"S5S"];break;case"G":break;case"R":ce=parseInt(F[T].slice(1))-1;break;case"C":xe=parseInt(F[T].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}if(Ee&&(_[g][E]&&_[g][E].length==2?_[g][E][0]=ue:_[g][E]=ue,z=null),ie){if(W)throw new Error("SYLK shared formula cannot have own formula");var K=ce>-1&&_[ce][xe];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");_[g][E][1]=pA(K[1],{r:g-ce,c:E-xe})}break;case"F":var j=0;for(T=1;T<F.length;++T)switch(F[T].charAt(0)){case"X":E=parseInt(F[T].slice(1))-1,++j;break;case"Y":for(g=parseInt(F[T].slice(1))-1,R=_.length;R<=g;++R)_[R]=[];break;case"M":I=parseInt(F[T].slice(1))/20;break;case"F":break;case"G":break;case"P":z=N[parseInt(F[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=F[T].slice(1).split(" "),R=parseInt(A[0],10);R<=parseInt(A[1],10);++R)I=parseInt(A[2],10),k[R-1]=I===0?{hidden:!0}:{wch:I},So(k[R-1]);break;case"C":E=parseInt(F[T].slice(1))-1,k[E]||(k[E]={});break;case"R":g=parseInt(F[T].slice(1))-1,y[g]||(y[g]={}),I>0?(y[g].hpt=I,y[g].hpx=El(I)):I===0&&(y[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}j<1&&(z=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+C)}}return y.length>0&&(B["!rows"]=y),k.length>0&&(B["!cols"]=k),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,B]}function a(d,m){var v=i(d,m),g=v[0],E=v[1],w=Vo(g,m);return ti(E).forEach(function(T){w[T]=E[T]}),w}function o(d,m){return As(a(d,m),m)}function c(d,m,v,g){var E="C;Y"+(v+1)+";X"+(g+1)+";K";switch(d.t){case"n":E+=d.v||0,d.f&&!d.F&&(E+=";E"+A5(d.f,{r:v,c:g}));break;case"b":E+=d.v?"TRUE":"FALSE";break;case"e":E+=d.w||d.v;break;case"d":E+='"'+(d.w||d.v)+'"';break;case"s":E+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function l(d,m){m.forEach(function(v,g){var E="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?E+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=i0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=s0(v.wpx)),typeof v.wch=="number"&&(E+=Math.round(v.wch))),E.charAt(E.length-1)!=" "&&d.push(E)})}function f(d,m){m.forEach(function(v,g){var E="F;";v.hidden?E+="M0;":v.hpt?E+="M"+20*v.hpt+";":v.hpx&&(E+="M"+20*fA(v.hpx)+";"),E.length>2&&d.push(E+"R"+(g+1))})}function h(d,m){var v=["ID;PWXL;N;E"],g=[],E=kt(d["!ref"]),w,T=Array.isArray(d),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&l(v,d["!cols"]),d["!rows"]&&f(v,d["!rows"]),v.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var N=E.s.r;N<=E.e.r;++N)for(var z=E.s.c;z<=E.e.c;++z){var B=Fe({r:N,c:z});w=T?(d[N]||[])[z]:d[B],!(!w||w.v==null&&(!w.f||w.F))&&g.push(c(w,d,N,z))}return v.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),UM=function(){function t(s,a){switch(a.type){case"base64":return e(rn(s),a);case"binary":return e(s,a);case"buffer":return e(ze&&Buffer.isBuffer(s)?s.toString("binary"):_a(s),a);case"array":return e(oa(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++c]=[],l=0;continue}if(!(c<0)){var d=o[f].trim().split(","),m=d[0],v=d[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++c]=[],l=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[c][l]=!0:g==="FALSE"?h[c][l]=!1:isNaN(Dn(v))?isNaN(Ao(v).getDate())?h[c][l]=v:h[c][l]=$t(v):h[c][l]=Dn(v),++l;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[c][l++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return Vo(t(s,a),a)}function n(s,a){return As(r(s,a),a)}var i=function(){var s=function(c,l,f,h,d){c.push(l),c.push(f+","+h),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,f,h){c.push(l+","+f),c.push(l==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var l=[],f=kt(c["!ref"]),h,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,f.e.r-f.s.r+1,""),s(l,"TUPLES",0,f.e.c-f.s.c+1,""),s(l,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(l,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var g=Fe({r:m,c:v});if(h=d?(c[m]||[])[v]:c[g],!h){a(l,1,0,"");continue}switch(h.t){case"n":var E=h.w;!E&&h.v!=null&&(E=h.v),E==null?h.f&&!h.F?a(l,1,0,"="+h.f):a(l,1,0,""):a(l,0,E,"V");break;case"b":a(l,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(l,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=_n(h.z||Ne[14],Rr($t(h.v)))),a(l,0,h.w,"V");break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var w=`\r
`,T=l.join(w);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),zM=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),v=-1,g=-1,E=0,w=[];E!==m.length;++E){var T=m[E].trim().split(":");if(T[0]==="cell"){var _=Sr(T[1]);if(w.length<=_.r)for(v=w.length;v<=_.r;++v)w[v]||(w[v]=[]);switch(v=_.r,g=_.c,T[2]){case"t":w[v][g]=t(T[3]);break;case"v":w[v][g]=+T[3];break;case"vtf":var N=T[T.length-1];case"vtc":switch(T[3]){case"nl":w[v][g]=!!+T[4];break;default:w[v][g]=+T[4];break}T[2]=="vtf"&&(w[v][g]=[w[v][g],N])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return Vo(r(h,d),d)}function i(h,d){return As(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],v,g="",E=bo(h["!ref"]),w=Array.isArray(h),T=E.s.r;T<=E.e.r;++T)for(var _=E.s.c;_<=E.e.c;++_)if(g=Fe({r:T,c:_}),v=w?(h[T]||[])[_]:h[g],!(!v||v.v==null||v.t==="z")){switch(m=["cell",g,"t"],v.t){case"s":case"str":m.push(e(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=e(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Rr($t(v.v));m[2]="vtc",m[3]="nd",m[4]=""+N,m[5]=v.w||_n(v.z||Ne[14],N);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(h){return[s,a,o,a,l(h),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),xl=function(){function t(f,h,d,m,v){v.raw?h[d][m]=f:f===""||(f==="TRUE"?h[d][m]=!0:f==="FALSE"?h[d][m]=!1:isNaN(Dn(f))?isNaN(Ao(f).getDate())?h[d][m]=f:h[d][m]=$t(f):h[d][m]=Dn(f))}function e(f,h){var d=h||{},m=[];if(!f||f.length===0)return m;for(var v=f.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var E=10,w=0,T=0;T<=g;++T)w=v[T].indexOf(" "),w==-1?w=v[T].length:w++,E=Math.max(E,w);for(T=0;T<=g;++T){m[T]=[];var _=0;for(t(v[T].slice(0,E).trim(),m,T,_,d),_=1;_<=(v[T].length-E)/10+1;++_)t(v[T].slice(E+(_-1)*10,E+_*10).trim(),m,T,_,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var h={},d=!1,m=0,v=0;m<f.length;++m)(v=f.charCodeAt(m))==34?d=!d:!d&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m]);if(!v.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m])}return v.sort(function(g,E){return g[0]-E[0]||n[g[1]]-n[E[1]]}),r[v.pop()[1]]||44}function s(f,h){var d=h||{},m="",v=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=i(f.slice(0,1024)):d&&d.FS?m=d.FS:m=i(f.slice(0,1024));var E=0,w=0,T=0,_=0,N=0,z=m.charCodeAt(0),B=!1,y=0,k=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=d.dateNF!=null?ZO(d.dateNF):null;function I(){var R=f.slice(_,N),C={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)C.t="z";else if(d.raw)C.t="s",C.v=R;else if(R.trim().length===0)C.t="s",C.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(C.t="s",C.v=R.slice(2,-1).replace(/""/g,'"')):I5(R)?(C.t="n",C.f=R.slice(1)):(C.t="s",C.v=R);else if(R=="TRUE")C.t="b",C.v=!0;else if(R=="FALSE")C.t="b",C.v=!1;else if(!isNaN(T=Dn(R)))C.t="n",d.cellText!==!1&&(C.w=R),C.v=T;else if(!isNaN(Ao(R).getDate())||A&&R.match(A)){C.z=d.dateNF||Ne[14];var F=0;A&&R.match(A)&&(R=e6(R,d.dateNF,R.match(A)||[]),F=1),d.cellDates?(C.t="d",C.v=$t(R,F)):(C.t="n",C.v=Rr($t(R,F))),d.cellText!==!1&&(C.w=_n(C.z,C.v instanceof Date?Rr(C.v):C.v)),d.cellNF||delete C.z}else C.t="s",C.v=R;if(C.t=="z"||(d.dense?(v[E]||(v[E]=[]),v[E][w]=C):v[Fe({c:w,r:E})]=C),_=N+1,k=f.charCodeAt(_),g.e.c<w&&(g.e.c=w),g.e.r<E&&(g.e.r=E),y==z)++w;else if(w=0,++E,d.sheetRows&&d.sheetRows<=E)return!0}e:for(;N<f.length;++N)switch(y=f.charCodeAt(N)){case 34:k===34&&(B=!B);break;case z:case 10:case 13:if(!B&&I())break e;break}return N-_>0&&I(),v["!ref"]=$e(g),v}function a(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,h):Vo(e(f,h),h)}function o(f,h){var d="",m=h.type=="string"?[0,0,0,0]:jg(f,h);switch(h.type){case"base64":d=rn(f);break;case"binary":d=f;break;case"buffer":h.codepage==65001?d=f.toString("utf8"):h.codepage&&typeof Gi<"u"?d=Gi.utils.decode(h.codepage,f):d=ze&&Buffer.isBuffer(f)?f.toString("binary"):_a(f);break;case"array":d=oa(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=nt(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=nt(d):h.type=="binary"&&typeof Gi<"u"&&h.codepage&&(d=Gi.utils.decode(h.codepage,Gi.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?zM.to_sheet(h.type=="string"?d:nt(d),h):a(d,h)}function c(f,h){return As(o(f,h),h)}function l(f){for(var h=[],d=kt(f["!ref"]),m,v=Array.isArray(f),g=d.s.r;g<=d.e.r;++g){for(var E=[],w=d.s.c;w<=d.e.c;++w){var T=Fe({r:g,c:w});if(m=v?(f[g]||[])[w]:f[T],!m||m.v==null){E.push("          ");continue}for(var _=(m.w||(Ci(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";E.push(_+(w===0?" ":""))}h.push(E.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function HM(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=BM.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return xl.to_workbook(t,e)}}var Bc=function(){function t(b,K,j){if(b){Yt(b,b.l||0);for(var H=j.Enum||ce;b.l<b.length;){var ee=b.read_shift(2),le=H[ee]||H[65535],ye=b.read_shift(2),de=b.l+ye,se=le.f&&le.f(b,ye,j);if(b.l=de,K(se,le,ee))return}}}function e(b,K){switch(K.type){case"base64":return r(In(rn(b)),K);case"binary":return r(In(b),K);case"buffer":case"array":return r(b,K)}throw"Unsupported type "+K.type}function r(b,K){if(!b)return b;var j=K||{},H=j.dense?[]:{},ee="Sheet1",le="",ye=0,de={},se=[],Me=[],U={s:{r:0,c:0},e:{r:0,c:0}},it=j.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)j.Enum=ce,t(b,function(pe,dt,Er){switch(Er){case 0:j.vers=pe,pe>=4096&&(j.qpro=!0);break;case 6:U=pe;break;case 204:pe&&(le=pe);break;case 222:le=pe;break;case 15:case 51:j.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Er==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=j.dateNF||Ne[14],j.cellDates&&(pe[1].t="d",pe[1].v=G0(pe[1].v))),j.qpro&&pe[3]>ye&&(H["!ref"]=$e(U),de[ee]=H,se.push(ee),H=j.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ye=pe[3],ee=le||"Sheet"+(ye+1),le="");var Hr=j.dense?(H[pe[0].r]||[])[pe[0].c]:H[Fe(pe[0])];if(Hr){Hr.t=pe[1].t,Hr.v=pe[1].v,pe[1].z!=null&&(Hr.z=pe[1].z),pe[1].f!=null&&(Hr.f=pe[1].f);break}j.dense?(H[pe[0].r]||(H[pe[0].r]=[]),H[pe[0].r][pe[0].c]=pe[1]):H[Fe(pe[0])]=pe[1];break}},j);else if(b[2]==26||b[2]==14)j.Enum=xe,b[2]==14&&(j.qpro=!0,b.l=0),t(b,function(pe,dt,Er){switch(Er){case 204:ee=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>ye&&(H["!ref"]=$e(U),de[ee]=H,se.push(ee),H=j.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ye=pe[3],ee="Sheet"+(ye+1)),it>0&&pe[0].r>=it)break;j.dense?(H[pe[0].r]||(H[pe[0].r]=[]),H[pe[0].r][pe[0].c]=pe[1]):H[Fe(pe[0])]=pe[1],U.e.c<pe[0].c&&(U.e.c=pe[0].c),U.e.r<pe[0].r&&(U.e.r=pe[0].r);break;case 27:pe[14e3]&&(Me[pe[14e3][0]]=pe[14e3][1]);break;case 1537:Me[pe[0]]=pe[1],pe[0]==ye&&(ee=pe[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(H["!ref"]=$e(U),de[le||ee]=H,se.push(le||ee),!Me.length)return{SheetNames:se,Sheets:de};for(var Ve={},Xe=[],Le=0;Le<Me.length;++Le)de[se[Le]]?(Xe.push(Me[Le]||se[Le]),Ve[Me[Le]]=de[Me[Le]]||de[se[Le]]):(Xe.push(Me[Le]),Ve[Me[Le]]={"!ref":"A1"});return{SheetNames:Xe,Sheets:Ve}}function n(b,K){var j=K||{};if(+j.codepage>=0&&Cn(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var H=yp(),ee=kt(b["!ref"]),le=Array.isArray(b),ye=[];Tn(H,0,s(1030)),Tn(H,6,c(ee));for(var de=Math.min(ee.e.r,8191),se=ee.s.r;se<=de;++se)for(var Me=tr(se),U=ee.s.c;U<=ee.e.c;++U){se===ee.s.r&&(ye[U]=bt(U));var it=ye[U]+Me,Ve=le?(b[se]||[])[U]:b[it];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?Tn(H,13,m(se,U,Ve.v)):Tn(H,14,g(se,U,Ve.v));else{var Xe=Ci(Ve);Tn(H,15,h(se,U,Xe.slice(0,239)))}}return Tn(H,1),H.end()}function i(b,K){var j=K||{};if(+j.codepage>=0&&Cn(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var H=yp();Tn(H,0,a(b));for(var ee=0,le=0;ee<b.SheetNames.length;++ee)(b.Sheets[b.SheetNames[ee]]||{})["!ref"]&&Tn(H,27,W(b.SheetNames[ee],le++));var ye=0;for(ee=0;ee<b.SheetNames.length;++ee){var de=b.Sheets[b.SheetNames[ee]];if(!(!de||!de["!ref"])){for(var se=kt(de["!ref"]),Me=Array.isArray(de),U=[],it=Math.min(se.e.r,8191),Ve=se.s.r;Ve<=it;++Ve)for(var Xe=tr(Ve),Le=se.s.c;Le<=se.e.c;++Le){Ve===se.s.r&&(U[Le]=bt(Le));var pe=U[Le]+Xe,dt=Me?(de[Ve]||[])[Le]:de[pe];if(!(!dt||dt.t=="z"))if(dt.t=="n")Tn(H,23,I(Ve,Le,ye,dt.v));else{var Er=Ci(dt);Tn(H,22,y(Ve,Le,ye,Er.slice(0,239)))}}++ye}}return Tn(H,1),H.end()}function s(b){var K=Ot(2);return K.write_shift(2,b),K}function a(b){var K=Ot(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var j=0,H=0,ee=0,le=0;le<b.SheetNames.length;++le){var ye=b.SheetNames[le],de=b.Sheets[ye];if(!(!de||!de["!ref"])){++ee;var se=bo(de["!ref"]);j<se.e.r&&(j=se.e.r),H<se.e.c&&(H=se.e.c)}}return j>8191&&(j=8191),K.write_shift(2,j),K.write_shift(1,ee),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(b,K,j){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&j.qpro?(H.s.c=b.read_shift(1),b.l++,H.s.r=b.read_shift(2),H.e.c=b.read_shift(1),b.l++,H.e.r=b.read_shift(2),H):(H.s.c=b.read_shift(2),H.s.r=b.read_shift(2),K==12&&j.qpro&&(b.l+=2),H.e.c=b.read_shift(2),H.e.r=b.read_shift(2),K==12&&j.qpro&&(b.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(b){var K=Ot(8);return K.write_shift(2,b.s.c),K.write_shift(2,b.s.r),K.write_shift(2,b.e.c),K.write_shift(2,b.e.r),K}function l(b,K,j){var H=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(H[0].c=b.read_shift(1),H[3]=b.read_shift(1),H[0].r=b.read_shift(2),b.l+=2):(H[2]=b.read_shift(1),H[0].c=b.read_shift(2),H[0].r=b.read_shift(2)),H}function f(b,K,j){var H=b.l+K,ee=l(b,K,j);if(ee[1].t="s",j.vers==20768){b.l++;var le=b.read_shift(1);return ee[1].v=b.read_shift(le,"utf8"),ee}return j.qpro&&b.l++,ee[1].v=b.read_shift(H-b.l,"cstr"),ee}function h(b,K,j){var H=Ot(7+j.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,b),H.write_shift(1,39);for(var ee=0;ee<H.length;++ee){var le=j.charCodeAt(ee);H.write_shift(1,le>=128?95:le)}return H.write_shift(1,0),H}function d(b,K,j){var H=l(b,K,j);return H[1].v=b.read_shift(2,"i"),H}function m(b,K,j){var H=Ot(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,b),H.write_shift(2,j,"i"),H}function v(b,K,j){var H=l(b,K,j);return H[1].v=b.read_shift(8,"f"),H}function g(b,K,j){var H=Ot(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,b),H.write_shift(8,j,"f"),H}function E(b,K,j){var H=b.l+K,ee=l(b,K,j);if(ee[1].v=b.read_shift(8,"f"),j.qpro)b.l=H;else{var le=b.read_shift(2);N(b.slice(b.l,b.l+le),ee),b.l+=le}return ee}function w(b,K,j){var H=K&32768;return K&=-32769,K=(H?b:0)+(K>=8192?K-16384:K),(H?"":"$")+(j?bt(K):tr(K))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(b,K){Yt(b,0);for(var j=[],H=0,ee="",le="",ye="",de="";b.l<b.length;){var se=b[b.l++];switch(se){case 0:j.push(b.read_shift(8,"f"));break;case 1:le=w(K[0].c,b.read_shift(2),!0),ee=w(K[0].r,b.read_shift(2),!1),j.push(le+ee);break;case 2:{var Me=w(K[0].c,b.read_shift(2),!0),U=w(K[0].r,b.read_shift(2),!1);le=w(K[0].c,b.read_shift(2),!0),ee=w(K[0].r,b.read_shift(2),!1),j.push(Me+U+":"+le+ee)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(b.read_shift(2));break;case 6:{for(var it="";se=b[b.l++];)it+=String.fromCharCode(se);j.push('"'+it.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:de=j.pop(),ye=j.pop(),j.push(["AND","OR"][se-20]+"("+ye+","+de+")");break;default:if(se<32&&_[se])de=j.pop(),ye=j.pop(),j.push(ye+_[se]+de);else if(T[se]){if(H=T[se][1],H==69&&(H=b[b.l++]),H>j.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+j.join("|")+"|");return}var Ve=j.slice(-H);j.length-=H,j.push(T[se][0]+"("+Ve.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}j.length==1?K[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function z(b){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=b.read_shift(2),K[3]=b[b.l++],K[0].c=b[b.l++],K}function B(b,K){var j=z(b);return j[1].t="s",j[1].v=b.read_shift(K-4,"cstr"),j}function y(b,K,j,H){var ee=Ot(6+H.length);ee.write_shift(2,b),ee.write_shift(1,j),ee.write_shift(1,K),ee.write_shift(1,39);for(var le=0;le<H.length;++le){var ye=H.charCodeAt(le);ee.write_shift(1,ye>=128?95:ye)}return ee.write_shift(1,0),ee}function k(b,K){var j=z(b);j[1].v=b.read_shift(2);var H=j[1].v>>1;if(j[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return j[1].v=H,j}function A(b,K){var j=z(b),H=b.read_shift(4),ee=b.read_shift(4),le=b.read_shift(2);if(le==65535)return H===0&&ee===3221225472?(j[1].t="e",j[1].v=15):H===0&&ee===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var ye=le&32768;return le=(le&32767)-16446,j[1].v=(1-ye*2)*(ee*Math.pow(2,le+32)+H*Math.pow(2,le)),j}function I(b,K,j,H){var ee=Ot(14);if(ee.write_shift(2,b),ee.write_shift(1,j),ee.write_shift(1,K),H==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var le=0,ye=0,de=0,se=0;return H<0&&(le=1,H=-H),ye=Math.log2(H)|0,H/=Math.pow(2,ye-31),se=H>>>0,se&2147483648||(H/=2,++ye,se=H>>>0),H-=se,se|=2147483648,se>>>=0,H*=Math.pow(2,32),de=H>>>0,ee.write_shift(4,de),ee.write_shift(4,se),ye+=16383+(le?32768:0),ee.write_shift(2,ye),ee}function R(b,K){var j=A(b);return b.l+=K-14,j}function C(b,K){var j=z(b),H=b.read_shift(4);return j[1].v=H>>6,j}function F(b,K){var j=z(b),H=b.read_shift(8,"f");return j[1].v=H,j}function ve(b,K){var j=F(b);return b.l+=K-10,j}function ue(b,K){return b[b.l+K-1]==0?b.read_shift(K,"cstr"):""}function Ee(b,K){var j=b[b.l++];j>K-1&&(j=K-1);for(var H="";H.length<j;)H+=String.fromCharCode(b[b.l++]);return H}function me(b,K,j){if(!(!j.qpro||K<21)){var H=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var ee=b.read_shift(K-21,"cstr");return[H,ee]}}function ie(b,K){for(var j={},H=b.l+K;b.l<H;){var ee=b.read_shift(2);if(ee==14e3){for(j[ee]=[0,""],j[ee][0]=b.read_shift(2);b[b.l];)j[ee][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return j}function W(b,K){var j=Ot(5+b.length);j.write_shift(2,14e3),j.write_shift(2,K);for(var H=0;H<b.length;++H){var ee=b.charCodeAt(H);j[j.l++]=ee>127?95:ee}return j[j.l++]=0,j}var ce={0:{n:"BOF",f:Ft},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function WM(t){var e={},r=t.match(yr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ie(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Eg[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var $M=function(){var t=vl("t"),e=vl("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Ge(a[1])},c=s.match(e);return c&&(o.s=WM(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),jM=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),GM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KM=/<(?:\w+:)?r>/,qM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ge(nt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nt(t),r&&(n.h=Cg(n.t))):t.match(KM)&&(n.r=nt(t),n.t=Ge(nt((t.replace(qM,"").match(GM)||[]).join("").replace(yr,""))),r&&(n.h=jM($M(n.r)))),n):{t:""}}var XM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YM=/<(?:\w+:)?(?:si|sstItem)>/g,QM=/<\/(?:\w+:)?(?:si|sstItem)>/;function JM(t,e){var r=[],n="";if(!t)return r;var i=t.match(XM);if(i){n=i[2].replace(YM,"").split(QM);for(var s=0;s!=n.length;++s){var a=Vg(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Ie(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function ZM(t){return[t.read_shift(4),t.read_shift(4)]}function e8(t,e){var r=[],n=!1;return Pi(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function sA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function xi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function t8(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=xi(t,4),e.U=xi(t,4),e.W=xi(t,4),e}function r8(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function n8(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(r8(t));return e}function i8(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function s8(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=xi(t,4),e.U=xi(t,4),e.W=xi(t,4),e}function a8(t){var e=s8(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function aA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function oA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function o8(t){var e=xi(t);switch(e.Minor){case 2:return[e.Minor,c8(t)];case 3:return[e.Minor,l8()];case 4:return[e.Minor,u8(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function c8(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=aA(t,r),i=oA(t,t.length-t.l);return{t:"Std",h:n,v:i}}function l8(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u8(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(yr,function(s){var a=Ie(s);switch(ri(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function f8(t,e){var r={},n=r.EncryptionVersionInfo=xi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=aA(t,i),e-=i,r.EncryptionVerifier=oA(t,e),r}function h8(t){var e={},r=e.EncryptionVersionInfo=xi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function d8(t){var e=0,r,n=sA(t),i=n.length+1,s,a,o,c,l;for(r=_s(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var cA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var f=a[l],h=0;h!=7;++h)f&64&&(o^=r[c]),f*=2,--c;return o};return function(a){for(var o=sA(a),c=s(o),l=o.length,f=_s(16),h=0;h!=16;++h)f[h]=0;var d,m,v;for((l&1)===1&&(d=c>>8,f[l]=i(t[0],d),--l,d=c&255,m=o[o.length-1],f[l]=i(m,d));l>0;)--l,d=c>>8,f[l]=i(o[l],d),--l,d=c&255,f[l]=i(o[l],d);for(l=15,v=15-o.length;v>0;)d=c>>8,f[l]=i(t[v],d),--l,--v,d=c&255,f[l]=i(o[l],d),--l,--v;return f}}(),p8=function(t,e,r,n,i){i||(i=e),n||(n=cA(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},m8=function(t){var e=0,r=cA(t);return function(n){var i=p8("",n,e,r);return e=i[1],i[0]}};function g8(t,e,r,n){var i={key:Ft(t),verificationBytes:Ft(t)};return r.password&&(i.verifier=d8(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=m8(r.password)),i}function v8(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=h8(t):n.Data=f8(t,e),n}function _8(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?v8(t,e-2,n):g8(t,r.biff>=8?e:e-2,r,n),n}var x8=function(){function t(i,s){switch(s.type){case"base64":return e(rn(i),s);case"binary":return e(i,s);case"buffer":return e(ze&&Buffer.isBuffer(i)?i.toString("binary"):_a(i),s);case"array":return e(oa(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,v,g=-1;v=d.exec(f);){switch(v[0]){case"\\cell":var E=f.slice(m,d.lastIndex-v[0].length);if(E[0]==" "&&(E=E.slice(1)),++g,E.length){var w={v:E,t:"s"};Array.isArray(o)?o[h][g]=w:o[Fe({r:h,c:g})]=w}break}m=d.lastIndex}g>l.e.c&&(l.e.c=g)}),o["!ref"]=$e(l),o}function r(i,s){return As(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=kt(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var h=Fe({r:l,c:f});o=c?(i[l]||[])[f]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Ci(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function y8(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function yl(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function E8(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function w8(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function n0(t,e){if(e===0)return t;var r=E8(y8(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),yl(w8(r))}var lA=6,T8=15,k8=1,Ar=lA;function i0(t){return Math.floor((t+Math.round(128/Ar)/256)*Ar)}function s0(t){return Math.floor((t-5)/Ar*100+.5)/100}function kp(t){return Math.round((t*Ar+5)/Ar*256)/256}function Yh(t){return kp(s0(i0(t)))}function Bg(t){var e=Math.abs(t-Yh(t)),r=Ar;if(e>.005)for(Ar=k8;Ar<T8;++Ar)Math.abs(t-Yh(t))<=e&&(e=Math.abs(t-Yh(t)),r=Ar);Ar=r}function So(t){t.width?(t.wpx=i0(t.width),t.wch=s0(t.wpx),t.MDW=Ar):t.wpx?(t.wch=s0(t.wpx),t.width=kp(t.wch),t.MDW=Ar):typeof t.wch=="number"&&(t.width=kp(t.wch),t.wpx=i0(t.width),t.MDW=Ar),t.customWidth&&delete t.customWidth}var A8=96,uA=A8;function fA(t){return t*96/uA}function El(t){return t*uA/96}var S8={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function I8(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(yr)||[]).forEach(function(a){var o=Ie(a);switch(ri(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=ft(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=ft(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function C8(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(yr)||[]).forEach(function(a){var o=Ie(a);switch(ri(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function R8(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(yr)||[]).forEach(function(a){var o=Ie(a);switch(ri(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=nt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?ft(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?ft(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?ft(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?ft(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?ft(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?ft(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?ft(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Eg[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=ft(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=Ks[i.color.index];i.color.index==81&&(c=Ks[1]),c||(c=Ks[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=n0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function P8(t,e,r){e.NumberFmt=[];for(var n=ti(Ne),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Ne[n[i]];var s=t[0].match(yr);if(s)for(i=0;i<s.length;++i){var a=Ie(s[i]);switch(ri(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ge(nt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Gs(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var bu=["numFmtId","fillId","fontId","borderId","xfId"],Vu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function F8(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(yr)||[]).forEach(function(s){var a=Ie(s),o=0;switch(ri(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<bu.length;++o)n[bu[o]]&&(n[bu[o]]=parseInt(n[bu[o]],10));for(o=0;o<Vu.length;++o)n[Vu[o]]&&(n[Vu[o]]=ft(n[Vu[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=ft(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var D8=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&P8(h,f,l),(h=o.match(i))&&R8(h,f,c,l),(h=o.match(n))&&C8(h,f,c,l),(h=o.match(s))&&I8(h,f,c,l),(h=o.match(r))&&F8(h,f,l),f}}();function N8(t,e){var r=t.read_shift(2),n=gr(t);return[r,n]}function O8(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=$6(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=W6(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=gr(t),n}var L8=xr;function M8(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var b8=xr;function V8(t,e,r){var n={};n.NumberFmt=[];for(var i in Ne)n.NumberFmt[i]=Ne[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Pi(t,function(c,l,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],Gs(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=n0(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(f);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var B8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function U8(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(yr)||[]).forEach(function(i){var s=Ie(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[B8.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function z8(){}function H8(){}var W8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,$8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,j8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function G8(t,e,r){e.themeElements={};var n;[["clrScheme",W8,U8],["fontScheme",$8,z8],["fmtScheme",j8,H8]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var K8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hA(t,e){(!t||t.length===0)&&(t=q8());var r,n={};if(!(r=t.match(K8)))throw new Error("themeElements not found in theme");return G8(r[0],n,e),n.raw=t,n}function q8(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Tk];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function X8(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=wk(s,{type:"array"})}catch{return}var o=Xr(a,"theme/theme/theme1.xml",!0);if(o)return hA(o,r)}}function Y8(t){return t.read_shift(4)}function Q8(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=J8(t,4);break;case 2:e.xclrValue=Jk(t);break;case 3:e.xclrValue=Y8(t);break;case 4:t.l+=4;break}return t.l+=8,e}function J8(t,e){return xr(t,e)}function Z8(t,e){return xr(t,e)}function e5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Q8(t);break;case 6:n[1]=Z8(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function t5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(e5(t,r-t.l));return{ixfe:n,ext:s}}function r5(t,e){e.forEach(function(r){switch(r[0]){}})}function n5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:gr(t)}}function i5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function s5(t){return t.l+=4,t.read_shift(4)!=0}function a5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Pi(t,function(c,l,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function o5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(yr,function(o){var c=Ie(o);switch(ri(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function c5(t){var e=[];if(!t)return e;var r=1;return(t.match(yr)||[]).forEach(function(n){var i=Ie(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function l5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Fe(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function u5(t,e,r){var n=[];return Pi(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function f5(t,e,r,n){if(!t)return t;var i=n||{},s=!1;Pi(t,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},i)}function h5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function Wx(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Sr(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var c=kt(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=$e(c);l!==t["!ref"]&&(t["!ref"]=l)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}s.c.push(f)})}function d5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ie(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Sr(c.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&Vg(h[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function p5(t,e){var r=[],n=!1,i={},s=0;return t.replace(yr,function(o,c){var l=Ie(o);switch(ri(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function m5(t,e){var r=[],n=!1;return t.replace(yr,function(s){var a=Ie(s);switch(ri(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function g5(t){var e={};e.iauthor=t.read_shift(4);var r=ya(t);return e.rfx=r.s,e.ref=Fe(r.s),t.l+=16,e}var v5=gr;function _5(t,e){var r=[],n=[],i={},s=!1;return Pi(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}var x5="application/vnd.ms-office.vbaProject";function y5(t){var e=We.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(e,i,t.FileIndex[n].content)}}),We.write(e)}function E5(){return{"!type":"dialog"}}function w5(){return{"!type":"dialog"}}function T5(){return{"!type":"macro"}}function k5(){return{"!type":"macro"}}var oo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,c?l+=e.r:--l,i+(o?"":"$")+bt(f)+(c?"":"$")+tr(l)}return function(i,s){return e=s,i.replace(t,r)}}(),dA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,A5=function(){return function(e,r){return e.replace(dA,function(n,i,s,a,o,c){var l=Dg(a)-(s?0:r.c),f=Fg(c)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+h+"C"+d})}}();function pA(t,e){return t.replace(dA,function(r,n,i,s,a,o){return n+(i=="$"?i+s:bt(Dg(s)+e.c))+(a=="$"?a+o:tr(Fg(o)+e.r))})}function S5(t,e,r){var n=bo(e),i=n.s,s=Sr(r),a={r:s.r-i.r,c:s.c-i.c};return pA(t,a)}function I5(t){return t.length!=1}function $x(t){return t.replace(/_xlfn\./g,"")}function Ct(t){t.l+=1}function xs(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function mA(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return gA(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=xs(t,2),o=xs(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function gA(t){var e=xs(t,2),r=xs(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function C5(t,e,r){if(r.biff<8)return gA(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=xs(t,2),a=xs(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function vA(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return R5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=xs(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function R5(t){var e=xs(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function P5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return D5(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function D5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function N5(t,e,r){var n=(t[t.l++]&96)>>5,i=mA(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=mA(t,s,r);return[n,i,a]}function L5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function M5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function b5(t,e,r){var n=(t[t.l++]&96)>>5,i=C5(t,e-1,r);return[n,i]}function V5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jx(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function B5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function U5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function z5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function H5(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function W5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function _A(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function $5(t){return t.read_shift(2),_A(t)}function j5(t){return t.read_shift(2),_A(t)}function G5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=vA(t,0,r);return[n,i]}function K5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=F5(t,0,r);return[n,i]}function q5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=vA(t,0,r);return[n,i,s]}function X5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[Y9[i],EA[i],n]}function Y5(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Q5(t);return[i,(s[0]===0?EA:X9)[s[1]]]}function Q5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function J5(t,e,r){t.l+=r&&r.biff==2?3:4}function Z5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function e9(t){return t.l++,Ea[t.read_shift(1)]}function t9(t){return t.l++,t.read_shift(2)}function r9(t){return t.l++,t.read_shift(1)!==0}function n9(t){return t.l++,pr(t)}function i9(t,e,r){return t.l++,Hl(t,e-1,r)}function s9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=At(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ea[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=pr(t);break;case 2:r[1]=wa(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function a9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ya:K0)(t));return i}function o9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=s9(t,r.biff);return a}function c9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function l9(t,e,r){if(r.biff==5)return u9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function u9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function f9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function h9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function d9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function p9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var m9=xr,g9=xr,v9=xr;function $l(t,e,r){return t.l+=2,[P5(t)]}function Ug(t){return t.l+=6,[]}var _9=$l,x9=Ug,y9=Ug,E9=$l;function xA(t){return t.l+=2,[Ft(t),t.read_shift(2)&1]}var w9=$l,T9=xA,k9=Ug,A9=$l,S9=$l,I9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function C9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=I9[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function R9(t){return t.l+=2,[t.read_shift(4)]}function P9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function F9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function D9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function N9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function O9(t){return t.l+=4,[0,0]}var Gx={1:{n:"PtgExp",f:Z5},2:{n:"PtgTbl",f:v9},3:{n:"PtgAdd",f:Ct},4:{n:"PtgSub",f:Ct},5:{n:"PtgMul",f:Ct},6:{n:"PtgDiv",f:Ct},7:{n:"PtgPower",f:Ct},8:{n:"PtgConcat",f:Ct},9:{n:"PtgLt",f:Ct},10:{n:"PtgLe",f:Ct},11:{n:"PtgEq",f:Ct},12:{n:"PtgGe",f:Ct},13:{n:"PtgGt",f:Ct},14:{n:"PtgNe",f:Ct},15:{n:"PtgIsect",f:Ct},16:{n:"PtgUnion",f:Ct},17:{n:"PtgRange",f:Ct},18:{n:"PtgUplus",f:Ct},19:{n:"PtgUminus",f:Ct},20:{n:"PtgPercent",f:Ct},21:{n:"PtgParen",f:Ct},22:{n:"PtgMissArg",f:Ct},23:{n:"PtgStr",f:i9},26:{n:"PtgSheet",f:P9},27:{n:"PtgEndSheet",f:F9},28:{n:"PtgErr",f:e9},29:{n:"PtgBool",f:r9},30:{n:"PtgInt",f:t9},31:{n:"PtgNum",f:n9},32:{n:"PtgArray",f:V5},33:{n:"PtgFunc",f:X5},34:{n:"PtgFuncVar",f:Y5},35:{n:"PtgName",f:c9},36:{n:"PtgRef",f:G5},37:{n:"PtgArea",f:N5},38:{n:"PtgMemArea",f:f9},39:{n:"PtgMemErr",f:m9},40:{n:"PtgMemNoMem",f:g9},41:{n:"PtgMemFunc",f:h9},42:{n:"PtgRefErr",f:d9},43:{n:"PtgAreaErr",f:L5},44:{n:"PtgRefN",f:K5},45:{n:"PtgAreaN",f:b5},46:{n:"PtgMemAreaN",f:D9},47:{n:"PtgMemNoMemN",f:N9},57:{n:"PtgNameX",f:l9},58:{n:"PtgRef3d",f:q5},59:{n:"PtgArea3d",f:O5},60:{n:"PtgRefErr3d",f:p9},61:{n:"PtgAreaErr3d",f:M5},255:{}},L9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},M9={1:{n:"PtgElfLel",f:xA},2:{n:"PtgElfRw",f:A9},3:{n:"PtgElfCol",f:_9},6:{n:"PtgElfRwV",f:S9},7:{n:"PtgElfColV",f:E9},10:{n:"PtgElfRadical",f:w9},11:{n:"PtgElfRadicalS",f:k9},13:{n:"PtgElfColS",f:x9},15:{n:"PtgElfColSV",f:y9},16:{n:"PtgElfRadicalLel",f:T9},25:{n:"PtgList",f:C9},29:{n:"PtgSxName",f:R9},255:{}},b9={0:{n:"PtgAttrNoop",f:O9},1:{n:"PtgAttrSemi",f:W5},2:{n:"PtgAttrIf",f:z5},4:{n:"PtgAttrChoose",f:B5},8:{n:"PtgAttrGoto",f:U5},16:{n:"PtgAttrSum",f:J5},32:{n:"PtgAttrBaxcel",f:jx},33:{n:"PtgAttrBaxcel",f:jx},64:{n:"PtgAttrSpace",f:$5},65:{n:"PtgAttrSpaceSemi",f:j5},128:{n:"PtgAttrIfError",f:H5},255:{}};function jl(t,e,r,n){if(n.biff<8)return xr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=o9(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=a9(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(xr(t,e)),s}function Gl(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=Gx[s]||Gx[L9[s]],(s===24||s===25)&&(i=(s===24?M9:b9)[t[t.l+1]]),!i||!i.f?xr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function V9(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var B9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function U9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function yA(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Kx(t,e,r){var n=yA(t,e,r);return n=="#REF"?n:U9(n,r)}function fr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,f,h=0,d=0,m,v="";if(!t[0]||!t[0][0])return"";for(var g=-1,E="",w=0,T=t[0].length;w<T;++w){var _=t[0][w];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:E=wt(" ",t[0][g][1][1]);break;case 1:E=wt("\r",t[0][g][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}l=l+E,g=-1}o.push(l+B9[_[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Lc(_[1][1],a,i),o.push(Mc(f,s));break;case"PtgRefN":f=r?Lc(_[1][1],r,i):_[1][1],o.push(Mc(f,s));break;case"PtgRef3d":h=_[1][1],f=Lc(_[1][2],a,i),v=Kx(n,h,i),o.push(v+"!"+Mc(f,s));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],z=_[1][1];N||(N=0),N&=127;var B=N==0?[]:o.slice(-N);o.length-=N,z==="User"&&(z=B.shift()),o.push(z+"("+B.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":m=Ix(_[1][1],r?{s:r}:a,i),o.push(qh(m,i));break;case"PtgArea":m=Ix(_[1][1],a,i),o.push(qh(m,i));break;case"PtgArea3d":h=_[1][1],m=_[1][2],v=Kx(n,h,i),o.push(v+"!"+qh(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=_[1][2];var y=(n.names||[])[d-1]||(n[0]||[])[d],k=y?y.Name:"SH33TJSNAME"+String(d);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),o.push(k);break;case"PtgNameX":var A=_[1][1];d=_[1][2];var I;if(i.biff<=5)A<0&&(A=-A),n[A]&&(I=n[A][d]);else{var R="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][d]&&n[A][d].itab>0&&(R=n.SheetNames[n[A][d].itab-1]+"!"):R=n.SheetNames[d-1]+"!"),n[A]&&n[A][d])R+=n[A][d].Name;else if(n[0]&&n[0][d])R+=n[0][d].Name;else{var C=(yA(n,A,i)||"").split(";;");C[d-1]?R=C[d-1]:R+="SH33TJSERRX"}o.push(R);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var F="(",ve=")";if(g>=0){switch(E="",t[0][g][1][0]){case 2:F=wt(" ",t[0][g][1][1])+F;break;case 3:F=wt("\r",t[0][g][1][1])+F;break;case 4:ve=wt(" ",t[0][g][1][1])+ve;break;case 5:ve=wt("\r",t[0][g][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(F+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Fe(f)]){var Ee=n.sharedf[Fe(f)];o.push(fr(Ee,a,ue,n,i))}else{var me=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){o.push(fr(l[1],a,ue,n,i)),me=!0;break}me||o.push(_[1])}break;case"PtgArray":o.push("{"+V9(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&ie.indexOf(t[0][w][0])==-1){_=t[0][g];var W=!0;switch(_[1][0]){case 4:W=!1;case 0:E=wt(" ",_[1][1]);break;case 5:W=!1;case 1:E=wt("\r",_[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((W?E:"")+o.pop()+(W?"":E)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function z9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xr(t,e-2)];var o=Gl(t,a,r);return e!==a+i&&(s=jl(t,e-a-i,o,r)),t.l=n,[o,s]}function H9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],xr(t,e-2)];var o=Gl(t,a,r);return e!==a+i&&(s=jl(t,e-a-i,o,r)),t.l=n,[o,s]}function W9(t,e,r,n){var i=t.l+e,s=Gl(t,n,r),a;return i!==t.l&&(a=jl(t,i-t.l,s,r)),[s,a]}function $9(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Gl(t,s,r);return s==65535?[[],xr(t,e-2)]:(e!==s+2&&(i=jl(t,n-s-2,a,r)),[a,i])}function j9(t){var e;if(gi(t,t.l+6)!==65535)return[pr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Qh(t,e,r){var n=t.l+e,i=ni(t);r.biff==2&&++t.l;var s=j9(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=H9(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function q0(t,e,r){var n=t.read_shift(4),i=Gl(t,n,r),s=t.read_shift(4),a=s>0?jl(t,s,i,r):null;return[i,a]}var G9=q0,X0=q0,K9=q0,q9=q0,X9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},EA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Y9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function qx(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Jh(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Uc={},co={};function zc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function wA(t,e,r,n,i,s){try{n.cellNF&&(t.z=Ne[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=$t(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ne[e]==null&&Gs(JO[e]||"General",e),t.t==="e")t.w=t.w||Ea[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=gl(t.v);else if(t.t==="d"){var a=Rr(t.v);(a|0)===a?t.w=a.toString(10):t.w=gl(a)}else{if(t.v===void 0)return"";t.w=aa(t.v,co)}else t.t==="d"?t.w=_n(e,Rr(t.v),co):t.w=_n(e,t.v,co)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=n0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=n0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Q9(t,e){var r=kt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=$e(r))}var J9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Z9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,eb=/<(?:\w:)?hyperlink [^>]*>/mg,tb=/"(\w*:\w*)"/,rb=/<(?:\w:)?col\b[^>]*[\/]?>/g,nb=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,ib=/<(?:\w:)?pageMargins[^>]*\/>/g,TA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sb=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,ab=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ob(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",h=t.match(Z9);h?(l=t.slice(0,h.index),f=t.slice(h.index+h[0].length)):l=f=t;var d=l.match(TA);d?zg(d[0],o,i,r):(d=l.match(sb))&&cb(d[0],d[1]||"",o,i,r);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=l.slice(m,m+50).match(tb);v&&Q9(o,v[1])}var g=l.match(ab);g&&g[1]&&pb(g[1],i);var E=[];if(e.cellStyles){var w=l.match(rb);w&&fb(E,w)}h&&mb(h[1],o,e,c,s,a);var T=f.match(nb);T&&(o["!autofilter"]=hb(T[0]));var _=[],N=f.match(J9);if(N)for(m=0;m!=N.length;++m)_[m]=kt(N[m].slice(N[m].indexOf('"')+1));var z=f.match(eb);z&&lb(o,z,n);var B=f.match(ib);if(B&&(o["!margins"]=ub(Ie(B[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=$e(c)),e.sheetRows>0&&o["!ref"]){var y=kt(o["!ref"]);e.sheetRows<=+y.e.r&&(y.e.r=e.sheetRows-1,y.e.r>c.e.r&&(y.e.r=c.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>c.e.c&&(y.e.c=c.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(y))}return E.length>0&&(o["!cols"]=E),_.length>0&&(o["!merges"]=_),o}function zg(t,e,r,n){var i=Ie(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Ge(nt(i.codeName)))}function cb(t,e,r,n,i){zg(t.slice(0,t.indexOf(">")),r,n,i)}function lb(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Ie(nt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Ge(s.location))):(s.Target="#"+Ge(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=kt(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var f=Fe({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function ub(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function fb(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ie(e[n],!0);i.hidden&&(i.hidden=ft(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Bg(i.width)),So(i);s<=a;)t[s++]=er(i)}}function hb(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var db=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function pb(t,e){e.Views||(e.Views=[{}]),(t.match(db)||[]).forEach(function(r,n){var i=Ie(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ft(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var mb=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=vl("v"),a=vl("f");return function(c,l,f,h,d,m){for(var v=0,g="",E=[],w=[],T=0,_=0,N=0,z="",B,y,k=0,A=0,I,R,C=0,F=0,ve=Array.isArray(m.CellXf),ue,Ee=[],me=[],ie=Array.isArray(l),W=[],ce={},xe=!1,b=!!f.sheetStubs,K=c.split(e),j=0,H=K.length;j!=H;++j){g=K[j].trim();var ee=g.length;if(ee!==0){var le=0;e:for(v=0;v<ee;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(y=Ie(g.slice(le,v),!0),k=y.r!=null?parseInt(y.r,10):k+1,A=-1,f.sheetRows&&f.sheetRows<k)continue;ce={},xe=!1,y.ht&&(xe=!0,ce.hpt=parseFloat(y.ht),ce.hpx=El(ce.hpt)),y.hidden=="1"&&(xe=!0,ce.hidden=!0),y.outlineLevel!=null&&(xe=!0,ce.level=+y.outlineLevel),xe&&(W[k-1]=ce)}break;case"<":le=v;break}if(le>=v)break;if(y=Ie(g.slice(le,v),!0),k=y.r!=null?parseInt(y.r,10):k+1,A=-1,!(f.sheetRows&&f.sheetRows<k)){h.s.r>k-1&&(h.s.r=k-1),h.e.r<k-1&&(h.e.r=k-1),f&&f.cellStyles&&(ce={},xe=!1,y.ht&&(xe=!0,ce.hpt=parseFloat(y.ht),ce.hpx=El(ce.hpt)),y.hidden=="1"&&(xe=!0,ce.hidden=!0),y.outlineLevel!=null&&(xe=!0,ce.level=+y.outlineLevel),xe&&(W[k-1]=ce)),E=g.slice(v).split(t);for(var ye=0;ye!=E.length&&E[ye].trim().charAt(0)=="<";++ye);for(E=E.slice(ye),v=0;v!=E.length;++v)if(g=E[v].trim(),g.length!==0){if(w=g.match(r),T=v,_=0,N=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,w!=null&&w.length===2){for(T=0,z=w[1],_=0;_!=z.length&&!((N=z.charCodeAt(_)-64)<1||N>26);++_)T=26*T+N;--T,A=T}else++A;for(_=0;_!=g.length&&g.charCodeAt(_)!==62;++_);if(++_,y=Ie(g.slice(0,_),!0),y.r||(y.r=Fe({r:k-1,c:A})),z=g.slice(_),B={t:""},(w=z.match(s))!=null&&w[1]!==""&&(B.v=Ge(w[1])),f.cellFormula){if((w=z.match(a))!=null&&w[1]!==""){if(B.f=Ge(nt(w[1])).replace(/\r\n/g,`
`),f.xlfn||(B.f=$x(B.f)),w[0].indexOf('t="array"')>-1)B.F=(z.match(i)||[])[1],B.F.indexOf(":")>-1&&Ee.push([kt(B.F),B.F]);else if(w[0].indexOf('t="shared"')>-1){R=Ie(w[0]);var de=Ge(nt(w[1]));f.xlfn||(de=$x(de)),me[parseInt(R.si,10)]=[R,de,y.r]}}else(w=z.match(/<f[^>]*\/>/))&&(R=Ie(w[0]),me[R.si]&&(B.f=S5(me[R.si][1],me[R.si][2],y.r)));var se=Sr(y.r);for(_=0;_<Ee.length;++_)se.r>=Ee[_][0].s.r&&se.r<=Ee[_][0].e.r&&se.c>=Ee[_][0].s.c&&se.c<=Ee[_][0].e.c&&(B.F=Ee[_][1])}if(y.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(b)B.t="z";else continue;else B.t=y.t||"n";switch(h.s.c>A&&(h.s.c=A),h.e.c<A&&(h.e.c=A),B.t){case"n":if(B.v==""||B.v==null){if(!b)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!b)continue;B.t="z"}else I=Uc[parseInt(B.v,10)],B.v=I.t,B.r=I.r,f.cellHTML&&(B.h=I.h);break;case"str":B.t="s",B.v=B.v!=null?nt(B.v):"",f.cellHTML&&(B.h=Cg(B.v));break;case"inlineStr":w=z.match(n),B.t="s",w!=null&&(I=Vg(w[1]))?(B.v=I.t,f.cellHTML&&(B.h=I.h)):B.v="";break;case"b":B.v=ft(B.v);break;case"d":f.cellDates?B.v=$t(B.v,1):(B.v=Rr($t(B.v,1)),B.t="n");break;case"e":(!f||f.cellText!==!1)&&(B.w=B.v),B.v=$k[B.v];break}if(C=F=0,ue=null,ve&&y.s!==void 0&&(ue=m.CellXf[y.s],ue!=null&&(ue.numFmtId!=null&&(C=ue.numFmtId),f.cellStyles&&ue.fillId!=null&&(F=ue.fillId))),wA(B,C,F,f,d,m),f.cellDates&&ve&&B.t=="n"&&Mo(Ne[C])&&(B.t="d",B.v=G0(B.v)),y.cm&&f.xlmeta){var Me=(f.xlmeta.Cell||[])[+y.cm-1];Me&&Me.type=="XLDAPR"&&(B.D=!0)}if(ie){var U=Sr(y.r);l[U.r]||(l[U.r]=[]),l[U.r][U.c]=B}else l[y.r]=B}}}}W.length>0&&(l["!rows"]=W)}}();function gb(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}var vb=ya;function _b(){}function xb(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=z6(t),r}function yb(t){var e=xn(t);return[e]}function Eb(t){var e=xa(t);return[e]}function wb(t){var e=xn(t),r=t.read_shift(1);return[e,r,"b"]}function Tb(t){var e=xa(t),r=t.read_shift(1);return[e,r,"b"]}function kb(t){var e=xn(t),r=t.read_shift(1);return[e,r,"e"]}function Ab(t){var e=xa(t),r=t.read_shift(1);return[e,r,"e"]}function Sb(t){var e=xn(t),r=t.read_shift(4);return[e,r,"s"]}function Ib(t){var e=xa(t),r=t.read_shift(4);return[e,r,"s"]}function Cb(t){var e=xn(t),r=pr(t);return[e,r,"n"]}function kA(t){var e=xa(t),r=pr(t);return[e,r,"n"]}function Rb(t){var e=xn(t),r=Lg(t);return[e,r,"n"]}function Pb(t){var e=xa(t),r=Lg(t);return[e,r,"n"]}function Fb(t){var e=xn(t),r=Ng(t);return[e,r,"is"]}function Db(t){var e=xn(t),r=gr(t);return[e,r,"str"]}function Nb(t){var e=xa(t),r=gr(t);return[e,r,"str"]}function Ob(t,e,r){var n=t.l+e,i=xn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=X0(t,n-t.l,r);a[3]=fr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Lb(t,e,r){var n=t.l+e,i=xn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=X0(t,n-t.l,r);a[3]=fr(o,null,i,r.supbooks,r)}else t.l=n;return a}function Mb(t,e,r){var n=t.l+e,i=xn(t);i.r=r["!row"];var s=pr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=X0(t,n-t.l,r);a[3]=fr(o,null,i,r.supbooks,r)}else t.l=n;return a}function bb(t,e,r){var n=t.l+e,i=xn(t);i.r=r["!row"];var s=gr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=X0(t,n-t.l,r);a[3]=fr(o,null,i,r.supbooks,r)}else t.l=n;return a}var Vb=ya;function Bb(t,e){var r=t.l+e,n=ya(t),i=Og(t),s=gr(t),a=gr(t),o=gr(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function Ub(){}function zb(t,e,r){var n=t.l+e,i=zk(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=G9(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Hb(t,e,r){var n=t.l+e,i=ya(t),s=[i];if(r.cellFormula){var a=q9(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}var Wb=["left","right","top","bottom","header","footer"];function $b(t){var e={};return Wb.forEach(function(r){e[r]=pr(t)}),e}function jb(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Gb(){}function Kb(){}function qb(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var c=o.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,v,g,E,w,T,_,N,z,B=[];o.biff=12,o["!row"]=0;var y=0,k=!1,A=[],I={},R=o.supbooks||i.supbooks||[[]];if(R.sharedf=I,R.arrayf=A,R.SheetNames=i.SheetNames||i.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=R,i.Names))for(var C=0;C<i.Names.length;++C)R[0][C+1]=i.Names[C];var F=[],ve=[],ue=!1;a0[16]={n:"BrtShortReal",f:kA};var Ee;if(Pi(t,function(W,ce,xe){if(!d)switch(xe){case 148:l=W;break;case 0:m=W,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),N=tr(E=m.r),o["!row"]=m.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=El(W.hpt)),ve[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:W[2]},W[2]){case"n":v.v=W[1];break;case"s":_=Uc[W[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!W[1];break;case"e":v.v=W[1],o.cellText!==!1&&(v.w=Ea[v.v]);break;case"str":v.t="s",v.v=W[1];break;case"is":v.t="s",v.v=W[1].t;break}if((g=a.CellXf[W[0].iStyleRef])&&wA(v,g.numFmtId,null,o,s,a),w=W[0].c==-1?w+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][w]=v):c[bt(w)+N]=v,o.cellFormula){for(k=!1,y=0;y<A.length;++y){var b=A[y];m.r>=b[0].s.r&&m.r<=b[0].e.r&&w>=b[0].s.c&&w<=b[0].e.c&&(v.F=$e(b[0]),k=!0)}!k&&W.length>3&&(v.f=W[3])}if(f.s.r>m.r&&(f.s.r=m.r),f.s.c>w&&(f.s.c=w),f.e.r<m.r&&(f.e.r=m.r),f.e.c<w&&(f.e.c=w),o.cellDates&&g&&v.t=="n"&&Mo(Ne[g.numFmtId])){var K=Hs(v.v);K&&(v.t="d",v.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}Ee&&(Ee.type=="XLDAPR"&&(v.D=!0),Ee=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},w=W[0].c==-1?w+1:W[0].c,o.dense?(c[E]||(c[E]=[]),c[E][w]=v):c[bt(w)+N]=v,f.s.r>m.r&&(f.s.r=m.r),f.s.c>w&&(f.s.c=w),f.e.r<m.r&&(f.e.r=m.r),f.e.c<w&&(f.e.c=w),Ee&&(Ee.type=="XLDAPR"&&(v.D=!0),Ee=void 0);break;case 176:B.push(W);break;case 49:Ee=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var j=n["!id"][W.relId];for(j?(W.Target=j.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=j):W.relId==""&&(W.Target="#"+W.loc),E=W.rfx.s.r;E<=W.rfx.e.r;++E)for(w=W.rfx.s.c;w<=W.rfx.e.c;++w)o.dense?(c[E]||(c[E]=[]),c[E][w]||(c[E][w]={t:"z",v:void 0}),c[E][w].l=W):(T=Fe({c:w,r:E}),c[T]||(c[T]={t:"z",v:void 0}),c[T].l=W);break;case 426:if(!o.cellFormula)break;A.push(W),z=o.dense?c[E][w]:c[bt(w)+N],z.f=fr(W[1],f,{r:m.r,c:w},R,o),z.F=$e(W[0]);break;case 427:if(!o.cellFormula)break;I[Fe(W[0].s)]=W[1],z=o.dense?c[E][w]:c[bt(w)+N],z.f=fr(W[1],f,{r:m.r,c:w},R,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)F[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},ue||(ue=!0,Bg(W.w/256)),So(F[W.e+1]);break;case 161:c["!autofilter"]={ref:$e(W)};break;case 476:c["!margins"]=W;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),W.name&&(i.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),W.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ce.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=$e(l||f)),o.sheetRows&&c["!ref"]){var me=kt(c["!ref"]);o.sheetRows<=+me.e.r&&(me.e.r=o.sheetRows-1,me.e.r>f.e.r&&(me.e.r=f.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>f.e.c&&(me.e.c=f.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),c["!fullref"]=c["!ref"],c["!ref"]=$e(me))}return B.length>0&&(c["!merges"]=B),F.length>0&&(c["!cols"]=F),ve.length>0&&(c["!rows"]=ve),c}function Xb(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Ge((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function Yb(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,c=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=Xb(h);f.s.r=f.s.c=0,f.e.c=o,l=bt(o),d[0].forEach(function(m,v){a[l+tr(v)]={t:"n",v:m,z:d[1]},c=v}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(a["!ref"]=$e(f)),a}function Qb(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(TA);return o&&zg(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Jb(t,e){t.l+=10;var r=gr(t);return{name:r}}function Zb(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Pi(t,function(c,l,f){switch(f){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var AA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tV=[],rV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Xx(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ft(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Yx(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ft(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function SA(t){Yx(t.WBProps,AA),Yx(t.CalcPr,rV),Xx(t.WBView,eV),Xx(t.Sheets,tV),co.date1904=ft(t.WBProps.date1904)}var nV="][*?/\\".split("");function iV(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return nV.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}var sV=/<\w+:workbook/;function aV(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(yr,function(c,l){var f=Ie(c);switch(ri(f[0])){case"<?xml":break;case"<workbook":c.match(sV)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":AA.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=ft(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=nt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ge(nt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=nt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),ft(f.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=Ge(nt(t.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),k6.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return SA(r),r}function oV(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ep(t),r.name=gr(t),r}function cV(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?gr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function lV(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function uV(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=H6(t),a=K9(t,0,r),o=Og(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function fV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],a0[16]={n:"BrtFRTArchID$",f:lV},Pi(t,function(c,l,f){switch(f){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=fr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,c]):a[0]=[f,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),SA(r),r.Names=s,r.supbooks=a,r}function hV(t,e,r){return e.slice(-4)===".bin"?fV(t,r):aV(t,r)}function dV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?qb(t,n,r,i,s,a,o):ob(t,n,r,i,s,a,o)}function pV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?Zb(t,n,r,i,s):Qb(t,n,r,i,s)}function mV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?T5():k5()}function gV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?E5():w5()}function vV(t,e,r,n){return e.slice(-4)===".bin"?V8(t,r,n):D8(t,r,n)}function _V(t,e,r){return hA(t,r)}function xV(t,e,r){return e.slice(-4)===".bin"?e8(t,r):JM(t,r)}function yV(t,e,r){return e.slice(-4)===".bin"?_5(t,r):d5(t,r)}function EV(t,e,r){return e.slice(-4)===".bin"?u5(t):c5(t)}function wV(t,e,r,n){return r.slice(-4)===".bin"?f5(t,e,r,n):void 0}function TV(t,e,r){return e.slice(-4)===".bin"?a5(t,e,r):o5(t,e,r)}var IA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,CA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wn(t,e){var r=t.split(/\s+/),n=[];if(e||(n[0]=r[0]),r.length===1)return n;var i=t.match(IA),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(CA),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function kV(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(IA),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(CA),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Hc;function AV(t,e){var r=Hc[t]||Ge(t);return r==="General"?aa(e):_n(r,e)}function SV(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ft(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=$t(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Ge(e)]=i}function IV(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ea[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=gl(t.v):t.w=aa(t.v):t.w=AV(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Hc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Mo(n)){var i=Hs(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function CV(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=S8[n.Pattern]||n.Pattern)}t[e.ID]=e}function RV(t,e,r,n,i,s,a,o,c,l){var f="General",h=n.StyleID,d={};l=l||{};var m=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(f=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ft(t);break;case"String":n.t="s",n.r=_x(Ge(t)),n.v=t.indexOf("<")>-1?Ge(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=($t(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ge(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$k[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=_x(e||t));break}if(IV(n,f,l),l.cellFormula!==!1)if(n.Formula){var g=Ge(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=oo(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=oo("RC:RC",i):n.ArrayRange&&(n.F=oo(n.ArrayRange,i),c.push([kt(n.F),n.F]))}else for(v=0;v<c.length;++v)i.r>=c[v][0].s.r&&i.r<=c[v][0].e.r&&i.c>=c[v][0].s.c&&i.c<=c[v][0].e.c&&(n.F=c[v][1]);l.cellStyles&&(m.forEach(function(E){!d.patternType&&E.patternType&&(d.patternType=E.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function PV(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Zh(t,e){var r=e||{};mk();var n=mc(Rg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=nt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=er(r);return a.type="string",xl.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(dt){i.indexOf("<"+dt)>=0&&(s=!0)}),s)return BV(n,r);Hc={"General Number":"General","General Date":Ne[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ne[15],"Short Date":Ne[14],"Long Time":Ne[19],"Medium Time":Ne[18],"Short Time":Ne[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ne[2],Standard:Ne[4],Percent:Ne[10],Scientific:Ne[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,f={},h=[],d=r.dense?[]:{},m="",v={},g={},E=wn('<Data ss:Type="String">'),w=0,T=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},B={},y="",k=0,A=[],I={},R={},C=0,F=[],ve=[],ue={},Ee=[],me,ie=!1,W=[],ce=[],xe={},b=0,K=0,j={Sheets:[],WBProps:{date1904:!1}},H={};_l.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=_l.exec(n);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?RV(n.slice(w,o.index),y,E,c[c.length-1][0]=="comment"?ue:v,{c:T,r:_},z,Ee[T],g,W,r):(y="",E=wn(o[0]),w=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ve.length>0&&(v.c=ve),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(d[_]||(d[_]=[]),d[_][T]=v):d[bt(T)+tr(_)]=v),v.HRef&&(v.l={Target:Ge(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(b=T+(parseInt(v.MergeAcross,10)|0),K=_+(parseInt(v.MergeDown,10)|0),A.push({s:{c:T,r:_},e:{c:b,r:K}})),!r.sheetStubs)v.MergeAcross?T=b+1:++T;else if(v.MergeAcross||v.MergeDown){for(var le=T;le<=b;++le)for(var ye=_;ye<=K;++ye)(le>T||ye>_)&&(r.dense?(d[ye]||(d[ye]=[]),d[ye][le]={t:"z"}):d[bt(le)+tr(ye)]={t:"z"});T=b+1}else++T;else v=kV(o[0]),v.Index&&(T=+v.Index-1),T<N.s.c&&(N.s.c=T),T>N.e.c&&(N.e.c=T),o[0].slice(-2)==="/>"&&++T,ve=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(g=wn(o[0]),g.Index&&(_=+g.Index-1)),T=0,++_):(g=wn(o[0]),g.Index&&(_=+g.Index-1),xe={},(g.AutoFitHeight=="0"||g.Height)&&(xe.hpx=parseInt(g.Height,10),xe.hpt=fA(xe.hpx),ce[_]=xe),g.Hidden=="1"&&(xe.hidden=!0,ce[_]=xe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h.push(m),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=$e(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=$e(N))),A.length&&(d["!merges"]=A),Ee.length>0&&(d["!cols"]=Ee),ce.length>0&&(d["!rows"]=ce),f[m]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=T=0,c.push([o[3],!1]),l=wn(o[0]),m=Ge(l.Name),d=r.dense?[]:{},A=[],W=[],ce=[],H={name:m,Hidden:0},j.Sheets.push(H);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ee=[],ie=!1}break;case"style":o[1]==="/"?CV(z,B,r):B=wn(o[0]);break;case"numberformat":B.nf=Ge(wn(o[0]).Format||"General"),Hc[B.nf]&&(B.nf=Hc[B.nf]);for(var de=0;de!=392&&Ne[de]!=B.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Ne[de]==null){Gs(B.nf,de);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(me=wn(o[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!ie&&me.wpx>10){ie=!0,Ar=lA;for(var se=0;se<Ee.length;++se)Ee[se]&&So(Ee[se])}ie&&So(me),Ee[me.Index-1||Ee.length]=me;for(var Me=0;Me<+me.Span;++Me)Ee[Ee.length]=er(me);break;case"namedrange":if(o[1]==="/")break;j.Names||(j.Names=[]);var U=Ie(o[0]),it={Name:U.Name,Ref:oo(U.RefersTo.slice(1),{r:0,c:0})};j.Sheets.length>0&&(it.Sheet=j.Sheets.length-1),j.Names.push(it);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y+=n.slice(k,o.index):k=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=wn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dL(I,ee,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));PV(ue),ve.push(ue)}else c.push([o[3],!1]),l=wn(o[0]),ue={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ve=wn(o[0]);d["!autofilter"]={ref:oo(Ve.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return ry(n,r);var Xe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Xe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Xe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":j.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Xe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Xe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else C=o.index+o[0].length;break;case"header":d["!margins"]||zc(d["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(d["!margins"].header=+Ie(o[0]).Margin);break;case"footer":d["!margins"]||zc(d["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(d["!margins"].footer=+Ie(o[0]).Margin);break;case"pagemargins":var Le=Ie(o[0]);d["!margins"]||zc(d["!margins"]={},"xlml"),isNaN(+Le.Top)||(d["!margins"].top=+Le.Top),isNaN(+Le.Left)||(d["!margins"].left=+Le.Left),isNaN(+Le.Right)||(d["!margins"].right=+Le.Right),isNaN(+Le.Bottom)||(d["!margins"].bottom=+Le.Bottom);break;case"displayrighttoleft":j.Views||(j.Views=[]),j.Views[0]||(j.Views[0]={}),j.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Xe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Xe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Xe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Xe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Xe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Xe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Xe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Xe=!1}break;case"smarttags":break;default:Xe=!1;break}if(Xe||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?SV(R,ee,F,n.slice(C,o.index)):(F=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var pe={};return!r.bookSheets&&!r.bookProps&&(pe.Sheets=f),pe.SheetNames=h,pe.Workbook=j,pe.SSF=er(Ne),pe.Props=I,pe.Custprops=R,pe}function Ap(t,e){switch($g(e=e||{}),e.type||"base64"){case"base64":return Zh(rn(t),e);case"binary":case"buffer":case"file":return Zh(t,e);case"array":return Zh(_a(t),e)}}function FV(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=j6(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=G6(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var DV=[60,1084,2066,2165,2175];function NV(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=gi(r,r.l),l=Sp[c],f=0;l!=null&&DV.indexOf(c)>-1;)s=gi(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,l=Sp[c=gi(r,r.l)];var h=Ki(a);Yt(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,i)}function Hn(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ne[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ea[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=gl(t.v):t.w=aa(t.v):t.w=_n(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Mo(Ne[n]||String(n))){var i=Hs(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bu(t,e,r){return{v:t,ixfe:e,t:r}}function OV(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,c=[],l="",f={},h,d="",m,v,g,E,w={},T=[],_,N,z=[],B=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},A=function(Oe){return Oe<8?Ks[Oe]:Oe<64&&B[Oe-8]||Ks[Oe]},I=function(Oe,ut,Dr){var st=ut.XF.data;if(!(!st||!st.patternType||!Dr||!Dr.cellStyles)){ut.s={},ut.s.patternType=st.patternType;var Bn;(Bn=yl(A(st.icvFore)))&&(ut.s.fgColor={rgb:Bn}),(Bn=yl(A(st.icvBack)))&&(ut.s.bgColor={rgb:Bn})}},R=function(Oe,ut,Dr){if(!(xe>1)&&!(Dr.sheetRows&&Oe.r>=Dr.sheetRows)){if(Dr.cellStyles&&ut.XF&&ut.XF.data&&I(Oe,ut,Dr),delete ut.ixfe,delete ut.XF,h=Oe,d=Fe(Oe),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<a.s.r&&(a.s.r=Oe.r),Oe.c<a.s.c&&(a.s.c=Oe.c),Oe.r+1>a.e.r&&(a.e.r=Oe.r+1),Oe.c+1>a.e.c&&(a.e.c=Oe.c+1),Dr.cellFormula&&ut.f){for(var st=0;st<T.length;++st)if(!(T[st][0].s.c>Oe.c||T[st][0].s.r>Oe.r)&&!(T[st][0].e.c<Oe.c||T[st][0].e.r<Oe.r)){ut.F=$e(T[st][0]),(T[st][0].s.c!=Oe.c||T[st][0].s.r!=Oe.r)&&delete ut.f,ut.f&&(ut.f=""+fr(T[st][1],a,Oe,W,C));break}}Dr.dense?(i[Oe.r]||(i[Oe.r]=[]),i[Oe.r][Oe.c]=ut):i[d]=ut}},C={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var F,ve=[],ue=[],Ee=[],me=[],ie=!1,W=[];W.SheetNames=C.snames,W.sharedf=C.sharedf,W.arrayf=C.arrayf,W.names=[],W.XTI=[];var ce=0,xe=0,b=0,K=[],j=[],H;C.codepage=1200,Cn(1200);for(var ee=!1;t.l<t.length-1;){var le=t.l,ye=t.read_shift(2);if(ye===0&&ce===10)break;var de=t.l===t.length?0:t.read_shift(2),se=Sp[ye];if(se&&se.f){if(e.bookSheets&&ce===133&&ye!==133)break;if(ce=ye,se.r===2||se.r==12){var Me=t.read_shift(2);if(de-=2,!C.enc&&Me!==ye&&((Me&255)<<8|Me>>8)!==ye)throw new Error("rt mismatch: "+Me+"!="+ye);se.r==12&&(t.l+=10,de-=10)}var U={};if(ye===10?U=se.f(t,de,C):U=NV(ye,se,t,de,C),xe==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(ye){case 34:r.opts.Date1904=y.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=U;break;case 66:var it=Number(U);switch(it){case 21010:it=1200;break;case 32768:it=1e4;break;case 32769:it=1252;break}Cn(C.codepage=it),ee=!0;break;case 317:C.rrtabid=U;break;case 25:C.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:C.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:z.push(U);break;case 430:W.push([U]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(U);break;case 24:case 536:H={Name:U.Name,Ref:fr(U.rgce,a,null,W,C)},U.itab>0&&(H.Sheet=U.itab-1),W.names.push(H),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(j[U.itab-1]={ref:$e(U.rgce[0][0][1][2])});break;case 22:C.ExternCount=U;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(U),W.XTI=W.XTI.concat(U);break;case 2196:if(C.biff<8)break;H!=null&&(H.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&C.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,C.snames.push(U.name);break;case 10:{if(--xe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=$e(a),e.sheetRows&&e.sheetRows<=a.e.r){var Ve=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=$e(a),a.e.r=Ve}a.e.r++,a.e.c++}ve.length>0&&(i["!merges"]=ve),ue.length>0&&(i["!objects"]=ue),Ee.length>0&&(i["!cols"]=Ee),me.length>0&&(i["!rows"]=me),y.Sheets.push(k)}l===""?f=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),C.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(C.biff=5,ee=!0,Cn(C.codepage=28591)),C.biff==8&&U.BIFFVer==0&&U.dt==16&&(C.biff=2),xe++)break;if(i=e.dense?[]:{},C.biff<8&&!ee&&(ee=!0,Cn(C.codepage=e.codepage||1252)),C.biff<5||U.BIFFVer==0&&U.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var Xe={pos:t.l-de,name:l};s[Xe.pos]=Xe,C.snames.push(l)}else l=(s[le]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),ve=[],ue=[],C.arrayf=T=[],Ee=[],me=[],ie=!1,k={Hidden:(s[le]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[U.r]||[])[U.c]:i[Fe({c:U.c,r:U.r})])&&++U.c,_={ixfe:U.ixfe,XF:z[U.ixfe]||{},v:U.val,t:"n"},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e);break;case 5:case 517:_={ixfe:U.ixfe,XF:z[U.ixfe],v:U.val,t:U.t},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e);break;case 638:_={ixfe:U.ixfe,XF:z[U.ixfe],v:U.rknum,t:"n"},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e);break;case 189:for(var Le=U.c;Le<=U.C;++Le){var pe=U.rkrec[Le-U.c][0];_={ixfe:pe,XF:z[pe],v:U.rkrec[Le-U.c][1],t:"n"},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:Le,r:U.r},_,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(_=Bu(U.val,U.cell.ixfe,U.tt),_.XF=z[_.ixfe],e.cellFormula){var dt=U.formula;if(dt&&dt[0]&&dt[0][0]&&dt[0][0][0]=="PtgExp"){var Er=dt[0][0][1][0],Hr=dt[0][0][1][1],Wr=Fe({r:Er,c:Hr});w[Wr]?_.f=""+fr(U.formula,a,U.cell,W,C):_.F=((e.dense?(i[Er]||[])[Hr]:i[Wr])||{}).F}else _.f=""+fr(U.formula,a,U.cell,W,C)}b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R(U.cell,_,e),o=U}break;case 7:case 519:if(o)o.val=U,_=Bu(U,o.cell.ixfe,"s"),_.XF=z[_.ixfe],e.cellFormula&&(_.f=""+fr(o.formula,a,o.cell,W,C)),b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R(o.cell,_,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(U);var Fi=Fe(U[0].s);if(m=e.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[Fi],e.cellFormula&&m){if(!o||!Fi||!m)break;m.f=""+fr(U[1],a,U[0],W,C),m.F=$e(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;w[Fe(o.cell)]=U[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Fe(o.cell)],(m||{}).f=""+fr(U[0],a,h,W,C)}}break;case 253:_=Bu(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(_.h=c[U.isst].h),_.XF=z[_.ixfe],b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e);break;case 513:e.sheetStubs&&(_={ixfe:U.ixfe,XF:z[U.ixfe],t:"z"},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e));break;case 190:if(e.sheetStubs)for(var Vn=U.c;Vn<=U.C;++Vn){var jt=U.ixfe[Vn-U.c];_={ixfe:jt,XF:z[jt],t:"z"},b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:Vn,r:U.r},_,e)}break;case 214:case 516:case 4:_=Bu(U.val,U.ixfe,"s"),_.XF=z[_.ixfe],b>0&&(_.z=K[_.ixfe>>8&63]),Hn(_,e,r.opts.Date1904),R({c:U.c,r:U.r},_,e);break;case 0:case 512:xe===1&&(a=U);break;case 252:c=U;break;case 1054:if(C.biff==4){K[b++]=U[1];for(var $r=0;$r<b+163&&Ne[$r]!=U[1];++$r);$r>=163&&Gs(U[1],b+163)}else Gs(U[1],U[0]);break;case 30:{K[b++]=U;for(var an=0;an<b+163&&Ne[an]!=U;++an);an>=163&&Gs(U,b+163)}break;case 229:ve=ve.concat(U);break;case 93:ue[U.cmo[0]]=C.lastobj=U;break;case 438:C.lastobj.TxO=U;break;case 127:C.lastobj.ImData=U;break;case 440:for(E=U[0].s.r;E<=U[0].e.r;++E)for(g=U[0].s.c;g<=U[0].e.c;++g)m=e.dense?(i[E]||[])[g]:i[Fe({c:g,r:E})],m&&(m.l=U[1]);break;case 2048:for(E=U[0].s.r;E<=U[0].e.r;++E)for(g=U[0].s.c;g<=U[0].e.c;++g)m=e.dense?(i[E]||[])[g]:i[Fe({c:g,r:E})],m&&m.l&&(m.l.Tooltip=U[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;m=e.dense?(i[U[0].r]||[])[U[0].c]:i[Fe(U[0])];var _t=ue[U[2]];m||(e.dense?(i[U[0].r]||(i[U[0].r]=[]),m=i[U[0].r][U[0].c]={t:"z"}):m=i[Fe(U[0])]={t:"z"},a.e.r=Math.max(a.e.r,U[0].r),a.s.r=Math.min(a.s.r,U[0].r),a.e.c=Math.max(a.e.c,U[0].c),a.s.c=Math.min(a.s.c,U[0].c)),m.c||(m.c=[]),v={a:U[1],t:_t.TxO.t},m.c.push(v)}break;case 2173:r5(z[U.ixfe],U.ext);break;case 125:{if(!C.cellStyles)break;for(;U.e>=U.s;)Ee[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},ie||(ie=!0,Bg(U.w/256)),So(Ee[U.e+1])}break;case 520:{var Ye={};U.level!=null&&(me[U.r]=Ye,Ye.level=U.level),U.hidden&&(me[U.r]=Ye,Ye.hidden=!0),U.hpt&&(me[U.r]=Ye,Ye.hpt=U.hpt,Ye.hpx=El(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||zc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=U;break;case 161:i["!margins"]||zc(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(y.Views[0].RTL=!0);break;case 146:B=U;break;case 2198:F=U;break;case 140:N=U;break;case 442:l?k.CodeName=U||k.name:y.WBProps.CodeName=U||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),t.l+=de}return r.SheetNames=ti(s).sort(function(wr,Oe){return Number(wr)-Number(Oe)}).map(function(wr){return s[wr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&j.forEach(function(wr,Oe){r.Sheets[r.SheetNames[Oe]]["!autofilter"]=wr}),r.Strings=c,r.SSF=er(Ne),C.enc&&(r.Encryption=C.enc),F&&(r.Themes=F),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),W.names.length>0&&(y.Names=W.names),r.Workbook=y,r}var Qx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function LV(t,e,r){var n=We.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Ox(n,J6,Qx.DSI);for(var s in i)e[s]=i[s]}catch(l){if(r.WTF)throw l}var a=We.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=Ox(a,Z6,Qx.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(Gk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function RA(t,e){e||(e={}),$g(e),nk(),e.codepage&&wg(e.codepage);var r,n;if(t.FullPaths){if(We.find(t,"/encryption"))throw new Error("File is password-protected");r=We.find(t,"!CompObj"),n=We.find(t,"/Workbook")||We.find(t,"/Book")}else{switch(e.type){case"base64":t=In(rn(t));break;case"binary":t=In(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Yt(t,0),n={content:t}}var i,s;if(r&&FV(r),e.bookProps&&!e.bookSheets)i={};else{var a=ze?"buffer":"array";if(n&&n.content)i=OV(n.content,e);else if((s=We.find(t,"PerfectOffice_MAIN"))&&s.content)i=Bc.to_workbook(s.content,(e.type=a,e));else if((s=We.find(t,"NativeContent_MAIN"))&&s.content)i=Bc.to_workbook(s.content,(e.type=a,e));else throw(s=We.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&We.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=y5(t))}var o={};return t.FullPaths&&LV(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}var a0={0:{f:gb},1:{f:yb},2:{f:Rb},3:{f:kb},4:{f:wb},5:{f:Cb},6:{f:Db},7:{f:Sb},8:{f:bb},9:{f:Mb},10:{f:Ob},11:{f:Lb},12:{f:Eb},13:{f:Pb},14:{f:Ab},15:{f:Tb},16:{f:kA},17:{f:Nb},18:{f:Ib},19:{f:Ng},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uV},40:{},42:{},43:{f:O8},44:{f:N8},45:{f:L8},46:{f:b8},47:{f:M8},48:{},49:{f:V6},50:{},51:{f:i5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iA},62:{f:Fb},63:{f:l5},64:{f:Gb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:jb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xb},148:{f:vb,p:16},151:{f:Ub},152:{},153:{f:cV},154:{},155:{},156:{f:oV},157:{},158:{},159:{T:1,f:ZM},160:{T:-1},161:{T:1,f:ya},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Vb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:n5},336:{T:-1},337:{f:s5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ep},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zb},427:{f:Hb},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$b},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_b},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Bb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ep},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v5},633:{T:1},634:{T:-1},635:{T:1,f:g5},636:{T:-1},637:{f:U6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Jb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Kb},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Sp={6:{f:Qh},10:{f:bi},12:{f:Ft},13:{f:Ft},14:{f:At},15:{f:At},16:{f:pr},17:{f:At},18:{f:At},19:{f:Ft},20:{f:Vx},21:{f:Vx},23:{f:nA},24:{f:Ux},25:{f:At},26:{},27:{},28:{f:pM},29:{},34:{f:At},35:{f:Bx},38:{f:pr},39:{f:pr},40:{f:pr},41:{f:pr},42:{f:At},43:{f:At},47:{f:_8},49:{f:XL},51:{f:Ft},60:{},61:{f:GL},64:{f:At},65:{f:qL},66:{f:Ft},77:{},80:{},81:{},82:{},85:{f:Ft},89:{},90:{},91:{},92:{f:VL},93:{f:gM},94:{},95:{f:At},96:{},97:{},99:{f:At},125:{f:iA},128:{f:sM},129:{f:BL},130:{f:Ft},131:{f:At},132:{f:At},133:{f:UL},134:{},140:{f:wM},141:{f:Ft},144:{},146:{f:kM},151:{},152:{},153:{},154:{},155:{},156:{f:Ft},157:{},158:{},160:{f:RM},161:{f:SM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tM},190:{f:rM},193:{f:bi},197:{},198:{},199:{},200:{},201:{},202:{f:At},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ft},220:{},221:{f:At},222:{},224:{f:iM},225:{f:bL},226:{f:bi},227:{},229:{f:mM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zL},253:{f:YL},255:{f:HL},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Qk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:At},353:{f:bi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:oM},431:{f:At},432:{},433:{},434:{},437:{},438:{f:xM},439:{f:At},440:{f:yM},441:{},442:{f:Wl},443:{},444:{f:Ft},445:{},446:{},448:{f:bi},449:{f:jL,r:2},450:{f:bi},512:{f:Mx},513:{f:CM},515:{f:aM},516:{f:QL},517:{f:bx},519:{f:PM},520:{f:WL},523:{},545:{f:zx},549:{f:Lx},566:{},574:{f:KL},638:{f:eM},659:{},1048:{},1054:{f:JL},1084:{},1212:{f:fM},2048:{f:EM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Mu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AM,r:12},2173:{f:t5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:At,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:uM,r:12},2197:{},2198:{f:X8,r:12},2199:{},2200:{},2201:{},2202:{f:hM,r:12},2203:{f:bi},2204:{},2205:{},2206:{},2207:{},2211:{f:$L},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ft},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:IM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Mx},1:{},2:{f:OM},3:{f:NM},4:{f:DM},5:{f:bx},7:{f:LM},8:{},9:{f:Mu},11:{},22:{f:Ft},30:{f:ZL},31:{},32:{},33:{f:zx},36:{},37:{f:Lx},50:{f:MM},62:{},52:{},67:{},68:{f:Ft},69:{},86:{},126:{},127:{f:FM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:bM},223:{},234:{},354:{},421:{},518:{f:Qh},521:{f:Mu},536:{f:Ux},547:{f:Bx},561:{},579:{},1030:{f:Qh},1033:{f:Mu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Tn(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Vk(r)&&t.push(r)}}function Jx(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,c=o6(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<c.length;++a){var g=c[a].trim(),E=g.slice(0,3).toLowerCase();if(E=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(E!="<td"&&E!="<th")){var w=g.split(/<\/t[dh]>/i);for(o=0;o<w.length;++o){var T=w[o].trim();if(T.match(/<t[dh]/i)){for(var _=T,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var z=0;z<v.length;++z){var B=v[z];B.s.c==f&&B.s.r<l&&l<=B.e.r&&(f=B.e.c+1,z=-1)}var y=Ie(T.slice(0,T.indexOf(">")));d=y.colspan?+y.colspan:1,((h=+y.rowspan)>1||d>1)&&v.push({s:{r:l,c:f},e:{r:l+(h||1)-1,c:f+d-1}});var k=y.t||y["data-t"]||"";if(!_.length){f+=d;continue}if(_=Ak(_),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>f&&(m.s.c=f),m.e.c<f&&(m.e.c=f),!_.length){f+=d;continue}var A={t:"s",v:_};r.raw||!_.trim().length||k=="s"||(_==="TRUE"?A={t:"b",v:!0}:_==="FALSE"?A={t:"b",v:!1}:isNaN(Dn(_))?isNaN(Ao(_).getDate())||(A={t:"d",v:$t(_)},r.cellDates||(A={t:"n",v:Rr(A.v)}),A.z=r.dateNF||Ne[14]):A={t:"n",v:Dn(_)}),r.dense?(n[l]||(n[l]=[]),n[l][f]=A):n[Fe({r:l,c:f})]=A,f+=d}}}}return n["!ref"]=$e(m),v.length&&(n["!merges"]=v),n}function MV(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var f=Fe({r,c:a}),h=n.dense?(t[r]||[])[a]:t[f],d=h&&h.v!=null&&(h.h||Cg(h.w||(Ci(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+f,s.push(w6("td",d,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var bV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VV="</body></html>";function BV(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return As(Jx(r[0],e),e);var n=Gg();return r.forEach(function(i,s){Kg(n,Jx(i,e),"Sheet"+(s+1))}),n}function UV(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zV(t,e){var r=e||{},n=r.header!=null?r.header:bV,i=r.footer!=null?r.footer:VV,s=[n],a=bo(t["!ref"]);r.dense=Array.isArray(t),s.push(UV(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(MV(t,a,o,r));return s.push("</table>"+i),s.join("")}function PA(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Sr(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=bo(t["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),i==-1&&(l.e.r=i=f.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),v=0,g=0,E=0,w=0,T=0,_=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&g<c;++v){var N=o[v];if(Zx(N)){if(n.display)continue;m[g]={hidden:!0}}var z=N.children;for(E=w=0;E<z.length;++E){var B=z[E];if(!(n.display&&Zx(B))){var y=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):Ak(B.innerHTML),k=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<h.length;++d){var A=h[d];A.s.c==w+s&&A.s.r<g+i&&g+i<=A.e.r&&(w=A.e.c+1-s,d=-1)}_=+B.getAttribute("colspan")||1,((T=+B.getAttribute("rowspan")||1)>1||_>1)&&h.push({s:{r:g+i,c:w+s},e:{r:g+i+(T||1)-1,c:w+s+(_||1)-1}});var I={t:"s",v:y},R=B.getAttribute("data-t")||B.getAttribute("t")||"";y!=null&&(y.length==0?I.t=R||"z":n.raw||y.trim().length==0||R=="s"||(y==="TRUE"?I={t:"b",v:!0}:y==="FALSE"?I={t:"b",v:!1}:isNaN(Dn(y))?isNaN(Ao(y).getDate())||(I={t:"d",v:$t(y)},n.cellDates||(I={t:"n",v:Rr(I.v)}),I.z=n.dateNF||Ne[14]):I={t:"n",v:Dn(y)})),I.z===void 0&&k!=null&&(I.z=k);var C="",F=B.getElementsByTagName("A");if(F&&F.length)for(var ve=0;ve<F.length&&!(F[ve].hasAttribute("href")&&(C=F[ve].getAttribute("href"),C.charAt(0)!="#"));++ve);C&&C.charAt(0)!="#"&&(I.l={Target:C}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][w+s]=I):t[Fe({c:w+s,r:g+i})]=I,l.e.c<w+s&&(l.e.c=w+s),w+=_}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),l.e.r=Math.max(l.e.r,g-1+i),t["!ref"]=$e(l),g>=c&&(t["!fullref"]=$e((l.e.r=o.length-v+g-1+i,l))),t}function FA(t,e){var r=e||{},n=r.dense?[]:{};return PA(n,t,e)}function HV(t,e){return As(FA(t,e),e)}function Zx(t){var e="",r=WV(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function WV(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $V(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ge(e.replace(/<[^>]*>/g,""));return[r]}var ey={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function DA(t,e){var r=e||{},n=Rg(t),i=[],s,a,o={name:""},c="",l=0,f,h,d={},m=[],v=r.dense?[]:{},g,E,w={value:""},T="",_=0,N=[],z=-1,B=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,A={},I=[],R={},C=0,F=0,ve=[],ue=1,Ee=1,me=[],ie={Names:[]},W={},ce=["",""],xe=[],b={},K="",j=0,H=!1,ee=!1,le=0;for(_l.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=_l.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?v["!ref"]=$e(y):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(v["!fullref"]=v["!ref"],y.e.r=r.sheetRows-1,v["!ref"]=$e(y)),I.length&&(v["!merges"]=I),ve.length&&(v["!rows"]=ve),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),m.push(f.name),d[f.name]=v,ee=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=Ie(g[0],!1),z=B=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,v=r.dense?[]:{},I=[],ve=[],ee=!0);break;case"table-row-group":g[1]==="/"?--k:++k;break;case"table-row":case"":if(g[1]==="/"){z+=ue,ue=1;break}if(h=Ie(g[0],!1),h.?z=h.-1:z==-1&&(z=0),ue=+h["number-rows-repeated"]||1,ue<10)for(le=0;le<ue;++le)k>0&&(ve[z+le]={level:k});B=-1;break;case"covered-table-cell":g[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(v[z]||(v[z]=[]),v[z][B]={t:"z"}):v[Fe({r:z,c:B})]={t:"z"}),T="",N=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++B,w=Ie(g[0],!1),Ee=parseInt(w["number-columns-repeated"]||"1",10),E={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(E.f=qx(Ge(w.formula))),(w.||w["value-type"])=="string"&&(E.t="s",E.v=Ge(w["string-value"]||""),r.dense?(v[z]||(v[z]=[]),v[z][B]=E):v[Fe({r:z,c:B})]=E),B+=Ee-1;else if(g[1]!=="/"){++B,T="",_=0,N=[],Ee=1;var ye=ue?z+ue-1:z;if(B>y.e.c&&(y.e.c=B),B<y.s.c&&(y.s.c=B),z<y.s.r&&(y.s.r=z),ye>y.e.r&&(y.e.r=ye),w=Ie(g[0],!1),xe=[],b={},E={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=Ge(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(C=parseInt(w["number-matrix-rows-spanned"],10)||0,F=parseInt(w["number-matrix-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+C-1,c:B+F-1}},E.F=$e(R),me.push([R,E.F])),w.formula)E.f=qx(w.formula);else for(le=0;le<me.length;++le)z>=me[le][0].s.r&&z<=me[le][0].e.r&&B>=me[le][0].s.c&&B<=me[le][0].e.c&&(E.F=me[le][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(C=parseInt(w["number-rows-spanned"],10)||0,F=parseInt(w["number-columns-spanned"],10)||0,R={s:{r:z,c:B},e:{r:z+C-1,c:B+F-1}},I.push(R)),w["number-columns-repeated"]&&(Ee=parseInt(w["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ft(w["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(w.value);break;case"percentage":E.t="n",E.v=parseFloat(w.value);break;case"currency":E.t="n",E.v=parseFloat(w.value);break;case"date":E.t="d",E.v=$t(w["date-value"]),r.cellDates||(E.t="n",E.v=Rr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=i6(w["time-value"])/86400,r.cellDates&&(E.t="d",E.v=G0(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(w.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",w["string-value"]!=null&&(T=Ge(w["string-value"]),N=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=T||"",N.length&&(E.R=N),H=_==0),W.Target&&(E.l=W),xe.length>0&&(E.c=xe,xe=[]),T&&r.cellText!==!1&&(E.w=T),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=z))for(var de=0;de<ue;++de){if(Ee=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(v[z+de]||(v[z+de]=[]),v[z+de][B]=de==0?E:er(E);--Ee>0;)v[z+de][B+Ee]=er(E);else for(v[Fe({r:z+de,c:B})]=E;--Ee>0;)v[Fe({r:z+de,c:B+Ee})]=er(E);y.e.c<=B&&(y.e.c=B)}Ee=parseInt(w["number-columns-repeated"]||"1",10),B+=Ee-1,Ee=0,E={},T="",N=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;b.t=T,N.length&&(b.R=N),b.a=K,xe.push(b)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);K="",j=0,T="",_=0,N=[];break;case"creator":g[1]==="/"?K=n.slice(j,g.index):j=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);T="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(A[o.name]=c,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=Ie(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ie(g[0],!1),c+=ey[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ie(g[0],!1),c+=ey[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,g.index);break}else l=g.index+g[0].length;break;case"named-range":a=Ie(g[0],!1),ce=Jh(a["cell-range-address"]);var se={Name:a.name,Ref:ce[0]+"!"+ce[1]};ee&&(se.Sheet=m.length),ie.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!w||!w["string-value"])){var Me=$V(n.slice(_,g.index));T=(T.length>0?T+`
`:"")+Me[0]}else Ie(g[0],!1),_=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ce=Jh(Ie(g[0])["target-range-address"]),d[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(W=Ie(g[0],!1),!W.href)break;W.Target=Ge(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(ce=Jh(W.Target.slice(1)),W.Target="#"+ce[0]+"!"+ce[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var U={Sheets:d,SheetNames:m,Workbook:ie};return r.bookSheets&&delete U.Sheets,U}function ty(t,e){e=e||{},un(t,"META-INF/manifest.xml")&&aL(Pt(t,"META-INF/manifest.xml"),e);var r=Xr(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=DA(nt(r),e);return un(t,"meta.xml")&&(n.Props=jk(Pt(t,"meta.xml"))),n}function ry(t,e){return DA(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ip(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):nt(_a(t))}function Cp(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function ny(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function jV(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function wl(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Bt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function mr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=wl(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=wl(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function Wg(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function GV(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=wl(t,n),s=mr(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Bt(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=mr(o.data),l=Bt(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Bt(s[3][0].data)>>>0>0),r.push(a)}return r}function KV(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=wl(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Cp(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var f=Cp(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function qV(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(KV(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Cp(e)}function XV(t,e,r,n){var i=Hg(t),s=i.getUint32(4,!0),a=(n>1?12:8)+ny(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=ny(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[c]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:e[c]};else if(!isNaN(l))h={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function YV(t,e,r){var n=Hg(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,f=new Date(2001,0,1);i&1&&(c=jV(t,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:l>0};break;case 7:h={t:"n",v:l/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return h}function QV(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return XV(t,e,r,t[0]);case 5:return YV(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function hs(t){var e=mr(t);return wl(e[1][0].data)}function iy(t,e){var r=mr(e.data),n=Bt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=mr(a.data),c=Bt(o[1][0].data)>>>0;switch(n){case 1:s[c]=Ip(o[3][0].data);break;case 8:{var l=t[hs(o[9][0].data)][0],f=mr(l.data),h=t[hs(f[1][0].data)][0],d=Bt(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=mr(h.data);s[c]=m[3].map(function(v){return Ip(v.data)}).join("")}break}}),s}function JV(t,e){var r,n,i,s,a,o,c,l,f,h,d,m,v,g,E=mr(t),w=Bt(E[1][0].data)>>>0,T=Bt(E[2][0].data)>>>0,_=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Bt(E[8][0].data)>0||!1,N,z;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&e!=0)N=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,z=(l=(c=E[6])==null?void 0:c[0])==null?void 0:l.data;else if((h=(f=E[4])==null?void 0:f[0])!=null&&h.data&&e!=1)N=(m=(d=E[4])==null?void 0:d[0])==null?void 0:m.data,z=(g=(v=E[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=_?4:1,y=Hg(N),k=[],A=0;A<N.length/2;++A){var I=y.getUint16(A*2,!0);I<65535&&k.push([A,I])}if(k.length!=T)throw"Expected ".concat(T," cells, found ").concat(k.length);var R=[];for(A=0;A<k.length-1;++A)R[k[A][0]]=z.subarray(k[A][1]*B,k[A+1][1]*B);return k.length>=1&&(R[k[k.length-1][0]]=z.subarray(k[k.length-1][1]*B)),{R:w,cells:R}}function ZV(t,e){var r,n=mr(e.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Bt(n[7][0].data)>>>0>0?1:0:-1,s=Wg(n[5],function(a){return JV(a,i)});return{nrows:Bt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function eB(t,e,r){var n,i=mr(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Bt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Bt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=$e(s);var a=mr(i[4][0].data),o=iy(t,t[hs(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?iy(t,t[hs(a[17][0].data)][0]):[],l=mr(a[3][0].data),f=0;l[1].forEach(function(h){var d=mr(h.data),m=t[hs(d[2][0].data)][0],v=Bt(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=ZV(t,m);g.data.forEach(function(E,w){E.forEach(function(T,_){var N=Fe({r:f+w,c:_}),z=QV(T,o,c);z&&(r[N]=z)})}),f+=g.nrows})}function tB(t,e){var r=mr(e.data),n={"!ref":"A1"},i=t[hs(r[2][0].data)],s=Bt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return eB(t,i[0],n),n}function rB(t,e){var r,n=mr(e.data),i={name:(r=n[1])!=null&&r[0]?Ip(n[1][0].data):"",sheets:[]},s=Wg(n[2],hs);return s.forEach(function(a){t[a].forEach(function(o){var c=Bt(o.meta[1][0].data);c==6e3&&i.sheets.push(tB(t,o))})}),i}function nB(t,e){var r=Gg(),n=mr(e.data),i=Wg(n[1],hs);if(i.forEach(function(s){t[s].forEach(function(a){var o=Bt(a.meta[1][0].data);if(o==2){var c=rB(t,a);c.sheets.forEach(function(l,f){Kg(r,l,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ed(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=qV(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var f;try{f=GV(l)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Bt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var f=Bt(l.meta[1][0].data)>>>0;if(f==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return nB(s,o)}function iB(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function $g(t){iB([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function sB(t){return Xa.WS.indexOf(t)>-1?"sheet":t==Xa.CS?"chart":t==Xa.DS?"dialog":t==Xa.MS?"macro":t&&t.length?t:"sheet"}function aB(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,sB(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function oB(t,e,r,n,i,s,a,o,c,l,f,h){try{s[n]=bc(Xr(t,r,!0),e);var d=Pt(t,e),m;switch(o){case"sheet":m=dV(d,e,i,c,s[n],l,f,h);break;case"chart":if(m=pV(d,e,i,c,s[n],l,f,h),!m||!m["!drawel"])break;var v=vc(m["!drawel"].Target,e),g=wp(v),E=h5(Xr(t,v,!0),bc(Xr(t,g,!0),v)),w=vc(E,v),T=wp(w);m=Yb(Xr(t,w,!0),w,c,bc(Xr(t,T,!0),w),l,m);break;case"macro":m=mV(d,e,i,c,s[n],l,f,h);break;case"dialog":m=gV(d,e,i,c,s[n],l,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var _=[];s&&s[n]&&ti(s[n]).forEach(function(N){var z="";if(s[n][N].Type==Xa.CMNT){z=vc(s[n][N].Target,e);var B=yV(Pt(t,z,!0),z,c);if(!B||!B.length)return;Wx(m,B,!1)}s[n][N].Type==Xa.TCMNT&&(z=vc(s[n][N].Target,e),_=_.concat(p5(Pt(t,z,!0),c)))}),_&&_.length&&Wx(m,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function cn(t){return t.charAt(0)=="/"?t.slice(1):t}function cB(t,e){if(mk(),e=e||{},$g(e),un(t,"META-INF/manifest.xml")||un(t,"objectdata.xml"))return ty(t,e);if(un(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ed<"u"){if(t.FileIndex)return ed(t);var r=We.utils.cfb_new();return gx(t).forEach(function(ve){l6(r,ve,Ek(t,ve))}),ed(r)}throw new Error("Unsupported NUMBERS file")}if(!un(t,"[Content_Types].xml"))throw un(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):un(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=gx(t),i=iL(Xr(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Pt(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Pt(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(Uc=[],i.sst)try{Uc=xV(Pt(t,cn(i.sst)),i.sst,e)}catch(ve){if(e.WTF)throw ve}e.cellStyles&&i.themes.length&&(c=_V(Xr(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=vV(Pt(t,cn(i.style)),i.style,c,e))}i.links.map(function(ve){try{var ue=bc(Xr(t,wp(cn(ve))),ve);return wV(Pt(t,cn(ve)),ue,ve,e)}catch{}});var f=hV(Pt(t,cn(i.workbooks[0])),i.workbooks[0],e),h={},d="";i.coreprops.length&&(d=Pt(t,cn(i.coreprops[0]),!0),d&&(h=jk(d)),i.extprops.length!==0&&(d=Pt(t,cn(i.extprops[0]),!0),d&&lL(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=Xr(t,cn(i.custprops[0]),!0),d&&(m=fL(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(ue){return ue.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=m),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var g={};e.bookDeps&&i.calcchain&&(g=EV(Pt(t,cn(i.calcchain)),i.calcchain));var E=0,w={},T,_;{var N=f.Sheets;h.Worksheets=N.length,h.SheetNames=[];for(var z=0;z!=N.length;++z)h.SheetNames[z]=N[z].name}var B=s?"bin":"xml",y=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,y+1)+"_rels/"+i.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");un(t,k)||(k="xl/_rels/workbook."+B+".rels");var A=bc(Xr(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=TV(Pt(t,cn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=m5(Pt(t,cn(i.people[0])),e)),A&&(A=aB(A,f.Sheets));var I=Pt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=h.Worksheets;++E){var R="sheet";if(A&&A[E]?(T="xl/"+A[E][1].replace(/[\/]?xl\//,""),un(t,T)||(T=A[E][1]),un(t,T)||(T=k.replace(/_rels\/.*$/,"")+A[E][1]),R=A[E][2]):(T="xl/worksheets/sheet"+(E+1-I)+"."+B,T=T.replace(/sheet0\./,"sheet.")),_=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(h.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==E&&(C=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==h.SheetNames[E].toLowerCase()&&(C=1);if(!C)continue e}}oB(t,T,_,h.SheetNames[E],E,w,a,R,e,f,c,l)}return v={Directory:i,Workbook:f,Props:h,Custprops:m,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:Uc,Styles:l,Themes:c,SSF:er(Ne)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(ve,ue){ve=ve.replace(/^Root Entry[\/]/,""),v.keys.push(ve),v.files[ve]=t.FileIndex[ue]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=Pt(t,cn(i.vba[0]),!0):i.defaults&&i.defaults.bin===x5&&(v.vbaraw=Pt(t,"xl/vbaProject.bin",!0))),v}function lB(t,e){var r=e||{},n="Workbook",i=We.find(t,n);try{if(n="/!DataSpaces/Version",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t8(i.content),n="/!DataSpaces/DataSpaceMap",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=n8(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=i8(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);a8(i.content)}catch{}if(n="/EncryptionInfo",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=o8(i.content);if(n="/EncryptedPackage",i=We.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function jg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=rn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uB(t,e){return We.find(t,"EncryptedPackage")?lB(t,e):RA(t,e)}function fB(t,e){var r,n=t,i=e||{};return i.type||(i.type=ze&&Buffer.isBuffer(t)?"buffer":"base64"),r=wk(n,i),cB(r,i)}function NA(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ap(t.slice(r),e);default:break e}return xl.to_workbook(t,e)}function hB(t,e){var r="",n=jg(t,e);switch(e.type){case"base64":r=rn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=oa(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=nt(r)),e.type="binary",NA(r,e)}function dB(t,e){var r=t;return e.type=="base64"&&(r=rn(r)),r=Gi.utils.decode(1200,r.slice(2),"str"),e.type="binary",NA(r,e)}function pB(t){return t.match(/[^\x00-\x7F]/)?_c(t):t}function td(t,e,r,n){return n?(r.type="string",xl.to_workbook(t,r)):xl.to_workbook(e,r)}function sy(t,e){nk();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return sy(new Uint8Array(t),(r=er(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),co={},r.dateNF&&(co.dateNF=r.dateNF),r.type||(r.type=ze&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ze?"buffer":"binary",n=r6(t),typeof Uint8Array<"u"&&!ze&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=pB(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=er(r),r.type="array",sy(Tg(n),r)}switch((i=jg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return uB(We.read(n,r),r);break;case 9:if(i[1]<=8)return RA(n,r);break;case 60:return Ap(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return HM(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return UM.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?fB(n,r):td(t,n,r,s);case 239:return i[3]===60?Ap(n,r):td(t,n,r,s);case 255:if(i[1]===254)return dB(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Bc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Bc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Hx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return x8.to_workbook(n,r);break;case 10:case 13:case 32:return hB(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VM.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Hx.to_workbook(n,r):td(t,n,r,s)}function mB(t,e,r,n,i,s,a,o){var c=tr(r),l=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var v=a?t[r][m]:t[n[m]+c];if(v===void 0||v.t===void 0){if(l===void 0)continue;s[m]!=null&&(d[s[m]]=l);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(g==null)if(v.t=="e"&&g===null)d[s[m]]=null;else if(l!==void 0)d[s[m]]=l;else if(f&&g===null)d[s[m]]=null;else continue;else d[s[m]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:Ci(v,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Rp(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},f=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof f){case"string":c=kt(f);break;case"number":c=kt(t["!ref"]),c.s.r=f;break;default:c=f}n>0&&(i=0);var h=tr(c.s.r),d=[],m=[],v=0,g=0,E=Array.isArray(t),w=c.s.r,T=0,_={};E&&!t[w]&&(t[w]=[]);var N=l.skipHidden&&t["!cols"]||[],z=l.skipHidden&&t["!rows"]||[];for(T=c.s.c;T<=c.e.c;++T)if(!(N[T]||{}).hidden)switch(d[T]=bt(T),r=E?t[w][T]:t[d[T]+h],n){case 1:s[T]=T-c.s.c;break;case 2:s[T]=d[T];break;case 3:s[T]=l.header[T-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ci(r,null,l),g=_[a]||0,!g)_[a]=1;else{do o=a+"_"+g++;while(_[o]);_[a]=g,_[o]=1}s[T]=o}for(w=c.s.r+i;w<=c.e.r;++w)if(!(z[w]||{}).hidden){var B=mB(t,c,w,d,n,s,E,l);(B.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[v++]=B.row)}return m.length=v,m}var ay=/"/g;function gB(t,e,r,n,i,s,a,o){for(var c=!0,l=[],f="",h=tr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)f="";else if(m.v!=null){c=!1,f=""+(o.rawNumbers&&m.t=="n"?m.v:Ci(m,null,o));for(var v=0,g=0;v!==f.length;++v)if((g=f.charCodeAt(v))===i||g===s||g===34||o.forceQuotes){f='"'+f.replace(ay,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(c=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(ay,'""')+'"')):f="";l.push(f)}return o.blankrows===!1&&c?null:l.join(a)}function OA(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=kt(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),f="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(h[v]=bt(v));for(var g=0,E=i.s.r;E<=i.e.r;++E)(m[E]||{}).hidden||(f=gB(t,i,E,h,a,c,s,n),f!=null&&(n.strip&&(f=f.replace(l,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function vB(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=OA(t,e);return r}function _B(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=kt(t["!ref"]),s="",a=[],o,c=[],l=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=bt(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=tr(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=l?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function LA(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Sr(n.origin):n.origin;a=c.r,o=c.c}var l,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var h=kt(s["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),a==-1&&(a=h.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(g,E){ti(g).forEach(function(w){(m=d.indexOf(w))==-1&&(d[m=d.length]=w);var T=g[w],_="z",N="",z=Fe({c:o+m,r:a+E+i});l=Tl(s,z),T&&typeof T=="object"&&!(T instanceof Date)?s[z]=T:(typeof T=="number"?_="n":typeof T=="boolean"?_="b":typeof T=="string"?_="s":T instanceof Date?(_="d",n.cellDates||(_="n",T=Rr(T)),N=n.dateNF||Ne[14]):T===null&&n.nullError&&(_="e",T=0),l?(l.t=_,l.v=T,delete l.w,delete l.R,N&&(l.z=N)):s[z]=l={t:_,v:T},N&&(l.z=N))})}),f.e.c=Math.max(f.e.c,o+d.length-1);var v=tr(a);if(i)for(m=0;m<d.length;++m)s[bt(m+o)+v]={t:"s",v:d[m]};return s["!ref"]=$e(f),s}function xB(t,e){return LA(null,t,e)}function Tl(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Tl(t,Fe(e)):Tl(t,Fe({r:e,c:r||0}))}function yB(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Gg(){return{SheetNames:[],Sheets:{}}}function Kg(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(iV(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function EB(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=yB(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function wB(t,e){return t.z=e,t}function MA(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function TB(t,e,r){return MA(t,"#"+e,r)}function kB(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function AB(t,e,r,n){for(var i=typeof e!="string"?e:kt(e),s=typeof e=="string"?e:$e(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=Tl(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var KB={encode_col:bt,encode_row:tr,encode_cell:Fe,encode_range:$e,decode_col:Dg,decode_row:Fg,split_cell:b6,decode_cell:Sr,decode_range:bo,format_cell:Ci,sheet_add_aoa:Uk,sheet_add_json:LA,sheet_add_dom:PA,aoa_to_sheet:Vo,json_to_sheet:xB,table_to_sheet:FA,table_to_book:HV,sheet_to_csv:OA,sheet_to_txt:vB,sheet_to_json:Rp,sheet_to_html:zV,sheet_to_formulae:_B,sheet_to_row_object_array:Rp,sheet_get_cell:Tl,book_new:Gg,book_append_sheet:Kg,book_set_sheet_visibility:EB,cell_set_number_format:wB,cell_set_hyperlink:MA,cell_set_internal_link:TB,cell_add_comment:kB,sheet_set_array_formula:AB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};export{IB as R,CB as a,sy as b,MB as c,bB as d,WB as e,jB as f,zB as g,SB as h,eS as i,j4 as j,GB as k,DB as l,VB as m,PB as n,$B as o,RB as p,BB as q,gy as r,HB as s,FB as t,KB as u,UB as w};
//# sourceMappingURL=vendor-405c900a.js.map
